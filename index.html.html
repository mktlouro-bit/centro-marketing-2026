<html lang="pt"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Centro de Marketing 2026 - Premium Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&amp;family=Unbounded:wght@600;800&amp;display=swap" rel="stylesheet">
    <!-- Bibliotecas para Exporta√ß√£o -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #ec4899;
            --accent: #14b8a6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #0f172a;
            --dark-800: #1e293b;
            --dark-700: #334155;
            --light: #f8fafc;
            --light-200: #e2e8f0;
            --light-300: #cbd5e1;
            --sidebar-width: 280px;
            --header-height: 80px;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--dark-700);
            overflow-x: hidden;
            min-height: 100vh;
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(236, 72, 153, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .app-container {
            display: flex;
            min-height: 100vh;
            position: relative;
            z-index: 1;
        }

        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: rgba(15, 23, 42, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 12px;
            cursor: pointer;
            backdrop-filter: blur(20px);
            transition: all 0.3s;
        }

        .mobile-menu-btn:hover {
            background: rgba(99, 102, 241, 0.2);
        }

        .mobile-menu-btn svg {
            width: 24px;
            height: 24px;
            stroke: white;
        }

        .sidebar {
            width: var(--sidebar-width);
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            box-shadow: 4px 0 24px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 100;
            transition: transform 0.3s ease;
        }

        .sidebar::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(180deg, rgba(99, 102, 241, 0.1) 0%, transparent 100%);
            pointer-events: none;
        }

        .logo-container {
            padding: 30px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .logo {
            font-family: 'Unbounded', sans-serif;
            font-size: 1.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #fff 0%, #a5b4fc 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
            margin-bottom: 8px;
            animation: glow 3s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 8px rgba(165, 180, 252, 0.5)); }
            50% { filter: drop-shadow(0 0 16px rgba(165, 180, 252, 0.8)); }
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.7);
            }
            50% {
                box-shadow: 0 0 0 10px rgba(245, 158, 11, 0);
            }
        }

        .slogan {
            font-size: 0.75rem;
            color: #94a3b8;
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        .nav-section {
            padding: 25px 15px;
            flex: 1;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
        }

        .nav-label {
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: #64748b;
            font-weight: 700;
            padding: 0 10px 10px;
            margin-top: 20px;
        }

        .nav-label:first-child {
            margin-top: 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 15px;
            margin: 4px 0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: #cbd5e1;
            font-weight: 500;
            font-size: 0.9rem;
            position: relative;
            overflow: hidden;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 3px;
            background: var(--primary);
            transform: scaleY(0);
            transition: transform 0.3s;
        }

        .nav-item:hover {
            background: rgba(99, 102, 241, 0.15);
            color: #fff;
            transform: translateX(4px);
        }

        .nav-item:hover::before {
            transform: scaleY(1);
        }

        .nav-item.active {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2) 0%, rgba(236, 72, 153, 0.2) 100%);
            color: #fff;
            font-weight: 600;
        }

        .nav-item.active::before {
            transform: scaleY(1);
        }

        .nav-item svg {
            width: 20px;
            height: 20px;
            stroke-width: 2;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .header {
            height: var(--header-height);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--light-200);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 40px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06);
            position: relative;
            z-index: 50;
        }

        .header h1 {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--dark) 0%, var(--primary) 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .icon-btn {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            border: none;
            background: var(--light);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            position: relative;
        }

        .icon-btn:hover {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(99, 102, 241, 0.3);
        }

        .icon-btn:hover svg {
            stroke: white;
        }

        .icon-btn svg {
            width: 20px;
            height: 20px;
            stroke: var(--dark-700);
            transition: stroke 0.3s;
        }

        .content-area {
            flex: 1;
            overflow-y: auto;
            padding: 40px;
        }

        .section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            border-radius: 20px;
            padding: 28px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06);
            transition: all 0.3s;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
        }

        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
            border-color: var(--primary);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 20px;
        }

        .stat-icon {
            width: 56px;
            height: 56px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--dark) 0%, var(--primary) 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .stat-label {
            color: #64748b;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 32px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06);
            margin-bottom: 24px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-200);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
        }

        .btn {
            padding: 12px 24px;
            border-radius: 12px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.95rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            box-shadow: 0 4px 16px rgba(99, 102, 241, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: var(--light);
            color: var(--dark-700);
        }

        .btn-secondary:hover {
            background: var(--light-200);
        }

        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 24px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 24px 48px rgba(0, 0, 0, 0.2);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-200);
        }

        .modal-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark);
        }

        .close-btn {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            border: none;
            background: var(--light);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .close-btn:hover {
            background: var(--danger);
            transform: rotate(90deg);
        }

        .close-btn:hover svg {
            stroke: white;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            font-size: 0.95rem;
        }

        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--light-200);
            border-radius: 12px;
            font-size: 0.95rem;
            transition: all 0.3s;
            font-family: 'DM Sans', sans-serif;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }

        textarea.form-input {
            resize: vertical;
            min-height: 100px;
        }

        .event-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            border-left: 4px solid var(--primary);
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
        }

        .event-card:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .event-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }

        .event-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 4px;
        }

        .event-date {
            color: #64748b;
            font-size: 0.85rem;
        }

        .priority-badge {
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .priority-alta {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .priority-media {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .priority-baixa {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: white;
            padding: 20px 24px;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 2000;
            animation: slideInRight 0.3s ease;
            border-left: 4px solid var(--success);
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        .toast.warning {
            border-left-color: var(--warning);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #64748b;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state-text {
            font-size: 1.1rem;
            margin-bottom: 24px;
        }

        .persona-card {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(236, 72, 153, 0.05) 100%);
            border: 2px solid rgba(99, 102, 241, 0.1);
            border-radius: 20px;
            padding: 28px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .persona-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 32px rgba(99, 102, 241, 0.15);
            border-color: var(--primary);
        }

        .filter-tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .filter-tab {
            padding: 10px 20px;
            border-radius: 10px;
            border: 2px solid var(--light-200);
            background: white;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .filter-tab:hover {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.05);
        }

        .filter-tab.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border-color: transparent;
        }

        /* Month Filter Bar */
        .month-filter-bar {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            overflow-x: auto;
            padding: 16px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 16px;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
        }

        .month-filter-bar::-webkit-scrollbar {
            height: 6px;
        }

        .month-filter-bar::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 10px;
        }

        .month-filter-bar::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }

        .month-btn {
            padding: 12px 20px;
            border-radius: 12px;
            border: 2px solid var(--light-200);
            background: white;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.3s;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .month-btn:hover {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.05);
            transform: translateY(-2px);
        }

        .month-btn.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 16px rgba(99, 102, 241, 0.3);
        }

        .month-section {
            margin-bottom: 32px;
        }

        .month-section-header {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 3px solid var(--primary);
            display: inline-block;
        }

        /* AI Chat Interface */
        .ai-container {
            background: white;
            border-radius: 20px;
            padding: 0;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06);
            display: flex;
            flex-direction: column;
            height: calc(100vh - 200px);
        }

        .ai-header {
            padding: 24px 32px;
            border-bottom: 2px solid var(--light-200);
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(236, 72, 153, 0.05) 100%);
        }

        .ai-chat-area {
            flex: 1;
            overflow-y: auto;
            padding: 24px 32px;
            background: var(--light);
        }

        .ai-message {
            margin-bottom: 20px;
            display: flex;
            gap: 12px;
            animation: messageSlideIn 0.3s ease;
        }

        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .ai-message.user {
            flex-direction: row-reverse;
        }

        .ai-avatar {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .ai-avatar.user {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        }

        .ai-avatar.assistant {
            background: linear-gradient(135deg, var(--accent) 0%, var(--success) 100%);
        }

        .ai-bubble {
            background: white;
            padding: 16px 20px;
            border-radius: 16px;
            max-width: 70%;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            line-height: 1.6;
        }

        .ai-message.user .ai-bubble {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
        }

        .ai-input-area {
            padding: 24px 32px;
            border-top: 2px solid var(--light-200);
            background: white;
        }

        .ai-input-container {
            display: flex;
            gap: 12px;
            align-items: end;
        }

        .ai-input {
            flex: 1;
            padding: 14px 16px;
            border: 2px solid var(--light-200);
            border-radius: 12px;
            font-size: 0.95rem;
            resize: none;
            font-family: 'DM Sans', sans-serif;
            max-height: 120px;
        }

        .ai-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }

        .ai-send-btn {
            padding: 14px 24px;
            border-radius: 12px;
            border: none;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ai-send-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4);
        }

        .ai-send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .ai-loading {
            display: flex;
            gap: 6px;
            padding: 12px 20px;
        }

        .ai-loading-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--primary);
            animation: loadingDot 1.4s infinite ease-in-out both;
        }

        .ai-loading-dot:nth-child(1) { animation-delay: -0.32s; }
        .ai-loading-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes loadingDot {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        .quick-prompts {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .quick-prompt {
            padding: 8px 16px;
            border-radius: 20px;
            border: 2px solid var(--light-200);
            background: white;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s;
        }

        .quick-prompt:hover {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.05);
        }

        /* Invoice System */
        .invoice-item {
            background: rgba(99, 102, 241, 0.05);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin: 12px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success) 0%, var(--accent) 100%);
            transition: width 0.3s ease;
        }

        .crisis-section {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.05) 0%, rgba(239, 68, 68, 0.1) 100%);
            border-left: 4px solid var(--danger);
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 24px;
        }

        .crisis-section h4 {
            color: var(--danger);
            font-size: 1.2rem;
            margin-bottom: 12px;
        }

        .plan-section {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            border-left: 4px solid var(--primary);
        }

        .plan-section h4 {
            color: var(--dark);
            font-size: 1.1rem;
            margin-bottom: 16px;
        }

        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: 0;
                top: 0;
                bottom: 0;
                transform: translateX(-100%);
                z-index: 200;
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .mobile-menu-btn {
                display: flex;
            }

            .content-area {
                padding: 20px;
            }

            .header {
                padding: 0 20px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .ai-bubble {
                max-width: 85%;
            }

            .month-filter-bar {
                padding: 12px;
            }
        }
    
        /* Editor Styles */
        .editor-toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            padding: 10px;
            background: #f1f5f9;
            border: 1px solid #cbd5e1;
            border-bottom: none;
            border-radius: 8px 8px 0 0;
        }
        .editor-btn {
            padding: 5px 10px;
            background: white;
            border: 1px solid #cbd5e1;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        .editor-btn:hover {
            background: #e2e8f0;
            border-color: #94a3b8;
        }
        .editor-btn.active {
            background: #6366f1;
            color: white;
            border-color: #4f46e5;
        }
        .editor-content {
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
            padding: 15px;
            border: 1px solid #cbd5e1;
            border-radius: 0 0 8px 8px;
            background: white;
            outline: none;
        }
        .editor-content:focus {
            border-color: #6366f1;
            box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.1);
        }
        .editor-content ul {
            padding-left: 25px;
            margin-bottom: 10px;
        }
        .editor-content li {
            margin-bottom: 5px;
        }
        
        /* Checklist Styles */
        .note-checklist-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 8px;
        }
        .note-checklist-item input[type="checkbox"] {
            margin-top: 5px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        .note-checklist-item.checked span {
            text-decoration: line-through;
            color: #94a3b8;
        }
        
        /* Estilos adicionais para o editor */
        .editor-toolbar-group {
            display: flex;
            gap: 5px;
            align-items: center;
        }
        
        .editor-divider {
            width: 1px;
            height: 24px;
            background: #cbd5e1;
            margin: 0 5px;
        }
        
        .editor-btn svg {
            width: 16px;
            height: 16px;
        }
        
        .editor-content ol {
            padding-left: 25px;
            margin-bottom: 10px;
        }
        
        .editor-content a {
            color: #6366f1;
            text-decoration: underline;
        }
        
        .editor-content hr {
            border: none;
            border-top: 2px solid #cbd5e1;
            margin: 15px 0;
        }
    
    </style>
</head>
<body>
    <div class="app-container">
        <button class="mobile-menu-btn" onclick="toggleSidebar()">
            <svg fill="none" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
        </button>

        <aside class="sidebar" id="sidebar">
            <div class="logo-container">
                <div class="logo">Marketing Hub</div>
                <div class="slogan">Premium Edition 2026</div>
            </div>

            <nav class="nav-section">
                <div class="nav-label">Principal</div>
                <div class="nav-item" onclick="showSection('dashboard')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    Dashboard
                </div>
                <div class="nav-item" onclick="showSection('calendario')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                    Calend√°rio
                </div>
                <div class="nav-item" onclick="showSection('notas')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                    </svg>
                    Notas
                </div>

                <div class="nav-label">IA Assistentes</div>
                <div class="nav-item" onclick="showSection('insights')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                    </svg>
                    Insights IA
                </div>
                <div class="nav-item" onclick="showSection('analise-social')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"></path>
                    </svg>
                    An√°lise Social IA
                </div>

                <div class="nav-label">Planeamento</div>
                <div class="nav-item" onclick="showSection('plano')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                    </svg>
                    Plano Anual
                </div>
                <div class="nav-item active" onclick="showSection('plano-crise')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                    </svg>
                    Plano de Crise
                </div>
                <div class="nav-item" onclick="showSection('parcerias')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                    </svg>
                    Parcerias
                </div>

                <div class="nav-label">Or√ßamento</div>
                <div class="nav-item" onclick="showSection('patrocinios')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    Patroc√≠nios
                </div>
                <div class="nav-item" onclick="showSection('feiras')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                    </svg>
                    Feiras
                </div>
                <div class="nav-item" onclick="showSection('material')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
                    </svg>
                    Material
                </div>
                <div class="nav-item" onclick="showSection('geral')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    Geral
                </div>
                <div class="nav-item" onclick="showSection('eventos-especiais')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path>
                    </svg>
                    Eventos Especiais
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <header class="header">
                <h1>Centro de Marketing 2026</h1>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="exportFullReport()" style="display: flex; align-items: center; gap: 8px; padding: 10px 20px;">
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2a2 2 0 00-2-2H5a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2zm0 0h2a2 2 0 002-2M9 17h2m2 0v-2a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2zM9 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2z"></path>
                        </svg>
                        <span>Exportar Tudo (PDF)</span>
                    </button>
                    <button class="icon-btn" onclick="downloadData()" title="Salvar Estado (HTML)">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                        </svg>
                    </button>
                </div>
            </header>

            <div class="content-area">
                <!-- Dashboard Section -->
                <section id="dashboard" class="section">
                    <!-- Pr√≥ximo Evento Card -->
                    <div id="nextEventCard" style="background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); border-radius: 20px; padding: 30px; box-shadow: 0 8px 32px rgba(99, 102, 241, 0.3); color: white; position: relative; overflow: hidden; margin-bottom: 30px;">
                        <div style="position: absolute; top: -50%; right: -10%; width: 200px; height: 200px; background: rgba(255, 255, 255, 0.1); border-radius: 50%;"></div>
                        <div style="position: relative; z-index: 1;">
                            <div style="font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; opacity: 0.9; margin-bottom: 15px;">üéØ Pr√≥ximo Evento</div>
                            <div id="nextEventName" style="font-size: 1.8rem; font-weight: 700; margin-bottom: 10px;">Dia dos Namorados</div>
                            <div id="nextEventDetails" style="display: flex; flex-direction: column; gap: 8px; margin-top: 15px; opacity: 0.95;">
                    <div style="display: flex; align-items: center; gap: 10px; font-size: 0.95rem;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                        14/02/2026
                    </div>
                </div>
                            <div id="nextEventCountdown" style="background: rgba(255, 255, 255, 0.2); padding: 12px 20px; border-radius: 12px; margin-top: 15px; text-align: center; font-weight: 600; backdrop-filter: blur(10px);">Faltam 22 dias</div>
                        </div>
                    </div>
                    
                    <div class="stats-grid" id="statsGrid">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white;">üìÖ</div>
                    </div>
                    <div class="stat-value">25</div>
                    <div class="stat-label">Eventos Planeados</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #14b8a6 0%, #10b981 100%); color: white;">ü§ù</div>
                    </div>
                    <div class="stat-value">1</div>
                    <div class="stat-label">Parcerias Ativas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #ec4899 0%, #f43f5e 100%); color: white;">üí∞</div>
                    </div>
                    <div class="stat-value">‚Ç¨114&nbsp;898</div>
                    <div class="stat-label">Or√ßamento Total</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b 0%, #eab308 100%); color: white;">üìù</div>
                    </div>
                    <div class="stat-value">3</div>
                    <div class="stat-label">Notas Criadas</div>
                </div>
            </div>
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Resumo do Or√ßamento</h3>
                        </div>
                        <div id="budgetSummary">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%); 
                         padding: 20px; border-radius: 16px; border-left: 4px solid #6366f1;">
                        <div style="color: #64748b; font-size: 0.85rem; margin-bottom: 8px;">üí∞ Patroc√≠nios</div>
                        <div style="font-size: 1.8rem; font-weight: 800; color: var(--dark);">‚Ç¨11&nbsp;485</div>
                    </div>
                    <div style="background: linear-gradient(135deg, rgba(20, 184, 166, 0.1) 0%, rgba(16, 185, 129, 0.1) 100%); 
                         padding: 20px; border-radius: 16px; border-left: 4px solid #14b8a6;">
                        <div style="color: #64748b; font-size: 0.85rem; margin-bottom: 8px;">üè™ Feiras</div>
                        <div style="font-size: 1.8rem; font-weight: 800; color: var(--dark);">‚Ç¨82&nbsp;500</div>
                    </div>
                    <div style="background: linear-gradient(135deg, rgba(236, 72, 153, 0.1) 0%, rgba(244, 63, 94, 0.1) 100%); 
                         padding: 20px; border-radius: 16px; border-left: 4px solid #ec4899;">
                        <div style="color: #64748b; font-size: 0.85rem; margin-bottom: 8px;">üé® Material</div>
                        <div style="font-size: 1.8rem; font-weight: 800; color: var(--dark);">‚Ç¨3618</div>
                    </div>
                    <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(234, 179, 8, 0.1) 100%); 
                         padding: 20px; border-radius: 16px; border-left: 4px solid #f59e0b;">
                        <div style="color: #64748b; font-size: 0.85rem; margin-bottom: 8px;">üìã Geral</div>
                        <div style="font-size: 1.8rem; font-weight: 800; color: var(--dark);">‚Ç¨11&nbsp;995</div>
                    </div>
                    <div style="background: linear-gradient(135deg, rgba(147, 51, 234, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%); 
                         padding: 20px; border-radius: 16px; border-left: 4px solid #9333ea;">
                        <div style="color: #64748b; font-size: 0.85rem; margin-bottom: 8px;">‚≠ê Eventos Especiais</div>
                        <div style="font-size: 1.8rem; font-weight: 800; color: var(--dark);">‚Ç¨5300</div>
                    </div>
                </div>
                <div style="margin-top: 30px; padding: 30px; background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); 
                     border-radius: 20px; color: white; text-align: center;">
                    <div style="font-size: 1rem; opacity: 0.9; margin-bottom: 8px;">Or√ßamento Total 2026</div>
                    <div style="font-size: 3rem; font-weight: 800;">‚Ç¨114&nbsp;898</div>
                </div>
            </div>
                    </div>
                </section>

                <!-- Calend√°rio Section -->
                <section id="calendario" class="section">
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <h3 class="card-title">üìÖ Calend√°rio de Eventos 2026</h3>
                                <div style="display: flex; gap: 10px;">
                                    <button class="btn" id="btnEventosAtivos" onclick="toggleEventosView('ativos')" style="background: var(--primary); color: white; padding: 8px 16px;">
                                        Ativos
                                    </button>
                                    <button class="btn btn-secondary" id="btnEventosArquivados" onclick="toggleEventosView('arquivados')" style="padding: 8px 16px;">
                                        Arquivados
                                    </button>
                                </div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-secondary" onclick="exportEventosPDF()" title="Exportar para PDF">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                                    </svg>
                                    PDF
                                </button>
                                <button class="btn btn-secondary" onclick="exportEventosExcel()" title="Exportar para Excel">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Excel
                                </button>
                                <button class="btn btn-primary" onclick="openEventModal()">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                    </svg>
                                    Novo Evento
                                </button>
                            </div>
                        </div>

                        <!-- Month Filter Bar com Navega√ß√£o de Anos -->
                        <div style="display: flex; align-items: center; gap: 15px; padding: 20px; background: var(--light); border-radius: 12px; margin-bottom: 20px;">
                            <button class="btn btn-secondary" onclick="changeYear(-1)" style="padding: 10px 15px;">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                </svg>
                                Ano Anterior
                            </button>
                            <div style="flex: 1; text-align: center;">
                                <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--dark);" id="currentYearDisplay">2026</h3>
                            </div>
                            <button class="btn btn-secondary" onclick="changeYear(1)" style="padding: 10px 15px;">
                                Pr√≥ximo Ano
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                </svg>
                            </button>
                        </div>
                        
                        <div class="month-filter-bar">
                            <button class="month-btn" onclick="filterByMonth('all')">Todos</button>
                            <button class="month-btn" onclick="filterByMonth(1)">Janeiro</button>
                            <button class="month-btn" onclick="filterByMonth(2)">Fevereiro</button>
                            <button class="month-btn" onclick="filterByMonth(3)">Mar√ßo</button>
                            <button class="month-btn" onclick="filterByMonth(4)">Abril</button>
                            <button class="month-btn" onclick="filterByMonth(5)">Maio</button>
                            <button class="month-btn" onclick="filterByMonth(6)">Junho</button>
                            <button class="month-btn" onclick="filterByMonth(7)">Julho</button>
                            <button class="month-btn" onclick="filterByMonth(8)">Agosto</button>
                            <button class="month-btn" onclick="filterByMonth(9)">Setembro</button>
                            <button class="month-btn active" onclick="filterByMonth(10)">Outubro</button>
                            <button class="month-btn" onclick="filterByMonth(11)">Novembro</button>
                            <button class="month-btn" onclick="filterByMonth(12)">Dezembro</button>
                        </div>

                        <div id="agendaContainer">
                    <div class="month-section">
                        <h4 class="month-section-header">Fevereiro</h4>
                        
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia dos Namorados</div>
                                            <div class="event-date">14/02/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 22 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769103930809')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769103930809')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">- POST Dom Villas: 
-Cabaz dia dos Namorados:
Cada cabaz incluir uma rosa</p>
                                </div>
                            
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Carnaval</div>
                                            <div class="event-date">17/02/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 25 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769103945000')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769103945000')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">POST DE FELIZ CARNAVAL</p>
                                </div>
                            
                    </div>
                
                    <div class="month-section">
                        <h4 class="month-section-header">Mar√ßo</h4>
                        
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia Mundial da Efic√°cia Energ√©tica</div>
                                            <div class="event-date">05/03/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 41 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769103959934')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769103959934')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">POST COM OS DADOS</p>
                                </div>
                            
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia Internacional da Mulher</div>
                                            <div class="event-date">08/03/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 44 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769103974019')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769103974019')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">brinde para todas as mulheres</p>
                                </div>
                            
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia do Pai</div>
                                            <div class="event-date">19/03/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 55 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769103995948')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769103995948')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post para assinalar o dia DOM VILLAS: Cabaz do Pai - cada cabaz ter um "enfeite" em forma de la√ßo ou gravata</p>
                                </div>
                            
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia Mundial da √Ågua</div>
                                            <div class="event-date">22/03/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 58 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104009178')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104009178')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post para assinalar o dia (processo da √°gua no queijo) video da ana ver dados da lourofood da √°gua</p>
                                </div>
                            
                    </div>
                
                    <div class="month-section">
                        <h4 class="month-section-header">Abril</h4>
                        
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia das Mentiras</div>
                                            <div class="event-date">01/04/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 68 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104023879')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104023879')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post para assinalar o dia</p>
                                </div>
                            
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">P√°scoa</div>
                                            <div class="event-date">05/04/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 72 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104037567')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104037567')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post para assinalar o dia</p>
                                </div>
                            
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia da Liberdade</div>
                                            <div class="event-date">25/04/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 92 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104053476')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104053476')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post para assinalar o dia</p>
                                </div>
                            
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia Mundial da Seguran√ßa e Sa√∫de no Trabalho</div>
                                            <div class="event-date">28/04/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 95 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104070394')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104070394')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Ver com a Eng Ana (alguma campanha de alerta)</p>
                                </div>
                            
                    </div>
                
                    <div class="month-section">
                        <h4 class="month-section-header">Maio</h4>
                        
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia do Trabalhador</div>
                                            <div class="event-date">01/05/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 98 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104085177')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104085177')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post a assinalar o dia</p>
                                </div>
                            
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia da M√£e</div>
                                            <div class="event-date">03/05/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 100 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104098047')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104098047')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post a assinalar o dia Dom Villas - cabaz dia da Mae - oferecer uma flor a cada m√£e</p>
                                </div>
                            
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia Internacional da Reciclagem</div>
                                            <div class="event-date">17/05/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 114 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104115478')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104115478')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post a assinalar o dia Dom Villas n√£o faz sentido</p>
                                </div>
                            
                    </div>
                
                    <div class="month-section">
                        <h4 class="month-section-header">Junho</h4>
                        
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia Mundial do Meio Ambiente</div>
                                            <div class="event-date">05/06/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 133 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104134504')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104134504')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post a assinalar o dia Dom Villas n√£o faz sentido</p>
                                </div>
                            
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia de Portugal</div>
                                            <div class="event-date">10/06/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 138 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104145701')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104145701')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post a assinalar o dia</p>
                                </div>
                            
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">ARRAIAL POPULAR</div>
                                            <div class="event-date">20/06/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 148 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104157214')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104157214')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    
                                </div>
                            
                    </div>
                
                    <div class="month-section">
                        <h4 class="month-section-header">Setembro</h4>
                        
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia do Cliente</div>
                                            <div class="event-date">15/09/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 235 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104179587')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104179587')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post a assinalar o dia</p>
                                </div>
                            
                    </div>
                
                    <div class="month-section">
                        <h4 class="month-section-header">Outubro</h4>
                        
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia Mundial do Sorriso</div>
                                            <div class="event-date">02/10/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 252 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104194931')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104194931')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post a assinalar o dia</p>
                                </div>
                            
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia Mundial da Sa√∫de Mental</div>
                                            <div class="event-date">10/10/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 260 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104216096')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104216096')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post a assinalar o dia</p>
                                </div>
                            
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Halloween</div>
                                            <div class="event-date">31/10/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 281 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104230152')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104230152')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post a assinalar o dia</p>
                                </div>
                            
                    </div>
                
                    <div class="month-section">
                        <h4 class="month-section-header">Novembro</h4>
                        
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Dia Mundial da Qualidade</div>
                                            <div class="event-date">13/11/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 294 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104245061')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104245061')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post a assinalar o dia Ver a√ß√£o com a Eng. Ana</p>
                                </div>
                            
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Black Friday</div>
                                            <div class="event-date">27/11/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 308 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104257848')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104257848')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post a assinalar o dia 10% DESCONTO</p>
                                </div>
                            
                    </div>
                
                    <div class="month-section">
                        <h4 class="month-section-header">Dezembro</h4>
                        
                                <div class="event-card" style="border-left-color: var(--warning); ">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">Natal</div>
                                            <div class="event-date">25/12/2026</div>
                                            
                                            <div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam 336 dias</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-media">media</span>
                                            <button class="icon-btn" onclick="editEvent('1769104271319')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('1769104271319')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p style="color: #64748b; margin-top: 12px; line-height: 1.6;">Post a assinalar o dia</p>
                                </div>
                            
                    </div>
                </div>
                        <div id="emptyAgenda" class="empty-state" style="display: none;">
                            <div class="empty-state-icon">üì≠</div>
                            <div class="empty-state-text">Nenhum evento programado</div>
                        </div>
                    </div>
                </section>

                <!-- Notas Section -->
                <section id="notas" class="section">
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <h3 class="card-title">üìù Notas e Ideias</h3>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-secondary" onclick="exportNotasPDF()" title="Exportar para PDF">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                                    </svg>
                                    PDF
                                </button>
                                <button class="btn btn-secondary" onclick="exportNotasExcel()" title="Exportar para Excel">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Excel
                                </button>
                                <button class="btn btn-primary" onclick="openNoteModal()">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                    </svg>
                                    Nova Nota
                                </button>
                            </div>
                        </div>
                        <div id="notesContainer">
                <div class="persona-card">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                        <h4 style="margin: 0; font-size: 1.3rem;">üìù CHECKLIST 2026 - MARKETING</h4>
                        <div style="display: flex; gap: 8px;">
                            <span style="color: #64748b; font-size: 0.85rem;">22/01/2026</span>
                            <button class="icon-btn" onclick="deleteNote('1769102811980')" style="background: var(--danger); color: white;">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <p style="color: #64748b; line-height: 1.6; white-space: pre-wrap;">Alimentaria:
- Stand (decis√£o do estilo de stand e or√ßamento)
Sial:
- Plano da Feira - Voos e Estadia

Merchadising Feiras
Dia da Seguran√ßa Alimentar - 06/02/2026
Dia Mundial do Queijo - 20-01-2026
Benchmarking Supply Chain - GS1pt - n√£o
Patroc√≠nios 2026
- Dr.¬∫ Paulo Ruivo, Aves Btt (Elisabete) e BTT Famalic√£o
Plano de Marketing 2026
Cami√µes e Vilarinho
D√°diva de Sangue
- Sr Araujo - ver viabilidade e datas poss√≠veis.
Sr. Queijo - Dom Villas
- Protocolos;
- Cart√£o cliente; 
- fazer toda a estrutura√ß√£o do pr√©-site; 
- ver campanha para anivers√°rios (personaliza√ß√£o);
- Decora√ß√£o empresa;
- Pequenas obras na Loja;
- Loja Online (criar "depend√™ncia"); 
Cat√°logo Dom Villas e Lactilouro e Lourofood
- Ver modos de cat√°logos mais f√°cil de trocar refer√™ncias

Pack Boas vindas 
- Pack para novos colaboradores 

Newsletters
- Internas
- Externas (clientes) 

Outdoors Tem√°ticos
- Autoestradas (j√° temos or√ßamentos)
- Estruturar forma 

Calendariza√ß√£o de eventos

Sinal√©tica (placas)
sinal√©tica de transito e lombas
ver a entrada (estacionamento)

Apresenta√ß√µes de empresa
-2 tipos
Vcards
- Cart√µes comerciais de QR 
Vestu√°rio
- Interno e Externo e Pins 

Software/Televis√£o
- Indicadores mensais das empresas 
- Os nossos cuidados ambientais (usar fatores de compara√ß√£o)
- V√≠deos internos (cuidados com os colaboradores) 

M√©tricas de Redes Sociais 
Folhetos informativos (colaboradores) 
- Como "trabalhar" com os nossos queijos; 

Fardamento:
- Interno;</p>
                </div>
            
                <div class="persona-card">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                        <h4 style="margin: 0; font-size: 1.3rem;">üìù DIA SEGURAN√áA ALIMENTAR - PLANEAMENTO</h4>
                        <div style="display: flex; gap: 8px;">
                            <span style="color: #64748b; font-size: 0.85rem;">22/01/2026</span>
                            <button class="icon-btn" onclick="deleteNote('1769102844070')" style="background: var(--danger); color: white;">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <p style="color: #64748b; line-height: 1.6; white-space: pre-wrap;">- Comunicado para os colaboradores: 
pt e en (tudo igual).

- Departamentos entrega at√© 28 janeiro:
para o marketing e Eng. Ana

- ver atividade para o final;
- ver atividade para o final do almo√ßo;

Departamentos:
- Indicadores
- Qualidade
- RH
- Administrativo/Financeiro
- Senhor Queijo
- Lactilouro
- Lourofood
- Comercial</p>
                </div>
            
                <div class="persona-card">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                        <h4 style="margin: 0; font-size: 1.3rem;">üìù REUNI√ÉO 22.01.2026</h4>
                        <div style="display: flex; gap: 8px;">
                            <span style="color: #64748b; font-size: 0.85rem;">22/01/2026</span>
                            <button class="icon-btn" onclick="deleteNote('1769102874258')" style="background: var(--danger); color: white;">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <p style="color: #64748b; line-height: 1.6; white-space: pre-wrap;">Reuni√£o 16-01-2026


- dia 06.02.2025
   - ver apresenta√ß√µes - ok
   - ver atividade final de almo√ßo - ok
   - ver possibilidades de palestrantes (or√ßamento - 1000‚Ç¨+IVA); 
   - D¬™ Manuela - Associa√ß√£o de cantadores, ficou de ver a disponibilidade e pre√ßos (j√° liguei - 300‚Ç¨)
   - ver os lanches.

Patroc√≠nios:
   - Aves BTT, Famalic√£o Btt;
   - Amigos do Pedal (Dr Paulo Ruivo, enviar email com logotipo e confirma√ß√£o)

- Sial:
- ver viagens (marcar voos) - Voltar na segunda</p>
                </div>
            </div>
                        <div id="emptyNotes" class="empty-state" style="display: none;">
                            <div class="empty-state-icon">üìã</div>
                            <div class="empty-state-text">Sem notas criadas</div>
                        </div>
                    </div>
                </section>

                <!-- Insights IA Section -->
                <section id="insights" class="section">
                    <div class="ai-container">
                        <div class="ai-header">
                            <h3 class="card-title">üí° Assistente de Cria√ß√£o de Conte√∫do</h3>
                            <p style="color: #64748b; margin-top: 8px;">Obtenha ideias criativas e ajuda para criar conte√∫do para redes sociais e LinkedIn</p>
                        </div>
                        <div class="ai-chat-area" id="insightsChatArea">
                            <div class="ai-message assistant">
                                <div class="ai-avatar assistant">ü§ñ</div>
                                <div class="ai-bubble">
                                    <strong>Ol√°!</strong> Sou seu assistente de cria√ß√£o de conte√∫do. Posso ajud√°-la com:
                                    <ul style="margin-top: 12px; padding-left: 20px;">
                                        <li>Ideias de posts para redes sociais</li>
                                        <li>Sugest√µes de conte√∫do para LinkedIn</li>
                                        <li>Calend√°rio editorial</li>
                                        <li>Legendas criativas</li>
                                        <li>Hashtags relevantes</li>
                                        <li>Tend√™ncias de marketing</li>
                                    </ul>
                                    Como posso ajud√°-la hoje?
                                </div>
                            </div>
                        </div>
                        <div class="ai-input-area">
                            <div class="quick-prompts">
                                <button class="quick-prompt" onclick="sendQuickPrompt('insights', 'D√°-me 5 ideias de posts para Instagram sobre queijos artesanais')">üí° Ideias para Instagram</button>
                                <button class="quick-prompt" onclick="sendQuickPrompt('insights', 'Cria um post profissional para LinkedIn sobre inova√ß√£o na ind√∫stria alimentar')">üíº Post LinkedIn</button>
                                <button class="quick-prompt" onclick="sendQuickPrompt('insights', 'Sugere hashtags para uma campanha de Natal de produtos gourmet')">üè∑Ô∏è Hashtags</button>
                                <button class="quick-prompt" onclick="sendQuickPrompt('insights', 'Cria um calend√°rio de conte√∫do para o pr√≥ximo m√™s')">üìÖ Calend√°rio</button>
                            </div>
                            <div class="ai-input-container">
                                <textarea class="ai-input" id="insightsInput" placeholder="Descreva o que precisa... (ex: ideias de posts, legendas, calend√°rio editorial)" rows="2" onkeydown="if(event.key === 'Enter' &amp;&amp; !event.shiftKey) { event.preventDefault(); sendInsightsMessage(); }"></textarea>
                                <button class="ai-send-btn" onclick="sendInsightsMessage()" id="insightsSendBtn">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                                    </svg>
                                    Enviar
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- An√°lise Social IA Section -->
                <section id="analise-social" class="section">
                    <div class="ai-container">
                        <div class="ai-header">
                            <h3 class="card-title">üìä Assistente de An√°lise de Redes Sociais</h3>
                            <p style="color: #64748b; margin-top: 8px;">Analise dados das suas redes sociais e receba insights sobre crescimento e melhorias</p>
                        </div>
                        <div class="ai-chat-area" id="analiseChatArea">
                            <div class="ai-message assistant">
                                <div class="ai-avatar assistant">üìà</div>
                                <div class="ai-bubble">
                                    <strong>Ol√°!</strong> Sou seu assistente de an√°lise de redes sociais. Posso ajud√°-la com:
                                    <ul style="margin-top: 12px; padding-left: 20px;">
                                        <li>An√°lise de m√©tricas de crescimento</li>
                                        <li>Identifica√ß√£o de tend√™ncias</li>
                                        <li>Sugest√µes de otimiza√ß√£o</li>
                                        <li>Compara√ß√£o de performance entre plataformas</li>
                                        <li>An√°lise de engagement</li>
                                        <li>Recomenda√ß√µes estrat√©gicas</li>
                                    </ul>
                                    Partilhe os dados das suas redes sociais para come√ßar a an√°lise!
                                </div>
                            </div>
                        </div>
                        <div class="ai-input-area">
                            <div class="quick-prompts">
                                <button class="quick-prompt" onclick="sendQuickPrompt('analise', 'Tenho 5.000 seguidores no Instagram e 150 likes por post. Como posso melhorar o engagement?')">üì± Melhorar Engagement</button>
                                <button class="quick-prompt" onclick="sendQuickPrompt('analise', 'O meu alcance no Facebook caiu 30% este m√™s. O que fazer?')">üìâ Analisar Queda</button>
                                <button class="quick-prompt" onclick="sendQuickPrompt('analise', 'Que tipo de conte√∫do devo focar para aumentar seguidores?')">üìà Estrat√©gia Crescimento</button>
                                <button class="quick-prompt" onclick="sendQuickPrompt('analise', 'Analisa: Instagram 10k seguidores, LinkedIn 2k seguidores. Onde focar?')">‚öñÔ∏è Comparar Plataformas</button>
                            </div>
                            <div class="ai-input-container">
                                <textarea class="ai-input" id="analiseInput" placeholder="Partilhe os dados das suas redes sociais... (ex: seguidores, engagement, alcance, etc.)" rows="2" onkeydown="if(event.key === 'Enter' &amp;&amp; !event.shiftKey) { event.preventDefault(); sendAnaliseMessage(); }"></textarea>
                                <button class="ai-send-btn" onclick="sendAnaliseMessage()" id="analiseSendBtn">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                                    </svg>
                                    Enviar
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Plano Anual Section -->
                <section id="plano" class="section">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üéØ Plano de Marketing Anual 2026</h3>
                            <button class="btn btn-primary" onclick="savePlan()">
                                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                                </svg>
                                Guardar Plano
                            </button>
                        </div>

                        <!-- An√°lise de Situa√ß√£o -->
                        <div class="plan-section">
                            <h4>üìä 1. An√°lise de Situa√ß√£o</h4>
                            <div class="form-group">
                                <label class="form-label">An√°lise SWOT - For√ßas</label>
                                <textarea class="form-input" id="planForcas" rows="5" placeholder="Quais s√£o os pontos fortes da empresa/marca?"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">An√°lise SWOT - Fraquezas</label>
                                <textarea class="form-input" id="planFraquezas" rows="5" placeholder="Quais s√£o os pontos fracos a melhorar?"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">An√°lise SWOT - Oportunidades</label>
                                <textarea class="form-input" id="planOportunidades" rows="5" placeholder="Que oportunidades de mercado existem?"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">An√°lise SWOT - Amea√ßas</label>
                                <textarea class="form-input" id="planAmeacas" rows="5" placeholder="Quais s√£o as amea√ßas do mercado/concorr√™ncia?"></textarea>
                            </div>
                        </div>

                        <!-- Objetivos e Metas -->
                        <div class="plan-section">
                            <h4>üéØ 2. Objetivos e Metas 2026</h4>
                            <div class="form-group">
                                <label class="form-label">Objetivos Gerais</label>
                                <textarea class="form-input" id="planObjetivos" rows="6" placeholder="Ex: Aumentar awareness da marca em 30%, expandir para 3 novos mercados, lan√ßar 2 novos produtos..."></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Metas Espec√≠ficas (SMART)</label>
                                <textarea class="form-input" id="planMetas" rows="6" placeholder="Metas espec√≠ficas, mensur√°veis, ating√≠veis, relevantes e com prazo definido"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">KPIs e M√©tricas de Sucesso</label>
                                <textarea class="form-input" id="planKPIs" rows="5" placeholder="Como vai medir o sucesso? Ex: Taxa de crescimento de vendas, ROI, engagement rate, NPS..."></textarea>
                            </div>
                        </div>

                        <!-- P√∫blico-Alvo -->
                        <div class="plan-section">
                            <h4>üë• 3. P√∫blico-Alvo e Personas</h4>
                            <div class="form-group">
                                <label class="form-label">Segmentos de P√∫blico</label>
                                <textarea class="form-input" id="planPublico" rows="5" placeholder="Descreva os principais segmentos de p√∫blico-alvo (idade, localiza√ß√£o, comportamento, necessidades)"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Personas Principais</label>
                                <textarea class="form-input" id="planPersonas" rows="6" placeholder="Descreva 2-3 personas detalhadas (nome fict√≠cio, dados demogr√°ficos, objetivos, desafios, comportamento de compra)"></textarea>
                            </div>
                        </div>

                        <!-- Estrat√©gias e T√°ticas -->
                        <div class="plan-section">
                            <h4>üöÄ 4. Estrat√©gias e T√°ticas</h4>
                            <div class="form-group">
                                <label class="form-label">Posicionamento de Marca</label>
                                <textarea class="form-input" id="planPosicionamento" rows="5" placeholder="Como quer que a marca seja percebida no mercado?"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Estrat√©gias de Marketing</label>
                                <textarea class="form-input" id="planEstrategias" rows="6" placeholder="Ex: Marketing de conte√∫do, email marketing, influencer marketing, SEO/SEM, redes sociais..."></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Canais de Comunica√ß√£o</label>
                                <textarea class="form-input" id="planCanais" rows="5" placeholder="Quais canais ser√£o priorit√°rios? (Instagram, LinkedIn, Facebook, site, email, eventos...)"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Calend√°rio Editorial</label>
                                <textarea class="form-input" id="planCalendario" rows="5" placeholder="Frequ√™ncia de publica√ß√µes, temas principais por trimestre, campanhas sazonais..."></textarea>
                            </div>
                        </div>

                        <!-- Or√ßamento -->
                        <div class="plan-section">
                            <h4>üí∞ 5. Or√ßamento Anual</h4>
                            <div class="form-group">
                                <label class="form-label">Or√ßamento Total Previsto (‚Ç¨)</label>
                                <input type="number" class="form-input" id="planOrcamentoTotal" placeholder="0.00" step="0.01">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Distribui√ß√£o por Categoria</label>
                                <textarea class="form-input" id="planDistribuicao" rows="5" placeholder="Ex: Publicidade digital: 40%, Eventos: 25%, Conte√∫do: 15%, Parcerias: 10%, Material: 10%"></textarea>
                            </div>
                        </div>

                        <!-- Cronograma -->
                        <div class="plan-section">
                            <h4>üìÖ 6. Cronograma e Marcos</h4>
                            <div class="form-group">
                                <label class="form-label">Q1 (Jan-Mar) - Principais A√ß√µes</label>
                                <textarea class="form-input" id="planQ1" rows="4" placeholder="A√ß√µes e campanhas do 1¬∫ trimestre"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Q2 (Abr-Jun) - Principais A√ß√µes</label>
                                <textarea class="form-input" id="planQ2" rows="4" placeholder="A√ß√µes e campanhas do 2¬∫ trimestre"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Q3 (Jul-Set) - Principais A√ß√µes</label>
                                <textarea class="form-input" id="planQ3" rows="4" placeholder="A√ß√µes e campanhas do 3¬∫ trimestre"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Q4 (Out-Dez) - Principais A√ß√µes</label>
                                <textarea class="form-input" id="planQ4" rows="4" placeholder="A√ß√µes e campanhas do 4¬∫ trimestre (inclui campanhas de Natal)"></textarea>
                            </div>
                        </div>

                        <!-- An√°lise e Monitoriza√ß√£o -->
                        <div class="plan-section">
                            <h4>üìà 7. An√°lise e Monitoriza√ß√£o</h4>
                            <div class="form-group">
                                <label class="form-label">Ferramentas de Monitoriza√ß√£o</label>
                                <textarea class="form-input" id="planFerramentas" rows="4" placeholder="Ex: Google Analytics, Meta Business Suite, LinkedIn Analytics, Power BI..."></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Frequ√™ncia de Revis√£o</label>
                                <textarea class="form-input" id="planRevisao" rows="4" placeholder="Com que frequ√™ncia vai rever e ajustar o plano? (semanal, mensal, trimestral)"></textarea>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Plano de Crise Section -->
                <section id="plano-crise" class="section active">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">‚ö†Ô∏è Plano de Gest√£o de Crise</h3>
                            <button class="btn btn-primary" onclick="saveCrisisPlan()">
                                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                                </svg>
                                Guardar Plano
                            </button>
                        </div>

                        <!-- Equipa de Crise -->
                        <div class="crisis-section">
                            <h4>üë• 1. Equipa de Gest√£o de Crise</h4>
                            <div class="form-group">
                                <label class="form-label">Coordenador Principal</label>
                                <input type="text" class="form-input" id="crisisCoord" placeholder="Nome e cargo do coordenador">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Porta-voz Oficial</label>
                                <input type="text" class="form-input" id="crisisPortavoz" placeholder="Respons√°vel pela comunica√ß√£o externa">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Membros da Equipa</label>
                                <textarea class="form-input" id="crisisEquipa" rows="5" placeholder="Lista de membros da equipa e suas fun√ß√µes (Marketing, Jur√≠dico, RH, Opera√ß√µes, etc.)"></textarea>
                            </div>
                        </div>

                        <!-- Contactos de Emerg√™ncia -->
                        <div class="crisis-section">
                            <h4>üìû 2. Contactos de Emerg√™ncia</h4>
                            <div class="form-group">
                                <label class="form-label">Contactos Internos Chave</label>
                                <textarea class="form-input" id="crisisInternos" rows="5" placeholder="Nomes, cargos e contactos diretos dos decisores principais"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Contactos Externos (Assessoria, Advogados, Ag√™ncias)</label>
                                <textarea class="form-input" id="crisisExternos" rows="5" placeholder="Consultores de comunica√ß√£o, assessoria jur√≠dica, ag√™ncias de PR"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Contactos de Media</label>
                                <textarea class="form-input" id="crisisMedia" rows="5" placeholder="Jornalistas e meios de comunica√ß√£o priorit√°rios"></textarea>
                            </div>
                        </div>

                        <!-- Cen√°rios de Crise -->
                        <div class="crisis-section">
                            <h4>‚ö° 3. Cen√°rios de Crise Poss√≠veis</h4>
                            <div class="form-group">
                                <label class="form-label">Problemas de Produto/Qualidade</label>
                                <textarea class="form-input" id="crisisProduto" rows="5" placeholder="Protocolo para recalls, contamina√ß√£o, defeitos de qualidade">Recall de produto ‚Üí Contactar ASAE imediatamente ‚Üí Recolher lotes ‚Üí Comunicar aos clientes ‚Üí Emitir comunicado p√∫blico ‚Üí Oferecer reembolso/troca</textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Crise nas Redes Sociais</label>
                                <textarea class="form-input" id="crisisRedes" rows="5" placeholder="Como responder a cr√≠ticas virais, coment√°rios negativos">1. N√£o apagar coment√°rios, 2. Responder em &lt;2h, 3. Mostrar empatia, 4. Levar para privado se necess√°rio, 5. Oferecer solu√ß√£o concreta, 6. Seguir at√© resolu√ß√£o</textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Problemas com Funcion√°rios</label>
                                <textarea class="form-input" id="crisisFuncionarios" rows="4" placeholder="Demiss√µes pol√©micas, den√∫ncias, greves">Avaliar situa√ß√£o ‚Üí Consultar jur√≠dico/RH ‚Üí Preparar statement ‚Üí Contactar funcion√°rios ‚Üí Comunica√ß√£o interna primeiro ‚Üí Externa apenas se necess√°rio</textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Problemas Financeiros/Legais</label>
                                <textarea class="form-input" id="crisisFinanceiro" rows="4" placeholder="Processos judiciais, multas, auditorias">Sil√™ncio at√© assessoria jur√≠dica aprovar ‚Üí Preparar FAQ interno ‚Üí Comunicado minimalista se necess√°rio ‚Üí Focar em compliance</textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Desastres Naturais/Operacionais</label>
                                <textarea class="form-input" id="crisisOperacional" rows="4" placeholder="Inc√™ndios, inunda√ß√µes, falhas de sistema">Garantir seguran√ßa pessoas ‚Üí Avaliar danos ‚Üí Informar stakeholders ‚Üí Plano de continuidade ‚Üí Comunicar timeline de recupera√ß√£o</textarea>
                            </div>
                        </div>

                        <!-- Protocolo de Resposta -->
                        <div class="crisis-section">
                            <h4>üìã 4. Protocolo de Resposta (Primeiras 24h)</h4>
                            <div class="form-group">
                                <label class="form-label">0-2 Horas - A√ß√µes Imediatas</label>
                                <textarea class="form-input" id="crisis0to2" rows="6" placeholder="O que fazer nas primeiras 2 horas">‚úì Ativar equipa de crise
‚úì Avaliar gravidade (escala 1-5)
‚úì Recolher factos
‚úì Pausar comunica√ß√µes agendadas
‚úì Monitorizar redes sociais
‚úì Preparar holding statement</textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">2-6 Horas - Avalia√ß√£o e Estrat√©gia</label>
                                <textarea class="form-input" id="crisis2to6" rows="6" placeholder="Avalia√ß√£o detalhada e defini√ß√£o de estrat√©gia">‚úì Reuni√£o da equipa de crise
‚úì Confirmar factos
‚úì Identificar stakeholders afetados
‚úì Definir mensagem-chave
‚úì Aprovar comunica√ß√£o
‚úì Designar porta-voz</textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">6-24 Horas - Comunica√ß√£o Ativa</label>
                                <textarea class="form-input" id="crisis6to24" rows="6" placeholder="Implementa√ß√£o da comunica√ß√£o">‚úì Emitir comunicado oficial
‚úì Contactar stakeholders priorit√°rios
‚úì Atualizar website/redes sociais
‚úì Preparar FAQs
‚úì Treinar equipa de atendimento
‚úì Monitorizar rea√ß√£o e ajustar</textarea>
                            </div>
                        </div>

                        <!-- Templates de Comunica√ß√£o -->
                        <div class="crisis-section">
                            <h4>üìù 5. Templates de Comunica√ß√£o</h4>
                            <div class="form-group">
                                <label class="form-label">Comunicado de Imprensa - Template</label>
                                <textarea class="form-input" id="crisisTemplate1" rows="7" placeholder="Template b√°sico para comunicado">[NOME DA EMPRESA] INFORMA

[Cidade], [Data] - A [Nome da Empresa] vem esclarecer a situa√ß√£o relativamente a [descrever situa√ß√£o].

A nossa prioridade √© [clientes/funcion√°rios/qualidade/etc]. Estamos a tomar as seguintes medidas: [listar a√ß√µes].

Para mais informa√ß√µes: [contacto]</textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Post Redes Sociais - Template</label>
                                <textarea class="form-input" id="crisisTemplate2" rows="4" placeholder="Template para redes sociais">Agradecemos a vossa preocupa√ß√£o. Estamos cientes de [situa√ß√£o] e j√° estamos a trabalhar para [solu√ß√£o]. A vossa confian√ßa √© importante para n√≥s. Atualiza√ß√µes em [quando]. üíô</textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email para Clientes - Template</label>
                                <textarea class="form-input" id="crisisTemplate3" rows="8" placeholder="Template para email">Assunto: Informa√ß√£o Importante - [Empresa]

Caro(a) Cliente,

Queremos inform√°-lo(a) sobre [situa√ß√£o]. Valorizamos a sua confian√ßa e estamos a tomar medidas imediatas: [a√ß√µes].

Se for afetado(a), contacte-nos: [contacto]

Obrigado pela compreens√£o.</textarea>
                            </div>
                        </div>

                        <!-- Checklist -->
                        <div class="crisis-section">
                            <h4>‚úÖ 6. Checklist de Gest√£o de Crise</h4>
                            <div class="form-group">
                                <label class="form-label">Checklist Essencial</label>
                                <textarea class="form-input" id="crisisChecklist" rows="12" placeholder="Lista de verifica√ß√£o">‚ñ° Equipa de crise ativada
‚ñ° Factos confirmados
‚ñ° Gravidade avaliada
‚ñ° Stakeholders identificados
‚ñ° Mensagem-chave aprovada
‚ñ° Comunica√ß√£o interna realizada
‚ñ° Comunicado externo emitido
‚ñ° Redes sociais monitorizadas
‚ñ° FAQs preparadas
‚ñ° Porta-voz designado
‚ñ° Timeline de atualiza√ß√µes definida
‚ñ° A√ß√µes corretivas em curso</textarea>
                            </div>
                        </div>

                        <!-- P√≥s-Crise -->
                        <div class="crisis-section">
                            <h4>üîÑ 7. Fase P√≥s-Crise</h4>
                            <div class="form-group">
                                <label class="form-label">Avalia√ß√£o e Aprendizagem</label>
                                <textarea class="form-input" id="crisisApos" rows="6" placeholder="O que fazer ap√≥s a crise">‚úì Reuni√£o de debriefing da equipa
‚úì An√°lise do que funcionou/n√£o funcionou
‚úì Atualizar plano de crise
‚úì Agradecer √† equipa
‚úì Comunica√ß√£o de fecho (se apropriado)
‚úì Monitorizar reputa√ß√£o a m√©dio prazo</textarea>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Parcerias Section -->
                <section id="parcerias" class="section">
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <h3 class="card-title">ü§ù Parcerias e Colabora√ß√µes</h3>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-secondary" onclick="exportParceriasPDF()" title="Exportar para PDF">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                                    </svg>
                                    PDF
                                </button>
                                <button class="btn btn-secondary" onclick="exportParceriasExcel()" title="Exportar para Excel">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Excel
                                </button>
                                <button class="btn btn-primary" onclick="openPartnershipModal()">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                    </svg>
                                    Nova Parceria
                                </button>
                            </div>
                        </div>
                        <div class="filter-tabs">
                            <div class="filter-tab active" onclick="filterPartnerships('all')">Todas</div>
                            <div class="filter-tab" onclick="filterPartnerships('paid')">Pagas</div>
                            <div class="filter-tab" onclick="filterPartnerships('free')">Sem Custos</div>
                        </div>
                        <div id="partnershipsList">
                <div class="persona-card" style="border-left: 4px solid var(--accent)">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
                        <div>
                            <h4 style="margin: 0 0 8px 0; font-size: 1.3rem;">ü§ù AESA</h4>
                            <div style="color: #64748b; font-size: 0.85rem; margin-bottom: 8px;">
                                01/01/2026 at√© 31/12/2026
                            </div>
                            
                            <span class="priority-badge priority-media">Com Teto Anual</span>
                        </div>
                        <button class="icon-btn" onclick="deletePartnership('1769102951895')" style="background: var(--danger); color: white;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </div>
                    <p style="color: #64748b; line-height: 1.6; margin-bottom: 15px;">PARCERIA EM PRODUTOS</p>
                    
                    
                        <div style="background: rgba(99, 102, 241, 0.05); padding: 20px; border-radius: 12px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                <div>
                                    <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 4px;">Teto Anual</div>
                                    <div style="font-size: 1.4rem; font-weight: 700; color: var(--dark);">‚Ç¨1000</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 4px;">Utilizado</div>
                                    <div style="font-size: 1.4rem; font-weight: 700; color: var(--primary);">‚Ç¨0</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 4px;">Dispon√≠vel</div>
                                    <div style="font-size: 1.4rem; font-weight: 700; color: var(--success)">‚Ç¨1000</div>
                                </div>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 0%; background: linear-gradient(90deg, var(--success) 0%, var(--accent) 100%)"></div>
                            </div>
                            <div style="text-align: center; margin-top: 8px; font-size: 0.85rem; color: #64748b;">
                                0.0% utilizado
                            </div>

                            <div style="margin-top: 16px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                    <h5 style="margin: 0; font-size: 1rem; color: var(--dark);">üìÑ Faturas (0)</h5>
                                    <button class="btn btn-secondary" style="padding: 8px 16px; font-size: 0.85rem;" onclick="openFaturaModal('1769102951895')">
                                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                        </svg>
                                        Adicionar Fatura
                                    </button>
                                </div>
                                <div style="text-align: center; padding: 16px; color: #94a3b8; font-size: 0.9rem;">Nenhuma fatura registada</div>
                            </div>
                        </div>
                    

                    
                </div>
            </div>
                        <div id="emptyParcerias" class="empty-state" style="display: none;">
                            <div class="empty-state-icon">ü§ù</div>
                            <div class="empty-state-text">Nenhuma parceria registada</div>
                        </div>
                    </div>
                </section>

                <!-- Patroc√≠nios Section -->
                <section id="patrocinios" class="section">
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <h3 class="card-title">üí∞ Patroc√≠nios</h3>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-secondary" onclick="exportPatrociniosPDF()" title="Exportar para PDF">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                                    </svg>
                                    PDF
                                </button>
                                <button class="btn btn-secondary" onclick="exportPatrociniosExcel()" title="Exportar para Excel">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Excel
                                </button>
                                <button class="btn btn-primary" onclick="openPatrocinioModal()">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                    </svg>
                                    Novo Patroc√≠nio
                                </button>
                            </div>
                        </div>
                        <div id="patrociniosList">
                <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.05) 0%, rgba(245, 158, 11, 0.1) 100%); 
                     border: 2px solid rgba(245, 158, 11, 0.2); border-left: 4px solid var(--warning); 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üí∞ GRUPO DESPORTIVO DO LOURO</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ Patroc√≠nio desportivo
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: var(--warning);">‚Ç¨6385</div>
                    </div>
                    <button class="icon-btn" onclick="deletePatrocinio('1769102998307')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.05) 0%, rgba(245, 158, 11, 0.1) 100%); 
                     border: 2px solid rgba(245, 158, 11, 0.2); border-left: 4px solid var(--warning); 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üí∞ BTT - DESPORTIVO DAS AVES</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/10/2026 ‚Ä¢ Patroc√≠nio Desportivo
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: var(--warning);">‚Ç¨750</div>
                    </div>
                    <button class="icon-btn" onclick="deletePatrocinio('1769103027114')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.05) 0%, rgba(245, 158, 11, 0.1) 100%); 
                     border: 2px solid rgba(245, 158, 11, 0.2); border-left: 4px solid var(--warning); 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üí∞ BTT - CLUBE FAMALIC√ÉO</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ Patroc√≠nio Desportivo
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: var(--warning);">‚Ç¨750</div>
                    </div>
                    <button class="icon-btn" onclick="deletePatrocinio('1769103083927')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.05) 0%, rgba(245, 158, 11, 0.1) 100%); 
                     border: 2px solid rgba(245, 158, 11, 0.2); border-left: 4px solid var(--warning); 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üí∞ SQUADRA - AMIGOS DO PEDAL</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ Patroc√≠nio Desportivo
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: var(--warning);">‚Ç¨1500</div>
                    </div>
                    <button class="icon-btn" onclick="deletePatrocinio('1769103105009')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.05) 0%, rgba(245, 158, 11, 0.1) 100%); 
                     border: 2px solid rgba(245, 158, 11, 0.2); border-left: 4px solid var(--warning); 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üí∞ PAROQUIA DE SANTA LUCR√âCIA - LOURO</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ Ajuda Comunit√°ria (religi√£o)
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: var(--warning);">‚Ç¨750</div>
                    </div>
                    <button class="icon-btn" onclick="deletePatrocinio('1769103169945')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.05) 0%, rgba(245, 158, 11, 0.1) 100%); 
                     border: 2px solid rgba(245, 158, 11, 0.2); border-left: 4px solid var(--warning); 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üí∞ FESTAS DE SANTO ANT√ìNIO - LOURO</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ Religioso - Donativo Festas
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: var(--warning);">‚Ç¨750</div>
                    </div>
                    <button class="icon-btn" onclick="deletePatrocinio('1769103206634')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.05) 0%, rgba(245, 158, 11, 0.1) 100%); 
                     border: 2px solid rgba(245, 158, 11, 0.2); border-left: 4px solid var(--warning); 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üí∞ ROTARY CLUB DE FAMALIC√ÉO</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ Patroc√≠nio dado o ano passado
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: var(--warning);">‚Ç¨500</div>
                    </div>
                    <button class="icon-btn" onclick="deletePatrocinio('1769103238500')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.05) 0%, rgba(245, 158, 11, 0.1) 100%); 
                     border: 2px solid rgba(245, 158, 11, 0.2); border-left: 4px solid var(--warning); 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üí∞ Bombeiros</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ Institucional
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: var(--warning);">‚Ç¨100</div>
                    </div>
                    <button class="icon-btn" onclick="deletePatrocinio('1769103521947')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
                        <div id="emptyPatrocinios" class="empty-state" style="display: none;">
                            <div class="empty-state-icon">üí∞</div>
                            <div class="empty-state-text">Nenhum patroc√≠nio registado</div>
                        </div>
                    </div>
                </section>

                <!-- Feiras Section -->
                <section id="feiras" class="section">
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <h3 class="card-title">üè™ Feiras e Eventos</h3>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-secondary" onclick="exportFeirasPDF()" title="Exportar para PDF">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                                    </svg>
                                    PDF
                                </button>
                                <button class="btn btn-secondary" onclick="exportFeirasExcel()" title="Exportar para Excel">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Excel
                                </button>
                                <button class="btn btn-primary" onclick="openFeiraModal()">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                    </svg>
                                    Nova Feira
                                </button>
                            </div>
                        </div>
                        <div id="feirasList">
                <div style="background: linear-gradient(135deg, rgba(20, 184, 166, 0.05) 0%, rgba(20, 184, 166, 0.1) 100%); 
                     border: 2px solid rgba(20, 184, 166, 0.2); border-left: 4px solid var(--accent); 
                     padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
                        <div style="flex: 1;">
                            <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üè™ ALIMENTARIA - BARCELONA - 23 A 26 MAR√áO 2026 - ATUALIZADO</div>
                            <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                                Barcelona ‚Ä¢ 23/03/2026
                            </div>
                            <div style="font-size: 1.6rem; font-weight: 800; color: var(--accent); margin-top: 10px;">
                                Total: ‚Ç¨37&nbsp;500
                            </div>
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <button class="icon-btn" onclick="editFeira('1769103370110')" title="Editar" style="background: var(--primary); color: white;">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                </svg>
                            </button>
                            <button class="icon-btn" onclick="deleteFeira('1769103370110')" style="background: var(--danger); color: white;" title="Eliminar">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Parcelas Section -->
                    <div style="background: white; border-radius: 10px; padding: 15px; margin-top: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <h5 style="margin: 0; font-size: 1rem; color: var(--dark);">üí∞ Or√ßamento Detalhado (0 parcelas)</h5>
                            <button class="btn btn-secondary" onclick="openParcelaModal('1769103370110')" style="padding: 6px 12px; font-size: 0.85rem;">
                                + Adicionar Parcela
                            </button>
                        </div>
                        <p style="color: #94a3b8; text-align: center; padding: 20px; font-size: 0.9rem;">Nenhuma parcela adicionada. Clique em "Adicionar Parcela" para come√ßar.</p>
                    </div>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(20, 184, 166, 0.05) 0%, rgba(20, 184, 166, 0.1) 100%); 
                     border: 2px solid rgba(20, 184, 166, 0.2); border-left: 4px solid var(--accent); 
                     padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
                        <div style="flex: 1;">
                            <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üè™ SIAL PARIS - 17 A 21 OUTUBRO 2026 - ATUALIZADO</div>
                            <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                                Paris ‚Ä¢ 17/10/2026
                            </div>
                            <div style="font-size: 1.6rem; font-weight: 800; color: var(--accent); margin-top: 10px;">
                                Total: ‚Ç¨45&nbsp;000
                            </div>
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <button class="icon-btn" onclick="editFeira('1769103394140')" title="Editar" style="background: var(--primary); color: white;">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                </svg>
                            </button>
                            <button class="icon-btn" onclick="deleteFeira('1769103394140')" style="background: var(--danger); color: white;" title="Eliminar">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Parcelas Section -->
                    <div style="background: white; border-radius: 10px; padding: 15px; margin-top: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <h5 style="margin: 0; font-size: 1rem; color: var(--dark);">üí∞ Or√ßamento Detalhado (0 parcelas)</h5>
                            <button class="btn btn-secondary" onclick="openParcelaModal('1769103394140')" style="padding: 6px 12px; font-size: 0.85rem;">
                                + Adicionar Parcela
                            </button>
                        </div>
                        <p style="color: #94a3b8; text-align: center; padding: 20px; font-size: 0.9rem;">Nenhuma parcela adicionada. Clique em "Adicionar Parcela" para come√ßar.</p>
                    </div>
                </div>
            </div>
                        <div id="emptyFeiras" class="empty-state" style="display: none;">
                            <div class="empty-state-icon">üè™</div>
                            <div class="empty-state-text">Nenhuma feira registada</div>
                        </div>
                    </div>
                </section>

                <!-- Material Section -->
                <section id="material" class="section">
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <h3 class="card-title">üé® Material de Marketing</h3>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-secondary" onclick="exportMaterialPDF()" title="Exportar para PDF">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                                    </svg>
                                    PDF
                                </button>
                                <button class="btn btn-secondary" onclick="exportMaterialExcel()" title="Exportar para Excel">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Excel
                                </button>
                                <button class="btn btn-primary" onclick="openMaterialModal()">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                    </svg>
                                    Novo Material
                                </button>
                            </div>
                        </div>
                        <div id="materialList">
                <div style="background: linear-gradient(135deg, rgba(236, 72, 153, 0.05) 0%, rgba(236, 72, 153, 0.1) 100%); 
                     border: 2px solid rgba(236, 72, 153, 0.2); border-left: 4px solid var(--secondary); 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üé® M√°quina Fotogr√°fica Mirrorless Sony Alpha a7 Mark III + SEL-2860 FE 28-60mm f/4-5.6 OSS + FE 50mm f/1.8 + Bateria Extra NP-FZ100</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ M√°quina Fotogr√°fica
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: var(--secondary);">‚Ç¨1690</div>
                    </div>
                    <button class="icon-btn" onclick="deleteMaterial('1769103426599')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(236, 72, 153, 0.05) 0%, rgba(236, 72, 153, 0.1) 100%); 
                     border: 2px solid rgba(236, 72, 153, 0.2); border-left: 4px solid var(--secondary); 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üé® ESTABILIZADOR DJI RS 4 MINI COMBO</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ Estabilizador de v√≠deo e fotos
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: var(--secondary);">‚Ç¨489</div>
                    </div>
                    <button class="icon-btn" onclick="deleteMaterial('1769103453052')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(236, 72, 153, 0.05) 0%, rgba(236, 72, 153, 0.1) 100%); 
                     border: 2px solid rgba(236, 72, 153, 0.2); border-left: 4px solid var(--secondary); 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üé® CAIXA DE LUZ PARA FOTOGRAFIA DE PRODUTO</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: var(--secondary);">‚Ç¨90</div>
                    </div>
                    <button class="icon-btn" onclick="deleteMaterial('1769103462944')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(236, 72, 153, 0.05) 0%, rgba(236, 72, 153, 0.1) 100%); 
                     border: 2px solid rgba(236, 72, 153, 0.2); border-left: 4px solid var(--secondary); 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üé® OP√á√ÉO B - TELEMOV√âL iPhone 17 Pro APPLE (6.3'' - 256 GB)</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ OPC√ÉO B EM VEZ DA M√ÅQUINA
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: var(--secondary);">‚Ç¨1349</div>
                    </div>
                    <button class="icon-btn" onclick="deleteMaterial('1769103492833')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
                        <div id="emptyMaterial" class="empty-state" style="display: none;">
                            <div class="empty-state-icon">üé®</div>
                            <div class="empty-state-text">Nenhum material registado</div>
                        </div>
                    </div>
                </section>

                <!-- Geral Section -->
                <section id="geral" class="section">
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <h3 class="card-title">üìã Despesas Gerais</h3>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-secondary" onclick="exportGeralPDF()" title="Exportar para PDF">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                                    </svg>
                                    PDF
                                </button>
                                <button class="btn btn-secondary" onclick="exportGeralExcel()" title="Exportar para Excel">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Excel
                                </button>
                                <button class="btn btn-primary" onclick="openGeralModal()">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                    </svg>
                                    Nova Despesa
                                </button>
                            </div>
                        </div>
                        <div id="geralList">
                <div style="background: linear-gradient(135deg, rgba(100, 116, 139, 0.05) 0%, rgba(100, 116, 139, 0.1) 100%); 
                     border: 2px solid rgba(100, 116, 139, 0.2); border-left: 4px solid #64748b; 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üìã BRINDES</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ Publicidade
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: #64748b;">‚Ç¨0</div>
                    </div>
                    <button class="icon-btn" onclick="deleteGeral('1769103632953')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(100, 116, 139, 0.05) 0%, rgba(100, 116, 139, 0.1) 100%); 
                     border: 2px solid rgba(100, 116, 139, 0.2); border-left: 4px solid #64748b; 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üìã CAT√ÅLOGOS</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ Impress√£o e Gr√°fica
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: #64748b;">‚Ç¨0</div>
                    </div>
                    <button class="icon-btn" onclick="deleteGeral('1769103648080')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(100, 116, 139, 0.05) 0%, rgba(100, 116, 139, 0.1) 100%); 
                     border: 2px solid rgba(100, 116, 139, 0.2); border-left: 4px solid #64748b; 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üìã TENDA PARA EVENTOS - Tenda Promo Domo - Small</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ Publicidade
https://www.jb-insuflaveis.pt/tenda-promo-domo-small-0
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: #64748b;">‚Ç¨1350</div>
                    </div>
                    <button class="icon-btn" onclick="deleteGeral('1769103708379')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(100, 116, 139, 0.05) 0%, rgba(100, 116, 139, 0.1) 100%); 
                     border: 2px solid rgba(100, 116, 139, 0.2); border-left: 4px solid #64748b; 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üìã OUTDOORS - COLOCA√á√ÉO E IMPRESS√ÉO - ENIF</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ Publicidade
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: #64748b;">‚Ç¨2200</div>
                    </div>
                    <button class="icon-btn" onclick="deleteGeral('1769103724077')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(100, 116, 139, 0.05) 0%, rgba(100, 116, 139, 0.1) 100%); 
                     border: 2px solid rgba(100, 116, 139, 0.2); border-left: 4px solid #64748b; 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üìã ALUGUER OUTDOORS - ALUGUER - ENIF</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ Publicidade - 3 outdoors por ano
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: #64748b;">‚Ç¨6000</div>
                    </div>
                    <button class="icon-btn" onclick="deleteGeral('1769103751107')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(100, 116, 139, 0.05) 0%, rgba(100, 116, 139, 0.1) 100%); 
                     border: 2px solid rgba(100, 116, 139, 0.2); border-left: 4px solid #64748b; 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üìã OUTDOOR A3 - SAIDA GUIMAR√ÉES FAMALIC√ÉO - 1 ANO - CSOUTDOORS</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ Publicidade
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: #64748b;">‚Ç¨2445</div>
                    </div>
                    <button class="icon-btn" onclick="deleteGeral('1769103771785')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(100, 116, 139, 0.05) 0%, rgba(100, 116, 139, 0.1) 100%); 
                     border: 2px solid rgba(100, 116, 139, 0.2); border-left: 4px solid #64748b; 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üìã DECORA√á√ÉO LOJA - O SR.¬∫ QUEIJO</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            01/01/2026 ‚Ä¢ Aguarda or√ßamento - LS Interiores - 252 322 412
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: #64748b;">‚Ç¨0</div>
                    </div>
                    <button class="icon-btn" onclick="deleteGeral('1769103795695')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
                        <div id="emptyGeral" class="empty-state" style="display: none;">
                            <div class="empty-state-icon">üìã</div>
                            <div class="empty-state-text">Nenhuma despesa geral registada</div>
                        </div>
                    </div>
                </section>

                <!-- Eventos Especiais Section -->
                <section id="eventos-especiais" class="section">
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <h3 class="card-title">‚≠ê Eventos Especiais</h3>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-secondary" onclick="exportEventosEspeciaisPDF()" title="Exportar para PDF">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                                    </svg>
                                    PDF
                                </button>
                                <button class="btn btn-secondary" onclick="exportEventosEspeciaisExcel()" title="Exportar para Excel">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Excel
                                </button>
                                <button class="btn btn-primary" onclick="openEventoEspecialModal()">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                    </svg>
                                    Novo Evento Especial
                                </button>
                            </div>
                        </div>
                        <div id="eventosEspeciaisList">
                <div style="background: linear-gradient(135deg, rgba(147, 51, 234, 0.05) 0%, rgba(147, 51, 234, 0.1) 100%); 
                     border: 2px solid rgba(147, 51, 234, 0.2); border-left: 4px solid #9333ea; 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">‚≠ê DIA DA MULHER</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            08/03/2026 ‚Ä¢ BRINDE A TODAS AS COLABORADORAS
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: #9333ea;">‚Ç¨300</div>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="icon-btn" onclick="editarEventoEspecial('1769103554579')" style="background: var(--primary); color: white;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                            </svg>
                        </button>
                        <button class="icon-btn" onclick="removerEventoEspecial('1769103554579')" style="background: var(--danger); color: white;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(147, 51, 234, 0.05) 0%, rgba(147, 51, 234, 0.1) 100%); 
                     border: 2px solid rgba(147, 51, 234, 0.2); border-left: 4px solid #9333ea; 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">‚≠ê ARRAIAL POPULAR</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            20/06/2026 ‚Ä¢ ARRAIAL POPULAR COMES E BEBES 
M√öSICA: CANTARES AO DESAFIO
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: #9333ea;">‚Ç¨2000</div>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="icon-btn" onclick="editarEventoEspecial('1769103588808')" style="background: var(--primary); color: white;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                            </svg>
                        </button>
                        <button class="icon-btn" onclick="removerEventoEspecial('1769103588808')" style="background: var(--danger); color: white;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            
                <div style="background: linear-gradient(135deg, rgba(147, 51, 234, 0.05) 0%, rgba(147, 51, 234, 0.1) 100%); 
                     border: 2px solid rgba(147, 51, 234, 0.2); border-left: 4px solid #9333ea; 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">‚≠ê ANIVERS√ÅRIOS DAS EMPRESAS</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            16/11/2026 ‚Ä¢ BOLO COMEMORATIVO BRINDE COLABORADOR
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: #9333ea;">‚Ç¨3000</div>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="icon-btn" onclick="editarEventoEspecial('1769103611496')" style="background: var(--primary); color: white;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                            </svg>
                        </button>
                        <button class="icon-btn" onclick="removerEventoEspecial('1769103611496')" style="background: var(--danger); color: white;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
                        <div id="emptyEventosEspeciais" class="empty-state" style="display: none;">
                            <div class="empty-state-icon">‚≠ê</div>
                            <div class="empty-state-text">Nenhum evento especial registado</div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Event Modal -->
    <div id="eventModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Novo Evento</h3>
                <button class="close-btn" onclick="closeEventModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="form-group">
                <label class="form-label">T√≠tulo do Evento</label>
                <input type="text" class="form-input" id="eventTitle" placeholder="Ex: Campanha Black Friday">
            </div>
            <div class="form-group">
                <label class="form-label">Data</label>
                <input type="date" class="form-input" id="eventDate">
            </div>
            <div class="form-group">
                <label class="form-label">Prioridade</label>
                <select class="form-input" id="eventPriority">
                    <option value="alta">üî¥ Alta</option>
                    <option value="media" selected="">üü° M√©dia</option>
                    <option value="baixa">üü¢ Baixa</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Empresa</label>
                <select class="form-input" id="eventCompany">
                    <option value="lourofood">Lourofood</option>
                    <option value="lactilouro">Lactilouro</option>
                    <option value="srqueijo">O Sr¬∫ Queijo</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Descri√ß√£o</label>
                <textarea class="form-input" id="eventDesc" rows="3" placeholder="Detalhes do evento..."></textarea>
            </div>
            <button class="btn btn-primary" onclick="saveEvent()">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                </svg>
                Guardar Evento
            </button>
        </div>
    </div>

    <!-- Partnership Modal -->
    <div id="partnershipModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Nova Parceria</h3>
                <button class="close-btn" onclick="closePartnershipModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="form-group">
                <label class="form-label">Tipo</label>
                <select class="form-input" id="partnershipTipo">
                    <option value="parceria">ü§ù Parceria</option>
                    <option value="patrocinio">üí∞ Patroc√≠nio</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Nome</label>
                <input type="text" class="form-input" id="partnershipNome" placeholder="Nome da empresa/entidade">
            </div>
            <div class="form-group">
                <label class="form-label">Descri√ß√£o</label>
                <textarea class="form-input" id="partnershipDesc" rows="3" placeholder="Descri√ß√£o da parceria..."></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Valor (‚Ç¨)</label>
                <input type="number" class="form-input" id="partnershipValor" value="0" step="0.01">
            </div>
            <div class="form-group">
                <label class="form-label">
                    <input type="checkbox" id="partnershipComTeto" onchange="toggleTetoFields()"> 
                    Parceria com teto anual (tracking de faturas)
                </label>
            </div>
            <div id="tetoFields" style="display: none;">
                <div class="form-group">
                    <label class="form-label">Valor Teto Anual (‚Ç¨)</label>
                    <input type="number" class="form-input" id="partnershipTeto" value="0" step="0.01">
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Data de In√≠cio</label>
                <input type="date" class="form-input" id="partnershipInicio">
            </div>
            <div class="form-group">
                <label class="form-label">Data de Fim</label>
                <input type="date" class="form-input" id="partnershipFim">
            </div>
            <button class="btn btn-primary" onclick="savePartnership()">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                </svg>
                Guardar
            </button>
        </div>
    </div>

    <!-- Patrocinio Modal -->
    <div id="patrocinioModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Novo Patroc√≠nio</h3>
                <button class="close-btn" onclick="closePatrocinioModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="form-group">
                <label class="form-label">Nome</label>
                <input type="text" class="form-input" id="patrocinioNome" placeholder="Nome do patroc√≠nio">
            </div>
            <div class="form-group">
                <label class="form-label">Descri√ß√£o</label>
                <textarea class="form-input" id="patrocinioDesc" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Valor (‚Ç¨)</label>
                <input type="number" class="form-input" id="patrocinioValor" value="0" step="0.01">
            </div>
            <div class="form-group">
                <label class="form-label">Data</label>
                <input type="date" class="form-input" id="patrocinioData">
            </div>
            <button class="btn btn-primary" onclick="savePatrocinio()">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                </svg>
                Guardar
            </button>
        </div>
    </div>

    <!-- Feira Modal -->
    <div id="feiraModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Nova Feira</h3>
                <button class="close-btn" onclick="closeFeiraModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="form-group">
                <label class="form-label">Nome da Feira</label>
                <input type="text" class="form-input" id="feiraNome" placeholder="Ex: Alimentaria Lisboa">
            </div>
            <div class="form-group">
                <label class="form-label">Local</label>
                <input type="text" class="form-input" id="feiraLocal" placeholder="Localiza√ß√£o">
            </div>
            <div class="form-group">
                <label class="form-label">Data</label>
                <input type="date" class="form-input" id="feiraData">
            </div>
            <div class="form-group">
                <label class="form-label">Valor (‚Ç¨)</label>
                <input type="number" class="form-input" id="feiraValor" value="0" step="0.01">
            </div>
            <button class="btn btn-primary" onclick="saveFeira()">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                </svg>
                Guardar
            </button>
        </div>
    </div>

    <!-- Material Modal -->
    <div id="materialModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Novo Material</h3>
                <button class="close-btn" onclick="closeMaterialModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="form-group">
                <label class="form-label">Nome</label>
                <input type="text" class="form-input" id="materialNome" placeholder="Ex: Banners, Flyers">
            </div>
            <div class="form-group">
                <label class="form-label">Descri√ß√£o</label>
                <textarea class="form-input" id="materialDesc" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Valor (‚Ç¨)</label>
                <input type="number" class="form-input" id="materialValor" value="0" step="0.01">
            </div>
            <div class="form-group">
                <label class="form-label">Data</label>
                <input type="date" class="form-input" id="materialData">
            </div>
            <button class="btn btn-primary" onclick="saveMaterial()">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                </svg>
                Guardar
            </button>
        </div>
    </div>

    <!-- Geral Modal -->
    <div id="geralModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Nova Despesa Geral</h3>
                <button class="close-btn" onclick="closeGeralModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="form-group">
                <label class="form-label">Nome</label>
                <input type="text" class="form-input" id="geralNome" placeholder="Ex: Software, Forma√ß√£o">
            </div>
            <div class="form-group">
                <label class="form-label">Descri√ß√£o</label>
                <textarea class="form-input" id="geralDesc" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Valor (‚Ç¨)</label>
                <input type="number" class="form-input" id="geralValor" value="0" step="0.01">
            </div>
            <div class="form-group">
                <label class="form-label">Data</label>
                <input type="date" class="form-input" id="geralData">
            </div>
            <button class="btn btn-primary" onclick="saveGeral()">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                </svg>
                Guardar
            </button>
        </div>
    </div>

    <!-- Evento Especial Modal -->
    <div id="eventoEspecialModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Novo Evento Especial</h3>
                <button class="close-btn" onclick="closeEventoEspecialModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="form-group">
                <label class="form-label">Nome do Evento</label>
                <input type="text" class="form-input" id="eventoEspecialNome" placeholder="Ex: Anivers√°rio da Empresa">
            </div>
            <div class="form-group">
                <label class="form-label">Descri√ß√£o</label>
                <textarea class="form-input" id="eventoEspecialDesc" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Data</label>
                <input type="date" class="form-input" id="eventoEspecialData">
            </div>
            <div class="form-group">
                <label class="form-label">Valor (‚Ç¨)</label>
                <input type="number" class="form-input" id="eventoEspecialValor" value="0" step="0.01">
            </div>
            <button class="btn btn-primary" onclick="saveEventoEspecial()">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                </svg>
                Guardar
            </button>
        </div>
    </div>

    <!-- Modal de Faturas -->
    <div id="faturaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Adicionar Fatura</h3>
                <button class="close-btn" onclick="closeFaturaModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="form-group">
                <label class="form-label">N√∫mero da Fatura</label>
                <input type="text" class="form-input" id="faturaNumero" placeholder="Ex: FT 2026/001">
            </div>
            <div class="form-group">
                <label class="form-label">Data</label>
                <input type="date" class="form-input" id="faturaData">
            </div>
            <div class="form-group">
                <label class="form-label">Valor (‚Ç¨)</label>
                <input type="number" class="form-input" id="faturaValor" value="0" step="0.01">
            </div>
            <div class="form-group">
                <label class="form-label">Descri√ß√£o (opcional)</label>
                <input type="text" class="form-input" id="faturaDesc" placeholder="Descri√ß√£o da fatura">
            </div>
            <button class="btn btn-primary" onclick="saveFatura()">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                </svg>
                Adicionar Fatura
            </button>
        </div>
    </div>

    
    <!-- Note Modal -->
    <div id="noteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Nova Nota</h3>
                <button class="close-btn" onclick="closeNoteModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div class="form-group">
                <label class="form-label">T√≠tulo</label>
                <input type="text" class="form-input" id="noteTitle" placeholder="T√≠tulo da nota">
            </div>
            <div class="form-group">
                <label class="form-label">Conte√∫do</label>
                <div class="editor-toolbar">
                    <!-- Formata√ß√£o b√°sica -->
                    <button class="editor-btn" onclick="execEditorCommand('bold')" title="Negrito (Ctrl+B)"><b>B</b></button>
                    <button class="editor-btn" onclick="execEditorCommand('italic')" title="It√°lico (Ctrl+I)"><i>I</i></button>
                    <button class="editor-btn" onclick="execEditorCommand('underline')" title="Sublinhado (Ctrl+U)"><u>U</u></button>
                    <button class="editor-btn" onclick="execEditorCommand('strikeThrough')" title="Riscado"><s>S</s></button>
                    
                    <div class="editor-divider"></div>
                    
                    <!-- Tamanho e cores -->
                    <select class="editor-btn" onchange="execEditorCommand('fontSize', this.value); this.selectedIndex=0;" title="Tamanho" style="width: auto;">
                        <option value="" selected disabled>Tamanho</option>
                        <option value="1">Muito Pequeno</option>
                        <option value="2">Pequeno</option>
                        <option value="3">Normal</option>
                        <option value="4">M√©dio</option>
                        <option value="5">Grande</option>
                        <option value="6">Muito Grande</option>
                        <option value="7">Extra Grande</option>
                    </select>
                    <input type="color" class="editor-btn" onchange="execEditorCommand('foreColor', this.value)" title="Cor do Texto" style="padding: 2px; width: 40px;">
                    <input type="color" class="editor-btn" onchange="execEditorCommand('backColor', this.value)" title="Cor de Fundo" style="padding: 2px; width: 40px;" value="#ffff00">
                    
                    <div class="editor-divider"></div>
                    
                    <!-- Alinhamento -->
                    <button class="editor-btn" onclick="execEditorCommand('justifyLeft')" title="Alinhar √† Esquerda">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h10M4 18h16"/>
                        </svg>
                    </button>
                    <button class="editor-btn" onclick="execEditorCommand('justifyCenter')" title="Centralizar">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M7 12h10M4 18h16"/>
                        </svg>
                    </button>
                    <button class="editor-btn" onclick="execEditorCommand('justifyRight')" title="Alinhar √† Direita">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M10 12h10M4 18h16"/>
                        </svg>
                    </button>
                    <button class="editor-btn" onclick="execEditorCommand('justifyFull')" title="Justificar">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                    
                    <div class="editor-divider"></div>
                    
                    <!-- Listas -->
                    <button class="editor-btn" onclick="execEditorCommand('insertUnorderedList')" title="Lista com Marcadores">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                    <button class="editor-btn" onclick="execEditorCommand('insertOrderedList')" title="Lista Numerada">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4h2v2H3V4zm0 4h2v2H3V8zm0 4h2v2H3v-2zM8 5h13M8 11h13M8 17h13"/>
                        </svg>
                    </button>
                    <button class="editor-btn" onclick="addChecklistToEditor()" title="Checklist">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
                        </svg>
                    </button>
                    
                    <div class="editor-divider"></div>
                    
                    <!-- Indenta√ß√£o -->
                    <button class="editor-btn" onclick="execEditorCommand('indent')" title="Aumentar Indenta√ß√£o">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h12M4 18h16M4 10l4 2-4 2V10z"/>
                        </svg>
                    </button>
                    <button class="editor-btn" onclick="execEditorCommand('outdent')" title="Diminuir Indenta√ß√£o">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h12M4 18h16M8 10l-4 2 4 2V10z"/>
                        </svg>
                    </button>
                    
                    <div class="editor-divider"></div>
                    
                    <!-- Outros -->
                    <button class="editor-btn" onclick="insertLink()" title="Inserir Link">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                        </svg>
                    </button>
                    <button class="editor-btn" onclick="execEditorCommand('insertHorizontalRule')" title="Linha Horizontal">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 12h16"/>
                        </svg>
                    </button>
                    
                    <div class="editor-divider"></div>
                    
                    <!-- Desfazer/Refazer -->
                    <button class="editor-btn" onclick="execEditorCommand('undo')" title="Desfazer (Ctrl+Z)">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"/>
                        </svg>
                    </button>
                    <button class="editor-btn" onclick="execEditorCommand('redo')" title="Refazer (Ctrl+Y)">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 10h-10a8 8 0 00-8 8v2m18-10l-6 6m6-6l-6-6"/>
                        </svg>
                    </button>
                    <button class="editor-btn" onclick="execEditorCommand('removeFormat')" title="Limpar Formata√ß√£o">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
                <div id="noteEditor" class="editor-content" contenteditable="true"></div>
            </div>
            <button class="btn btn-primary" onclick="saveNote()">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                </svg>
                Guardar
            </button>
        </div>
    </div>
    
<!-- Modal de Parcelas (para Feiras) -->
    <div id="parcelaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Adicionar Parcela</h3>
                <button class="close-btn" onclick="closeParcelaModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="form-group">
                <label class="form-label">Descri√ß√£o</label>
                <input type="text" class="form-input" id="parcelaDesc" placeholder="Ex: Stand, Viagens, Material">
            </div>
            <div class="form-group">
                <label class="form-label">Valor (‚Ç¨)</label>
                <input type="number" class="form-input" id="parcelaValor" value="0" step="0.01">
            </div>
            <button class="btn btn-primary" onclick="saveParcela()">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                </svg>
                Adicionar Parcela
            </button>
        </div>
    </div>

    <script>
        // Cloud data storage
        const CLOUD_DATA_EVENTS = [{"id":"1769103867981","title":"Blue Monday","date":"2026-01-19","priority":"baixa","desc":"Post de receita de bem estar com queijo light"},{"id":"1769103910215","title":"DIA MUNDIAL DO QUEIJO","date":"2026-01-20","priority":"alta","desc":"Loja - Desconto no dia\nLourofood - Queijos Lactilouro - 190gr\nLactilouro - Queijos Lourofood - SUAVE - marca Villas - 200gr interlabel"},{"id":"1769103930809","title":"Dia dos Namorados","date":"2026-02-14","priority":"media","desc":"- POST Dom Villas: \n-Cabaz dia dos Namorados:\nCada cabaz incluir uma rosa"},{"id":"1769103945000","title":"Carnaval","date":"2026-02-17","priority":"media","desc":"POST DE FELIZ CARNAVAL"},{"id":"1769103959934","title":"Dia Mundial da Efic√°cia Energ√©tica","date":"2026-03-05","priority":"media","desc":"POST COM OS DADOS"},{"id":"1769103974019","title":"Dia Internacional da Mulher","date":"2026-03-08","priority":"media","desc":"brinde para todas as mulheres"},{"id":"1769103995948","title":"Dia do Pai","date":"2026-03-19","priority":"media","desc":"Post para assinalar o dia DOM VILLAS: Cabaz do Pai - cada cabaz ter um \"enfeite\" em forma de la√ßo ou gravata"},{"id":"1769104009178","title":"Dia Mundial da √Ågua","date":"2026-03-22","priority":"media","desc":"Post para assinalar o dia (processo da √°gua no queijo) video da ana ver dados da lourofood da √°gua"},{"id":"1769104023879","title":"Dia das Mentiras","date":"2026-04-01","priority":"media","desc":"Post para assinalar o dia"},{"id":"1769104037567","title":"P√°scoa","date":"2026-04-05","priority":"media","desc":"Post para assinalar o dia"},{"id":"1769104053476","title":"Dia da Liberdade","date":"2026-04-25","priority":"media","desc":"Post para assinalar o dia"},{"id":"1769104070394","title":"Dia Mundial da Seguran√ßa e Sa√∫de no Trabalho","date":"2026-04-28","priority":"media","desc":"Ver com a Eng Ana (alguma campanha de alerta)"},{"id":"1769104085177","title":"Dia do Trabalhador","date":"2026-05-01","priority":"media","desc":"Post a assinalar o dia"},{"id":"1769104098047","title":"Dia da M√£e","date":"2026-05-03","priority":"media","desc":"Post a assinalar o dia Dom Villas - cabaz dia da Mae - oferecer uma flor a cada m√£e"},{"id":"1769104115478","title":"Dia Internacional da Reciclagem","date":"2026-05-17","priority":"media","desc":"Post a assinalar o dia Dom Villas n√£o faz sentido"},{"id":"1769104134504","title":"Dia Mundial do Meio Ambiente","date":"2026-06-05","priority":"media","desc":"Post a assinalar o dia Dom Villas n√£o faz sentido"},{"id":"1769104145701","title":"Dia de Portugal","date":"2026-06-10","priority":"media","desc":"Post a assinalar o dia"},{"id":"1769104157214","title":"ARRAIAL POPULAR","date":"2026-06-20","priority":"media","desc":""},{"id":"1769104179587","title":"Dia do Cliente","date":"2026-09-15","priority":"media","desc":"Post a assinalar o dia"},{"id":"1769104194931","title":"Dia Mundial do Sorriso","date":"2026-10-02","priority":"media","desc":"Post a assinalar o dia"},{"id":"1769104216096","title":"Dia Mundial da Sa√∫de Mental","date":"2026-10-10","priority":"media","desc":"Post a assinalar o dia"},{"id":"1769104230152","title":"Halloween","date":"2026-10-31","priority":"media","desc":"Post a assinalar o dia"},{"id":"1769104245061","title":"Dia Mundial da Qualidade","date":"2026-11-13","priority":"media","desc":"Post a assinalar o dia Ver a√ß√£o com a Eng. Ana"},{"id":"1769104257848","title":"Black Friday","date":"2026-11-27","priority":"media","desc":"Post a assinalar o dia 10% DESCONTO"},{"id":"1769104271319","title":"Natal","date":"2026-12-25","priority":"media","desc":"Post a assinalar o dia"}];
        const CLOUD_DATA_NOTES = [{"id":"1769102811980","title":"CHECKLIST 2026 - MARKETING","content":"Alimentaria:\r\n- Stand (decis√£o do estilo de stand e or√ßamento)\r\nSial:\r\n- Plano da Feira - Voos e Estadia\r\n\r\nMerchadising Feiras\r\nDia da Seguran√ßa Alimentar - 06/02/2026\r\nDia Mundial do Queijo - 20-01-2026\r\nBenchmarking Supply Chain - GS1pt - n√£o\r\nPatroc√≠nios 2026\r\n- Dr.¬∫ Paulo Ruivo, Aves Btt (Elisabete) e BTT Famalic√£o\r\nPlano de Marketing 2026\r\nCami√µes e Vilarinho\r\nD√°diva de Sangue\r\n- Sr Araujo - ver viabilidade e datas poss√≠veis.\r\nSr. Queijo - Dom Villas\r\n- Protocolos;\r\n- Cart√£o cliente; \r\n- fazer toda a estrutura√ß√£o do pr√©-site; \r\n- ver campanha para anivers√°rios (personaliza√ß√£o);\r\n- Decora√ß√£o empresa;\r\n- Pequenas obras na Loja;\r\n- Loja Online (criar \"depend√™ncia\"); \r\nCat√°logo Dom Villas e Lactilouro e Lourofood\r\n- Ver modos de cat√°logos mais f√°cil de trocar refer√™ncias\r\n\r\nPack Boas vindas \r\n- Pack para novos colaboradores \r\n\r\nNewsletters\r\n- Internas\r\n- Externas (clientes) \r\n\r\nOutdoors Tem√°ticos\r\n- Autoestradas (j√° temos or√ßamentos)\r\n- Estruturar forma \r\n\r\nCalendariza√ß√£o de eventos\r\n\r\nSinal√©tica (placas)\r\nsinal√©tica de transito e lombas\r\nver a entrada (estacionamento)\r\n\r\nApresenta√ß√µes de empresa\r\n-2 tipos\r\nVcards\r\n- Cart√µes comerciais de QR \r\nVestu√°rio\r\n- Interno e Externo e Pins \r\n\r\nSoftware/Televis√£o\r\n- Indicadores mensais das empresas \r\n- Os nossos cuidados ambientais (usar fatores de compara√ß√£o)\r\n- V√≠deos internos (cuidados com os colaboradores) \r\n\r\nM√©tricas de Redes Sociais \r\nFolhetos informativos (colaboradores) \r\n- Como \"trabalhar\" com os nossos queijos; \r\n\r\nFardamento:\r\n- Interno;","date":"2026-01-22"},{"id":"1769102844070","title":"DIA SEGURAN√áA ALIMENTAR - PLANEAMENTO","content":"- Comunicado para os colaboradores: \r\npt e en (tudo igual).\r\n\r\n- Departamentos entrega at√© 28 janeiro:\r\npara o marketing e Eng. Ana\r\n\r\n- ver atividade para o final;\r\n- ver atividade para o final do almo√ßo;\r\n\r\nDepartamentos:\r\n- Indicadores\r\n- Qualidade\r\n- RH\r\n- Administrativo/Financeiro\r\n- Senhor Queijo\r\n- Lactilouro\r\n- Lourofood\r\n- Comercial","date":"2026-01-22"},{"id":"1769102874258","title":"REUNI√ÉO 22.01.2026","content":"Reuni√£o 16-01-2026\r\n\r\n\r\n- dia 06.02.2025\r\n   - ver apresenta√ß√µes - ok\r\n   - ver atividade final de almo√ßo - ok\r\n   - ver possibilidades de palestrantes (or√ßamento - 1000‚Ç¨+IVA); \r\n   - D¬™ Manuela - Associa√ß√£o de cantadores, ficou de ver a disponibilidade e pre√ßos (j√° liguei - 300‚Ç¨)\r\n   - ver os lanches.\r\n\r\nPatroc√≠nios:\r\n   - Aves BTT, Famalic√£o Btt;\r\n   - Amigos do Pedal (Dr Paulo Ruivo, enviar email com logotipo e confirma√ß√£o)\r\n\r\n- Sial:\r\n- ver viagens (marcar voos) - Voltar na segunda","date":"2026-01-22"}];
        const CLOUD_DATA_PLAN = {"forcas":"1. Modelo de Neg√≥cio Verticalizado e Integrado\nSinergia Operacional: A separa√ß√£o entre produ√ß√£o (Lactilouro) e acabamento/comercializa√ß√£o (Lourofood) permite uma especializa√ß√£o extrema em cada etapa da cadeia de valor.\nOrigem e Heran√ßa: O grupo nasceu de uma explora√ß√£o agropecu√°ria familiar, garantindo um conhecimento profundo da mat√©ria-prima (o leite) e uma narrativa de autenticidade que valoriza a marca junto do consumidor.\n\n2. Inova√ß√£o e Diferencia√ß√£o de Produto\nPioneirismo: Foram os primeiros em Portugal a produzir queijo de vaca Bio com leite de produtores locais.\nPortf√≥lio Diversificado: Capacidade de oferecer desde queijos artesanais de alta gama (Dom Villas) at√© solu√ß√µes convenientes para o retalho moderno (fatiados, ralados, snacks e op√ß√µes sem lactose).\nI&D Interno: Possuem um departamento pr√≥prio de Investiga√ß√£o e Desenvolvimento e colaboram com universidades para lan√ßar novos conceitos anualmente.\n\n3. Tecnologia e Efici√™ncia Produtiva\nModerniza√ß√£o Industrial: Investimentos recentes (superiores a 7 milh√µes de euros) em robotiza√ß√£o e sistemas de gest√£o de produ√ß√£o que garantem alta produtividade (ex: capacidade para 75 mil embalagens/dia na Lourofood).\nControlo de Qualidade: Processos rigorosos de rastreabilidade e seguran√ßa alimentar, com laborat√≥rio interno e testes di√°rios.\n\n4. Presen√ßa de Mercado e Internacionaliza√ß√£o\nPresen√ßa Global: Forte orienta√ß√£o para a exporta√ß√£o, estando presentes em mais de 10 pa√≠ses, incluindo mercados exigentes como EUA, Alemanha, Fran√ßa, Canad√° e M√©dio Oriente (Dubai).\nReconhecimento de Marca: A marca Dom Villas est√° consolidada como uma ins√≠gnia de qualidade e confian√ßa, tanto no com√©rcio tradicional como na grande distribui√ß√£o.\n\n5. Sustentabilidade e Responsabilidade\nEfici√™ncia Energ√©tica: Utiliza√ß√£o de pain√©is fotovoltaicos que suprem mais de metade das necessidades energ√©ticas e sistemas de recupera√ß√£o de energia t√©rmica.\nEconomia Circular: Forte aposta na redu√ß√£o de desperd√≠cios produtivos e reciclagem de materiais de embalagem.","fraquezas":"1. Depend√™ncia da Volatilidade da Mat√©ria-Prima\nCusto do Leite: Como o grupo depende fortemente do fornecimento de leite de terceiros (produtores locais), qualquer flutua√ß√£o nos pre√ßos de produ√ß√£o agr√≠cola ou crises no setor leiteiro impacta diretamente as margens de lucro.\nSazonalidade: A produ√ß√£o de leite pode variar sazonalmente, o que exige uma gest√£o de stocks e planeamento de produ√ß√£o extremamente r√≠gidos para evitar quebras ou excessos.\n\n2. Complexidade Log√≠stica e de Gest√£o\nEstrutura Dual: Embora a separa√ß√£o entre Lactilouro e Lourofood traga especializa√ß√£o, tamb√©m cria uma necessidade de coordena√ß√£o log√≠stica e administrativa muito complexa entre as duas unidades para evitar redund√¢ncias de custos e falhas na comunica√ß√£o interna.\nCustos de Distribui√ß√£o: Por lidar com produtos perec√≠veis que exigem cadeia de frio, os custos log√≠sticos (especialmente no transporte para exporta√ß√£o) s√£o elevados e sens√≠veis ao pre√ßo dos combust√≠veis.\n\n3. Concentra√ß√£o no Setor de Lactic√≠nios\nFoco Num S√≥ Segmento: Ao contr√°rio de grandes grupos alimentares diversificados, o grupo est√° quase totalmente exposto √†s tend√™ncias e crises espec√≠ficas do setor de lactic√≠nios (como a queda do consumo de leite animal em certas demografias).\nDepend√™ncia da Grande Distribui√ß√£o: Uma fatia consider√°vel das vendas da Lourofood depende das grandes superf√≠cies (marcas pr√≥prias ou distribui√ß√£o direta). Isto confere um grande poder de negocia√ß√£o aos retalhistas, pressionando as margens das empresas.\n\n4. Reconhecimento de Marca Global vs. Marcas Brancas\nMarca Pr√≥pria vs. Dom Villas: A Lourofood produz significativamente para marcas de distribuidores (marcas brancas). Embora garanta volume, isto dilui o reconhecimento da marca pr√≥pria (Dom Villas) e torna a empresa substitu√≠vel se um concorrente oferecer um pre√ßo mais baixo por quilo.\nMarketing Limitado: Em compara√ß√£o com gigantes multinacionais do setor (como a Lactalis ou Nestl√©), o or√ßamento para marketing e publicidade direta ao consumidor final √© mais reduzido, limitando a expans√£o da marca em novos mercados.\n\n5. Reten√ß√£o de Talentos em Setores Especializados\nM√£o de Obra Qualificada: A crescente automatiza√ß√£o das f√°bricas exige t√©cnicos altamente especializados. Numa regi√£o industrial como Famalic√£o, a competi√ß√£o por talento qualificado (manuten√ß√£o industrial, engenharia alimentar) √© intensa, o que pode levar √† rotatividade de pessoal chave.","oportunidades":"1. Expans√£o do Mercado de Conveni√™ncia (Snacking)\nTend√™ncia de Consumo: H√° uma procura crescente por produtos l√°cteos prontos a consumir, saud√°veis e em por√ß√µes individuais (queijo em palitos, cubos ou snacks).\nAproveitamento: A Lourofood, com a sua capacidade de corte e embalamento, pode lan√ßar linhas espec√≠ficas de \"On-the-go\" para gin√°sios, escolas e escrit√≥rios.\n\n2. Crescimento do Segmento \"Bio\" e Bem-Estar\nAlimentos Funcionais: Oportunidade para desenvolver queijos com redu√ß√£o de s√≥dio, enriquecidos com prote√≠nas ou probi√≥ticos.\nSustentabilidade: Sendo pioneiros no queijo Bio em Portugal, o grupo pode capitalizar o aumento da consci√™ncia ambiental dos consumidores europeus para aumentar a sua quota de mercado no Norte da Europa.\n\n3. Explora√ß√£o de Novos Mercados Internacionais\nMercados Emergentes e √Åsia: Com a consolida√ß√£o da marca nos EUA e M√©dio Oriente, mercados como a China e o Sudeste Asi√°tico apresentam uma classe m√©dia crescente com apetite por produtos gourmet europeus.\n\nE-commerce Transfronteiri√ßo: A cria√ß√£o de uma plataforma de venda direta ou parcerias com marketplaces globais de luxo alimentar.\n\n4. Digitaliza√ß√£o e Ind√∫stria 4.0\nBig Data e IA: Utilizar an√°lise de dados para prever a procura com maior precis√£o, otimizando os stocks da Lourofood e reduzindo o desperd√≠cio alimentar.\n\nRastreabilidade Blockchain: Implementar selos de transpar√™ncia onde o consumidor pode ler um QR Code e ver todo o caminho do queijo, desde a explora√ß√£o agr√≠cola at√© √† prateleira.\n\n5. Substitutos L√°cteos e Diversifica√ß√£o (Plant-based)\nHibridiza√ß√£o: O crescimento do mercado vegano e flexitariano abre portas para a Lourofood utilizar a sua infraestrutura de embalamento e distribui√ß√£o para linhas de \"queijos\" vegetais (base de am√™ndoa, caju ou coco), diversificando o risco do setor leiteiro.","ameacas":"1. Instabilidade nos Custos de Produ√ß√£o e Energia\nCrise Energ√©tica: Como unidades industriais que dependem de refrigera√ß√£o constante (24h/7) e processamento t√©rmico, qualquer aumento nos pre√ßos da eletricidade ou g√°s tem um impacto severo e imediato nas margens.\nInfla√ß√£o Alimentar: O aumento do pre√ßo dos cereais e ra√ß√µes afeta diretamente o custo do leite √† produ√ß√£o, obrigando o grupo a renegociar pre√ßos com a grande distribui√ß√£o, o que nem sempre √© aceite.\n\n2. Altera√ß√µes nos H√°bitos de Consumo\nTend√™ncia Anti-Lactic√≠nios: O crescimento de movimentos que promovem a redu√ß√£o do consumo de prote√≠na animal (por raz√µes de sa√∫de ou √©tica) pode levar a uma contra√ß√£o estrutural do mercado de queijos tradicionais.\nProcura por Pre√ßo (Down-trading): Em cen√°rios de crise econ√≥mica, os consumidores tendem a abandonar marcas premium (como a Dom Villas) em favor das marcas de distribuidor (marcas brancas) mais baratas.\n\n3. Concorr√™ncia Global e Consolida√ß√£o do Setor\nGigantes Multinacionais: A entrada de grandes grupos internacionais (como a Lactalis ou Arla) com economias de escala massivas pode esmagar os pre√ßos no mercado nacional.\nImporta√ß√µes de Baixo Custo: A entrada de queijos de pa√≠ses com custos de produ√ß√£o mais baixos (ex: Pol√≥nia ou Alemanha) desafia a competitividade da produ√ß√£o nacional.\n\n4. Press√£o Regulat√≥ria e Ambiental\nRegulamenta√ß√£o Europeia (Green Deal): Novas leis sobre embalagens de pl√°stico de uso √∫nico podem exigir investimentos avultados e r√°pidos na reconvers√£o das linhas de embalamento da Lourofood.\nTaxas de Carbono: Futuras taxas sobre a pegada de carbono da pecu√°ria podem encarecer indiretamente o produto final.\n\n5. Escassez de Recursos H√≠dricos\nAltera√ß√µes Clim√°ticas: Sendo o setor leiteiro intensivo em consumo de √°gua (tanto na produ√ß√£o do leite como na higieniza√ß√£o industrial), secas prolongadas podem afetar a disponibilidade e o custo deste recurso essencial no Norte de Portugal.","objetivos":"Refor√ßo da Marca Dom Villas: Posicionar a marca n√£o apenas como um produto tradicional, mas como uma refer√™ncia de lifestyle saud√°vel e gourmet, aumentando o seu reconhecimento direto junto do consumidor final (B2C).\n\nRastreabilidade Total: Implementar sistemas de transpar√™ncia digital (ex: Blockchain ou QR Codes din√¢micos) que permitam ao cliente final conhecer a origem exata do leite e a pegada de carbono de cada unidade.\n\nHumaniza√ß√£o da Marca: Capitalizar a origem familiar do grupo para contar a hist√≥ria \"do prado ao prato\", refor√ßando a confian√ßa e a autenticidade perante o consumidor.\n\nPremiumiza√ß√£o: Elevar a percep√ß√£o da marca Dom Villas como um produto gourmet acess√≠vel, diferenciando-o das marcas de distribuidor (marcas brancas) atrav√©s do design de embalagem e storytelling.\n\nP (Produto)\t\t\tP (Promo√ß√£o)\nAlargar a gama de queijos funcionais e snacks.\n\nP (Pre√ßo)\t\nEstrat√©gia de valor (Value-based), defendendo a margem pela qualidade.\tExpans√£o no canal Horeca e exporta√ß√£o direta.\tCampanhas digitais segmentadas e parcerias com influencers de gastronomia.\n\nP (Pra√ßa/Distribui√ß√£o)\nExpans√£o no canal Horeca e exporta√ß√£o direta.\n\nP (Promo√ß√£o)\nCampanhas digitais segmentadas e parcerias com influencers de gastronomia.\n\nInstagram:\n√â a rede principal para o setor alimentar. O objetivo √© criar uma comunidade aspiracional.\nMeta: Alcan√ßar o m√°ximo de seguidores nos 3 canais de Instagram.\nKPI de Apoio: Taxa de intera√ß√£o (likes/coment√°rios) superior a 2.5%.\n\nLinkedIn: \nEssencial para a internacionaliza√ß√£o e para atrair parceiros de distribui√ß√£o.\nMeta: Alcan√ßar os 3.000 seguidores profissionais.\nKPI de Apoio: Cliques nos links de cat√°logos para exporta√ß√£o.\nEstrat√©gia: Publica√ß√£o de conte√∫dos sobre sustentabilidade, pr√©mios e expans√£o industrial.\n\nTikTok:\nFocado em atingir o p√∫blico mais jovem e mostrar a versatilidade dos produtos Lourofood.\nMeta: Alcan√ßar os 5.000 a 8.000 seguidores.\nKPI de Apoio: M√©dia de 2.000 visualiza√ß√µes por v√≠deo de receita.\nEstrat√©gia: Participa√ß√£o em trends de culin√°ria e v√≠deos de \"receitas em 1 minuto\".","metas":"Metas de Marketing e Presen√ßa Digital\nCrescimento de Seguidores: Atingir uma nova marca de seguidores.\nTaxa de Engajamento: Manter uma taxa de intera√ß√£o m√©dia de 3% em todos os canais sociais, atrav√©s de 3 publica√ß√µes semanais de alta qualidade.\n","kpis":"KPIs de Branding e Reconhecimento (Brand Awareness)Estes medem o qu√£o conhecida e respeitada √© a marca no mercado.\nShare of Voice (SoV): Percentagem de men√ß√µes √† marca Dom Villas face aos principais concorrentes nas redes sociais e imprensa especializada.\nSentimento da Marca: R√°cio entre men√ß√µes positivas, neutras e negativas. Meta: >85% de sentimento positivo.Recorda√ß√£o da Marca (Brand Recall): Medido atrav√©s de inqu√©ritos ou pesquisas diretas de \"Top of Mind\" no segmento de queijos biol√≥gicos/premium.\n\nKPIs de Performance Digital (Social & Web)Focados no crescimento e intera√ß√£o das comunidades que definimos anteriormente.\nTaxa de Engajamento por Post: .\nCrescimento da Comunidade: N√∫mero de novos seguidores qualificados por m√™s.\nTaxa de Visualiza√ß√£o de V√≠deo (VTR): Especialmente relevante para as receitas no TikTok e Reels. Meta: 25% de reten√ß√£o at√© ao final do v√≠deo.\n\nKPIs de Trade Marketing e Vendas.\nO marketing a trabalhar em conjunto com a equipa comercial para escoar produto.\nROI de Campanhas de Sazonalidade: Retorno sobre o investimento feito em marketing nas √©pocas de pico (P√°scoa e Natal).\nReden√ß√£o de Cup√µes/Promos: Se forem feitas campanhas digitais com descontos para o retalho, medir quantos foram efetivamente utilizados.","publico":"A. Segmento \"Gourmet & Consciente\"\nPerfil: Valoriza a origem, o selo \"Bio\" e processos artesanais. Est√° disposto a pagar mais por qualidade superior.\nFoco de Produto: Queijos Dom Villas, Queijo Bio, Edi√ß√µes Limitadas.\n\nB. Segmento \"Conveni√™ncia & Estilo de Vida\"\nPerfil: Pessoas ativas, profissionais urbanos e jovens que procuram lanches saud√°veis, mas n√£o t√™m tempo para prepara√ß√µes complexas.\nFoco de Produto: Fatiados Lourofood, Snacks de queijo, Queijos ralados para culin√°ria r√°pida.\n\nC. Segmento \"B2B e Trade\"\nPerfil: Compradores de grandes superf√≠cies, donos de lojas gourmet, distribuidores internacionais e canal HORECA (Hot√©is e Restaurantes).\nFoco de Produto: Formatos industriais, solu√ß√µes de marca pr√≥pria e cat√°logos de exporta√ß√£o.","personas":"Persona 1: A \"Helena Tradicional\"\nIdade: 45-65 anos.\nOcupa√ß√£o: Profissional liberal / Classe m√©dia-alta.\nEstilo de Vida: Gosta de receber amigos em casa, valoriza vinhos e gastronomia regional. L√™ r√≥tulos e procura o selo \"Portugal Sou Eu\".\nDor: Dificuldade em encontrar produtos aut√™nticos que mantenham o sabor do \"queijo de antigamente\".\nCanais: Facebook e Instagram (conte√∫do est√©tico e informativo).\n\nPersona 2: O \"Tiago Equilibrado\" \nIdade: 28-40 anos.\nOcupa√ß√£o: Gestor / Especialista em tecnologia.\nEstilo de Vida: Pratica desporto, leva marmita para o trabalho e valoriza snacks proteicos. Procura solu√ß√µes pr√°ticas (embalagens easy-open).\nDor: Falta de tempo para cozinhar; procura snacks saud√°veis que substituam produtos ultraprocessados.\nCanais: Instagram e TikTok (receitas de 15 segundos e dicas de nutri√ß√£o).","posicionamento":"Para consumidores que valorizam a autenticidade e a conveni√™ncia, a Lactilouro/Lourofood √© o grupo de lactic√≠nios portugu√™s que combina a heran√ßa da produ√ß√£o tradicional com a inova√ß√£o industrial de vanguarda, entregando produtos seguros, sustent√°veis e com o sabor genu√≠no da nossa terra.","estrategias":"A. Posicionamento por Atributo e Origem (Dom Villas)\nFoco: A \"Alma do Queijo\".\nT√°tica: Refor√ßar a origem em Vila Nova de Famalic√£o e o uso de leite de produtores locais.\nMensagem-chave: \"O sabor que vem da nossa hist√≥ria.\"\nDiferenciador: O selo de Pioneiro em Bio e a heran√ßa familiar.\n\nB. Posicionamento por Benef√≠cio e Uso (Lourofood)\nFoco: A \"Solu√ß√£o no Prato\".\nT√°tica: Posicionar os produtos fatiados, ralados e snacks como facilitadores do dia-a-dia para fam√≠lias modernas e profissionais ocupados.\nMensagem-chave: \"Qualidade gourmet, pronta a usar.\"\nDiferenciador: Tecnologia de embalamento que preserva a frescura por mais tempo sem aditivos desnecess√°rios.\n\nC. Posicionamento por Responsabilidade (ESG)\nFoco: O \"Futuro Sustent√°vel\".\nT√°tica: Comunicar ativamente a redu√ß√£o da pegada de carbono e o uso de energia solar.\nMensagem-chave: \"Respeitamos o prado para honrar o seu prato.\"","canais":"--","calendario":"--","orcamentoTotal":"","distribuicao":"--","q1":"--","q2":"--","q3":"--","q4":"--","ferramentas":"A. Gest√£o de Redes Sociais e Listening\nMeltwater ou Hootsuite: Para monitorizar men√ß√µes √† marca Dom Villas e √† Lactilouro em toda a web. Permite medir o Sentiment Analysis (se as pessoas est√£o a falar bem ou mal) e acompanhar a concorr√™ncia.\nMeta Business Suite: Para an√°lise nativa de performance no Instagram e Facebook (alcance, cliques e demografia dos seguidores).\n\nB. An√°lise de Tr√°fego e Convers√£o\nGoogle Analytics 4 (GA4): Essencial para monitorizar o tr√°fego no site institucional e, futuramente, no cat√°logo digital B2B.\nHotjar: Para entender como os potenciais parceiros ou consumidores navegam no site (mapas de calor) e onde desistem de pedir informa√ß√µes.\n\nC. Reputa√ß√£o e Trade Marketing\nGoogle Business Profile: Monitoriza√ß√£o di√°ria de avalia√ß√µes e fotos carregadas por clientes nas localiza√ß√µes f√≠sicas.\nSistemas de CRM (ex: Salesforce ou HubSpot): Para o marketing medir quantas \"leads\" (pedidos de or√ßamento de exporta√ß√£o ou revenda) foram geradas pelas campanhas digitais.","revisao":"1. N√≠veis de Revis√£o\nA. Revis√£o Semanal (Operacional - Marketing Digital)\nFoco: Desempenho imediato das redes sociais e campanhas de an√∫ncios (Ads).\nA√ß√£o: Ajustar or√ßamentos de publicidade, responder a tend√™ncias (trends) e verificar o calend√°rio de publica√ß√µes para a semana seguinte.\nRespons√°vel: Gestor de Redes Sociais / Equipa de Marketing.\n\nB. Revis√£o Mensal (T√°tica - KPIs)\nFoco: Compara√ß√£o dos resultados do m√™s face √†s metas SMART.\nA√ß√£o: Analisar o custo por lead (B2B), o crescimento de seguidores e os dados de sell-out (vendas no retalho). Identificar desvios e aplicar corre√ß√µes r√°pidas.\nRespons√°vel: Dire√ß√£o de Marketing e Dire√ß√£o Comercial.\n\nC. Revis√£o Trimestral (Estrat√©gica - Rumos)\nFoco: An√°lise profunda da concorr√™ncia e do mercado (An√°lise SWOT din√¢mica).\nA√ß√£o: Avaliar se o posicionamento de marca continua eficaz e decidir sobre o lan√ßamento de novos produtos ou entrada em novos mercados de exporta√ß√£o."};
        const CLOUD_DATA_CRISIS_PLAN = {};
        const CLOUD_DATA_PARTNERSHIPS = [{"id":"1769102951895","tipo":"parceria","nome":"AESA","desc":"PARCERIA EM PRODUTOS","valor":1000,"inicio":"2026-01-01","fim":"2026-12-31","comTeto":true,"teto":1000,"faturas":[]}];
        const CLOUD_DATA_PATROCINIOS = [{"id":"1769102998307","nome":"GRUPO DESPORTIVO DO LOURO","desc":"Patroc√≠nio desportivo","valor":6385,"data":"2026-01-01"},{"id":"1769103027114","nome":"BTT - DESPORTIVO DAS AVES","desc":"Patroc√≠nio Desportivo","valor":750,"data":"2026-10-01"},{"id":"1769103083927","nome":"BTT - CLUBE FAMALIC√ÉO","desc":"Patroc√≠nio Desportivo","valor":750,"data":"2026-01-01"},{"id":"1769103105009","nome":"SQUADRA - AMIGOS DO PEDAL","desc":"Patroc√≠nio Desportivo","valor":1500,"data":"2026-01-01"},{"id":"1769103169945","nome":"PAROQUIA DE SANTA LUCR√âCIA - LOURO","desc":"Ajuda Comunit√°ria (religi√£o)","valor":750,"data":"2026-01-01"},{"id":"1769103206634","nome":"FESTAS DE SANTO ANT√ìNIO - LOURO","desc":"Religioso - Donativo Festas","valor":750,"data":"2026-01-01"},{"id":"1769103238500","nome":"ROTARY CLUB DE FAMALIC√ÉO","desc":"Patroc√≠nio dado o ano passado","valor":500,"data":"2026-01-01"},{"id":"1769103521947","nome":"Bombeiros","desc":"Institucional","valor":100,"data":"2026-01-01"}];
        const CLOUD_DATA_FEIRAS = [{"id":"1769103370110","nome":"ALIMENTARIA - BARCELONA - 23 A 26 MAR√áO 2026 - ATUALIZADO","local":"Barcelona","data":"2026-03-23","valor":37500,"parcelas":[]},{"id":"1769103394140","nome":"SIAL PARIS - 17 A 21 OUTUBRO 2026 - ATUALIZADO","local":"Paris","data":"2026-10-17","valor":45000,"parcelas":[]}];
        const CLOUD_DATA_MATERIAL = [{"id":"1769103426599","nome":"M√°quina Fotogr√°fica Mirrorless Sony Alpha a7 Mark III + SEL-2860 FE 28-60mm f/4-5.6 OSS + FE 50mm f/1.8 + Bateria Extra NP-FZ100","desc":"M√°quina Fotogr√°fica","valor":1690,"data":"2026-01-01"},{"id":"1769103453052","nome":"ESTABILIZADOR DJI RS 4 MINI COMBO","desc":"Estabilizador de v√≠deo e fotos","valor":489,"data":"2026-01-01"},{"id":"1769103462944","nome":"CAIXA DE LUZ PARA FOTOGRAFIA DE PRODUTO","desc":"","valor":90,"data":"2026-01-01"},{"id":"1769103492833","nome":"OP√á√ÉO B - TELEMOV√âL iPhone 17 Pro APPLE (6.3'' - 256 GB)","desc":"OPC√ÉO B EM VEZ DA M√ÅQUINA","valor":1349,"data":"2026-01-01"}];
        const CLOUD_DATA_GERAL = [{"id":"1769103632953","nome":"BRINDES","desc":"Publicidade","valor":0,"data":"2026-01-01"},{"id":"1769103648080","nome":"CAT√ÅLOGOS","desc":"Impress√£o e Gr√°fica","valor":0,"data":"2026-01-01"},{"id":"1769103708379","nome":"TENDA PARA EVENTOS - Tenda Promo Domo - Small","desc":"Publicidade\nhttps://www.jb-insuflaveis.pt/tenda-promo-domo-small-0","valor":1350,"data":"2026-01-01"},{"id":"1769103724077","nome":"OUTDOORS - COLOCA√á√ÉO E IMPRESS√ÉO - ENIF","desc":"Publicidade","valor":2200,"data":"2026-01-01"},{"id":"1769103751107","nome":"ALUGUER OUTDOORS - ALUGUER - ENIF","desc":"Publicidade - 3 outdoors por ano","valor":6000,"data":"2026-01-01"},{"id":"1769103771785","nome":"OUTDOOR A3 - SAIDA GUIMAR√ÉES FAMALIC√ÉO - 1 ANO - CSOUTDOORS","desc":"Publicidade","valor":2445,"data":"2026-01-01"},{"id":"1769103795695","nome":"DECORA√á√ÉO LOJA - O SR.¬∫ QUEIJO","desc":"Aguarda or√ßamento - LS Interiores - 252 322 412","valor":0,"data":"2026-01-01"}];
        const CLOUD_DATA_EVENTOS_ESPECIAIS = [{"id":"1769103554579","nome":"DIA DA MULHER","desc":"BRINDE A TODAS AS COLABORADORAS","data":"2026-03-08","valor":300},{"id":"1769103588808","nome":"ARRAIAL POPULAR","desc":"ARRAIAL POPULAR COMES E BEBES \nM√öSICA: CANTARES AO DESAFIO","data":"2026-06-20","valor":2000},{"id":"1769103611496","nome":"ANIVERS√ÅRIOS DAS EMPRESAS","desc":"BOLO COMEMORATIVO BRINDE COLABORADOR","data":"2026-11-16","valor":3000}];

        // State variables
        let events = [];
        let notes = [];
        let plan = {};
        let crisisPlan = {};
        let partnerships = [];
        let patrocinios = [];
        let feiras = [];
        let material = [];
        let geral = [];
        let eventosEspeciais = [];
        let currentPartnershipFilter = 'all';
        let currentMonthFilter = 'all';
        let currentYear = 2026;
        let showArchivedEvents = false;
        let currentPartnershipId = null; // For invoices
        let currentFeiraId = null; // For parcelas

        // Year navigation
        function changeYear(delta) {
            currentYear += delta;
            document.getElementById('currentYearDisplay').textContent = currentYear;
            renderAgenda();
        }

        // Toggle between active and archived events
        function toggleEventosView(view) {
            showArchivedEvents = (view === 'arquivados');
            
            // Update button styles
            const btnAtivos = document.getElementById('btnEventosAtivos');
            const btnArquivados = document.getElementById('btnEventosArquivados');
            
            if (showArchivedEvents) {
                btnAtivos.style.background = '';
                btnAtivos.style.color = '';
                btnAtivos.className = 'btn btn-secondary';
                btnArquivados.style.background = 'var(--primary)';
                btnArquivados.style.color = 'white';
                btnArquivados.className = 'btn';
            } else {
                btnAtivos.style.background = 'var(--primary)';
                btnAtivos.style.color = 'white';
                btnAtivos.className = 'btn';
                btnArquivados.style.background = '';
                btnArquivados.style.color = '';
                btnArquivados.className = 'btn btn-secondary';
            }
            
            renderAgenda();
        }

        // Export events to PDF
        function exportEventosPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            const title = showArchivedEvents ? 'Eventos Arquivados' : 'Eventos Ativos';
            doc.setFontSize(18);
            doc.text(title, 14, 20);
            
            const eventsToExport = showArchivedEvents ? 
                events.filter(e => new Date(e.date + 'T00:00:00') < new Date()) :
                events.filter(e => new Date(e.date + 'T00:00:00') >= new Date());
            
            const tableData = eventsToExport
                .sort((a, b) => new Date(a.date) - new Date(b.date))
                .map(e => [
                    e.title,
                    formatDate(e.date),
                    e.company || '-',
                    e.priority,
                    e.desc || '-'
                ]);
            
            doc.autoTable({
                head: [['Evento', 'Data', 'Empresa', 'Prioridade', 'Descri√ß√£o']],
                body: tableData,
                startY: 30,
                styles: { font: 'helvetica', fontSize: 10 },
                headStyles: { fillColor: [99, 102, 241] }
            });
            
            doc.save(`eventos_${showArchivedEvents ? 'arquivados' : 'ativos'}_${currentYear}.pdf`);
            showToast('PDF exportado com sucesso!');
        }

        // Export events to Excel
        function exportEventosExcel() {
            const eventsToExport = showArchivedEvents ? 
                events.filter(e => new Date(e.date + 'T00:00:00') < new Date()) :
                events.filter(e => new Date(e.date + 'T00:00:00') >= new Date());
            
            const data = eventsToExport
                .sort((a, b) => new Date(a.date) - new Date(b.date))
                .map(e => ({
                    'Evento': e.title,
                    'Data': e.date,
                    'Empresa': e.company || '-',
                    'Prioridade': e.priority,
                    'Descri√ß√£o': e.desc || '-'
                }));
            
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Eventos');
            
            XLSX.writeFile(wb, `eventos_${showArchivedEvents ? 'arquivados' : 'ativos'}_${currentYear}.xlsx`);
            showToast('Excel exportado com sucesso!');
        }

        // Utility functions
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                </svg>
                <span>${message}</span>
            `;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        function formatDate(dateStr) {
            if (!dateStr) return '';
            const date = new Date(dateStr + 'T00:00:00');
            return date.toLocaleDateString('pt-PT', { day: '2-digit', month: 'short', year: 'numeric' });
        }

        function getMonthName(monthNumber) {
            const months = ['Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho', 
                          'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
            return months[monthNumber - 1];
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('active');
        }

        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            event.target.closest('.nav-item').classList.add('active');
            
            if (window.innerWidth <= 768) {
                document.getElementById('sidebar').classList.remove('active');
            }
        }

        // Month filter
        function filterByMonth(month) {
            currentMonthFilter = month;
            
            // Update active button
            document.querySelectorAll('.month-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderAgenda();
        }

        // Dashboard
        function renderDashboard() {
            const totalEvents = events.length;
            const totalPartners = partnerships.length;
            
            const totalBudget = 
                patrocinios.reduce((sum, p) => sum + parseFloat(p.valor || 0), 0) +
                feiras.reduce((sum, f) => sum + parseFloat(f.valor || 0), 0) +
                material.reduce((sum, m) => sum + parseFloat(m.valor || 0), 0) +
                geral.reduce((sum, g) => sum + parseFloat(g.valor || 0), 0) +
                eventosEspeciais.reduce((sum, e) => sum + parseFloat(e.valor || 0), 0);

            // Pr√≥ximo Evento
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const upcomingEvents = events
                .filter(e => new Date(e.date + 'T00:00:00') >= today)
                .sort((a, b) => new Date(a.date) - new Date(b.date));

            if (upcomingEvents.length > 0) {
                const nextEvent = upcomingEvents[0];
                const eventDate = new Date(nextEvent.date + 'T00:00:00');
                const diffTime = eventDate - today;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                document.getElementById('nextEventName').textContent = nextEvent.title;
                document.getElementById('nextEventDetails').innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px; font-size: 0.95rem;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                        ${formatDate(nextEvent.date)}
                    </div>
                `;
                
                let countdownText = '';
                if (diffDays === 0) {
                    countdownText = 'üéØ HOJE!';
                } else if (diffDays === 1) {
                    countdownText = '‚ö° Amanh√£';
                } else if (diffDays <= 2) {
                    countdownText = `‚ö†Ô∏è Faltam ${diffDays} dias`;
                } else {
                    countdownText = `Faltam ${diffDays} dias`;
                }
                
                document.getElementById('nextEventCountdown').textContent = countdownText;
            } else {
                document.getElementById('nextEventName').textContent = 'Nenhum evento pr√≥ximo';
                document.getElementById('nextEventDetails').innerHTML = '';
                document.getElementById('nextEventCountdown').textContent = 'Adicione um evento ao calend√°rio';
            }


            const statsGrid = document.getElementById('statsGrid');
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white;">üìÖ</div>
                    </div>
                    <div class="stat-value">${totalEvents}</div>
                    <div class="stat-label">Eventos Planeados</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #14b8a6 0%, #10b981 100%); color: white;">ü§ù</div>
                    </div>
                    <div class="stat-value">${totalPartners}</div>
                    <div class="stat-label">Parcerias Ativas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #ec4899 0%, #f43f5e 100%); color: white;">üí∞</div>
                    </div>
                    <div class="stat-value">‚Ç¨${totalBudget.toLocaleString('pt-PT')}</div>
                    <div class="stat-label">Or√ßamento Total</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b 0%, #eab308 100%); color: white;">üìù</div>
                    </div>
                    <div class="stat-value">${notes.length}</div>
                    <div class="stat-label">Notas Criadas</div>
                </div>
            `;

            updateBudget();
        }

        function updateBudget() {
            const patrociniosTotal = patrocinios.reduce((sum, p) => sum + parseFloat(p.valor || 0), 0);
            const feirasTotal = feiras.reduce((sum, f) => sum + parseFloat(f.valor || 0), 0);
            const materialTotal = material.reduce((sum, m) => sum + parseFloat(m.valor || 0), 0);
            const geralTotal = geral.reduce((sum, g) => sum + parseFloat(g.valor || 0), 0);
            const eventosEspeciaisTotal = eventosEspeciais.reduce((sum, e) => sum + parseFloat(e.valor || 0), 0);
            const total = patrociniosTotal + feirasTotal + materialTotal + geralTotal + eventosEspeciaisTotal;

            document.getElementById('budgetSummary').innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%); 
                         padding: 20px; border-radius: 16px; border-left: 4px solid #6366f1;">
                        <div style="color: #64748b; font-size: 0.85rem; margin-bottom: 8px;">üí∞ Patroc√≠nios</div>
                        <div style="font-size: 1.8rem; font-weight: 800; color: var(--dark);">‚Ç¨${patrociniosTotal.toLocaleString('pt-PT')}</div>
                    </div>
                    <div style="background: linear-gradient(135deg, rgba(20, 184, 166, 0.1) 0%, rgba(16, 185, 129, 0.1) 100%); 
                         padding: 20px; border-radius: 16px; border-left: 4px solid #14b8a6;">
                        <div style="color: #64748b; font-size: 0.85rem; margin-bottom: 8px;">üè™ Feiras</div>
                        <div style="font-size: 1.8rem; font-weight: 800; color: var(--dark);">‚Ç¨${feirasTotal.toLocaleString('pt-PT')}</div>
                    </div>
                    <div style="background: linear-gradient(135deg, rgba(236, 72, 153, 0.1) 0%, rgba(244, 63, 94, 0.1) 100%); 
                         padding: 20px; border-radius: 16px; border-left: 4px solid #ec4899;">
                        <div style="color: #64748b; font-size: 0.85rem; margin-bottom: 8px;">üé® Material</div>
                        <div style="font-size: 1.8rem; font-weight: 800; color: var(--dark);">‚Ç¨${materialTotal.toLocaleString('pt-PT')}</div>
                    </div>
                    <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(234, 179, 8, 0.1) 100%); 
                         padding: 20px; border-radius: 16px; border-left: 4px solid #f59e0b;">
                        <div style="color: #64748b; font-size: 0.85rem; margin-bottom: 8px;">üìã Geral</div>
                        <div style="font-size: 1.8rem; font-weight: 800; color: var(--dark);">‚Ç¨${geralTotal.toLocaleString('pt-PT')}</div>
                    </div>
                    <div style="background: linear-gradient(135deg, rgba(147, 51, 234, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%); 
                         padding: 20px; border-radius: 16px; border-left: 4px solid #9333ea;">
                        <div style="color: #64748b; font-size: 0.85rem; margin-bottom: 8px;">‚≠ê Eventos Especiais</div>
                        <div style="font-size: 1.8rem; font-weight: 800; color: var(--dark);">‚Ç¨${eventosEspeciaisTotal.toLocaleString('pt-PT')}</div>
                    </div>
                </div>
                <div style="margin-top: 30px; padding: 30px; background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); 
                     border-radius: 20px; color: white; text-align: center;">
                    <div style="font-size: 1rem; opacity: 0.9; margin-bottom: 8px;">Or√ßamento Total 2026</div>
                    <div style="font-size: 3rem; font-weight: 800;">‚Ç¨${total.toLocaleString('pt-PT')}</div>
                </div>
            `;
        }

        // Events
        function openEventModal() {
            editingEventId = null;
            document.querySelector('#eventModal .modal-title').textContent = 'Novo Evento';
            document.getElementById('eventModal').classList.add('active');
        }

        function closeEventModal() {
            document.getElementById('eventModal').classList.remove('active');
            document.getElementById('eventTitle').value = '';
            document.getElementById('eventDate').value = '';
            document.getElementById('eventPriority').value = 'media';
            document.getElementById('eventCompany').value = 'lourofood';
            document.getElementById('eventDesc').value = '';
            editingEventId = null;
        }

        let editingEventId = null;
        let editingPartnershipId = null;
        let editingMaterialId = null;
        let editingGeralId = null;
        let editingNoteId = null;
    

        function saveEvent() {
            const eventData = {
                title: document.getElementById('eventTitle').value.trim(),
                date: document.getElementById('eventDate').value,
                priority: document.getElementById('eventPriority').value,
                company: document.getElementById('eventCompany').value,
                desc: document.getElementById('eventDesc').value.trim()
            };

            if (!eventData.title || !eventData.date) {
                showToast('Preencha todos os campos!', 'error');
                return;
            }

            if (editingEventId) {
                // Modo edi√ß√£o
                const index = events.findIndex(e => e.id === editingEventId);
                events[index] = { ...events[index], ...eventData };
                showToast('Evento atualizado!');
                editingEventId = null;
            } else {
                // Modo cria√ß√£o
                events.push({
                    id: Date.now().toString(),
                    ...eventData
                });
                showToast('Evento adicionado!');
            }

            closeEventModal();
            renderAgenda();
            renderDashboard();
            sync();
        }

        function editEvent(id) {
            editingEventId = id;
            const event = events.find(e => e.id === id);
            
            document.getElementById('eventTitle').value = event.title;
            document.getElementById('eventDate').value = event.date;
            document.getElementById('eventPriority').value = event.priority;
            document.getElementById('eventCompany').value = event.company || 'lourofood';
            document.getElementById('eventDesc').value = event.desc || '';
            
            document.querySelector('#eventModal .modal-title').textContent = 'Editar Evento';
            document.getElementById('eventModal').classList.add('active');
        }

        function deleteEvent(id) {
            if (!confirm('Tem certeza?')) return;
            events = events.filter(e => e.id !== id);
            renderAgenda();
            renderDashboard();
            sync();
            showToast('Removido!', 'warning');
        }

        function renderAgenda() {
            const container = document.getElementById('agendaContainer');
            const emptyState = document.getElementById('emptyAgenda');
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            let filteredEvents = events.filter(e => {
                const eventDate = new Date(e.date + 'T00:00:00');
                const matchesYear = eventDate.getFullYear() === currentYear;
                const isPast = eventDate < today;
                
                // Filter by archived status
                if (showArchivedEvents) {
                    return matchesYear && isPast;
                } else {
                    return matchesYear && !isPast;
                }
            });
            
            // Filter by month if selected
            if (currentMonthFilter !== 'all') {
                filteredEvents = filteredEvents.filter(e => {
                    const eventDate = new Date(e.date + 'T00:00:00');
                    return eventDate.getMonth() + 1 === currentMonthFilter;
                });
            }

            if (filteredEvents.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }

            emptyState.style.display = 'none';

            // Group events by month
            const eventsByMonth = {};
            filteredEvents.forEach(e => {
                const date = new Date(e.date + 'T00:00:00');
                const month = date.getMonth() + 1;
                if (!eventsByMonth[month]) {
                    eventsByMonth[month] = [];
                }
                eventsByMonth[month].push(e);
            });

            // Sort months
            const sortedMonths = Object.keys(eventsByMonth).sort((a, b) => parseInt(a) - parseInt(b));

            // Render events grouped by month
            container.innerHTML = sortedMonths.map(month => {
                const monthEvents = eventsByMonth[month].sort((a, b) => new Date(a.date) - new Date(b.date));
                
                return `
                    <div class="month-section">
                        <h4 class="month-section-header">${getMonthName(parseInt(month))}</h4>
                        ${monthEvents.map(e => {
                            const priorityColors = {
                                alta: 'var(--danger)',
                                media: 'var(--warning)',
                                baixa: 'var(--success)'
                            };
                            
                            const companyNames = {
                                lourofood: 'Lourofood',
                                lactilouro: 'Lactilouro',
                                srqueijo: 'O Sr¬∫ Queijo'
                            };
                            
                            const companyColors = {
                                lourofood: 'background: rgba(59, 130, 246, 0.1); color: #3b82f6;',
                                lactilouro: 'background: rgba(16, 185, 129, 0.1); color: #10b981;',
                                srqueijo: 'background: rgba(245, 158, 11, 0.1); color: #f59e0b;'
                            };
                            
                            const eventDate = new Date(e.date + 'T00:00:00');
                            const diffTime = eventDate - today;
                            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                            const isWarning = diffDays >= 0 && diffDays <= 2;
                            
                            let countdownHTML = '';
                            if (diffDays >= 0) {
                                if (diffDays === 0) {
                                    countdownHTML = '<div style="background: var(--danger); color: white; padding: 8px 15px; border-radius: 8px; font-weight: 600; display: inline-block; margin-top: 8px;">üéØ HOJE!</div>';
                                } else if (diffDays === 1) {
                                    countdownHTML = '<div style="background: var(--warning); color: white; padding: 8px 15px; border-radius: 8px; font-weight: 600; display: inline-block; margin-top: 8px;">‚ö° Amanh√£</div>';
                                } else if (diffDays === 2) {
                                    countdownHTML = '<div style="background: var(--warning); color: white; padding: 8px 15px; border-radius: 8px; font-weight: 600; display: inline-block; margin-top: 8px; animation: pulse 2s infinite;">‚ö†Ô∏è Faltam 2 dias</div>';
                                } else {
                                    countdownHTML = `<div style="color: #64748b; padding: 8px 0; font-size: 0.9rem; margin-top: 8px;">Faltam ${diffDays} dias</div>`;
                                }
                            }
                            
                            return `
                                <div class="event-card" style="border-left-color: ${priorityColors[e.priority]}; ${isWarning ? 'background: linear-gradient(90deg, rgba(245, 158, 11, 0.05) 0%, white 100%);' : ''}">
                                    <div class="event-header">
                                        <div style="flex: 1;">
                                            <div class="event-title">${e.title}</div>
                                            <div class="event-date">${formatDate(e.date)}</div>
                                            ${e.company ? `<span style="display: inline-block; padding: 6px 12px; border-radius: 8px; font-size: 0.85rem; font-weight: 600; margin-top: 8px; ${companyColors[e.company] || companyColors.lourofood}">${companyNames[e.company] || e.company}</span>` : ''}
                                            ${countdownHTML}
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span class="priority-badge priority-${e.priority}">${e.priority}</span>
                                            <button class="icon-btn" onclick="editEvent('${e.id}')" title="Editar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                                </svg>
                                            </button>
                                            <button class="icon-btn" onclick="deleteEvent('${e.id}')" style="background: var(--danger); color: white;" title="Eliminar">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    ${e.desc ? `<p style="color: #64748b; margin-top: 12px; line-height: 1.6;">${e.desc}</p>` : ''}
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
            }).join('');
        }

        // Notes
        
        
        function execEditorCommand(command, value = null) {
            document.execCommand(command, false, value);
            document.getElementById('noteEditor').focus();
        }

        function addChecklistToEditor() {
            const selection = window.getSelection();
            if (selection.rangeCount > 0) {
                const range = selection.getRangeAt(0);
                const checklistItem = document.createElement('div');
                checklistItem.className = 'note-checklist-item';
                checklistItem.innerHTML = '<input type="checkbox"> <span>Item da lista...</span>';
                range.insertNode(checklistItem);
                
                // Move cursor after the checklist item
                range.setStartAfter(checklistItem);
                range.collapse(true);
                selection.removeAllRanges();
                selection.addRange(range);
            }
            document.getElementById('noteEditor').focus();
        }
        
        function insertLink() {
            const url = prompt('Insira o URL do link:', 'https://');
            if (url && url !== 'https://') {
                const selection = window.getSelection();
                if (selection.toString()) {
                    // Se houver texto selecionado, criar link com esse texto
                    execEditorCommand('createLink', url);
                } else {
                    // Se n√£o houver texto selecionado, inserir o URL como texto e link
                    const linkText = prompt('Texto do link:', url);
                    if (linkText) {
                        document.execCommand('insertHTML', false, `<a href="${url}" target="_blank">${linkText}</a>`);
                    }
                }
            }
            document.getElementById('noteEditor').focus();
        }

        function openNoteModal() {
            editingNoteId = null;
            document.getElementById('noteTitle').value = '';
            document.getElementById('noteEditor').innerHTML = '';
            document.querySelector('#noteModal .modal-title').textContent = 'Nova Nota';
            document.getElementById('noteModal').classList.add('active');
        }

        function saveNote() {
            const noteData = {
                title: document.getElementById('noteTitle').value.trim(),
                content: document.getElementById('noteEditor').innerHTML,
                date: new Date().toISOString().split('T')[0]
            };

            if (!noteData.title || !noteData.content || noteData.content === '<br>') {
                showToast('Preencha todos os campos!', 'error');
                return;
            }

            if (editingNoteId) {
                const index = notes.findIndex(n => n.id === editingNoteId);
                notes[index] = { ...notes[index], ...noteData };
                showToast('Nota atualizada!');
                editingNoteId = null;
            } else {
                notes.push({
                    id: Date.now().toString(),
                    ...noteData
                });
                showToast('Nota adicionada!');
            }

            closeNoteModal();
            loadNotes();
            sync();
        }

        function editNote(id) {
            editingNoteId = id;
            const n = notes.find(n => n.id === id);
            if (!n) return;

            document.getElementById('noteTitle').value = n.title;
            document.getElementById('noteEditor').innerHTML = n.content;
            
            document.querySelector('#noteModal .modal-title').textContent = 'Editar Nota';
            document.getElementById('noteModal').classList.add('active');
        }

        function toggleNoteCheck(noteId, index) {
            const note = notes.find(n => n.id === noteId);
            if (!note) return;
            
            // Esta fun√ß√£o ser√° chamada quando um checkbox for clicado na visualiza√ß√£o
            // Como o conte√∫do √© HTML, precisamos de uma forma de atualizar o estado no HTML
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = note.content;
            const checkboxes = tempDiv.querySelectorAll('input[type="checkbox"]');
            if (checkboxes[index]) {
                if (checkboxes[index].hasAttribute('checked')) {
                    checkboxes[index].removeAttribute('checked');
                    checkboxes[index].parentElement.classList.remove('checked');
                } else {
                    checkboxes[index].setAttribute('checked', 'checked');
                    checkboxes[index].parentElement.classList.add('checked');
                }
                note.content = tempDiv.innerHTML;
                loadNotes();
                sync();
            }
        }

        function deleteNote(id) {
            if (!confirm('Tem certeza?')) return;
            notes = notes.filter(n => n.id !== id);
            loadNotes();
            sync();
            showToast('Removida!', 'warning');
        }

        
        function loadNotes() {
            const container = document.getElementById('notesContainer');
            const emptyState = document.getElementById('emptyNotes');

            if (notes.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }

            emptyState.style.display = 'none';
            container.innerHTML = notes.map(n => {
                // Processar o HTML para tornar os checkboxes funcionais na visualiza√ß√£o
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = n.content;
                const checkboxes = tempDiv.querySelectorAll('input[type="checkbox"]');
                checkboxes.forEach((cb, index) => {
                    const isChecked = cb.hasAttribute('checked');
                    cb.setAttribute('onclick', `toggleNoteCheck('${n.id}', ${index})`);
                    if (isChecked) {
                        cb.parentElement.classList.add('checked');
                    }
                });

                return `
                <div class="persona-card">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                        <h4 style="margin: 0; font-size: 1.3rem;">üìù ${n.title}</h4>
                        <div style="display: flex; gap: 8px;">
                            <span style="color: #64748b; font-size: 0.85rem;">${formatDate(n.date)}</span>
                            <div style="display: flex; gap: 8px;">
                                <button class="icon-btn" onclick="editNote('${n.id}')" title="Editar" style="background: var(--primary); color: white;">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                    </svg>
                                </button>
                                <button class="icon-btn" onclick="deleteNote('${n.id}')" style="background: var(--danger); color: white;">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div style="color: #64748b; line-height: 1.6;" class="note-display-content">${tempDiv.innerHTML}</div>
                </div>
            `;
            }).join('');
        }

        // AI Chat functionality - Simulated Mode
        async function sendInsightsMessage() {
            const input = document.getElementById('insightsInput');
            const message = input.value.trim();
            if (!message) return;

            const sendBtn = document.getElementById('insightsSendBtn');
            sendBtn.disabled = true;
            
            addChatMessage('insights', message, 'user');
            input.value = '';
            
            addLoadingIndicator('insights');

            // Simulate thinking time
            await new Promise(resolve => setTimeout(resolve, 1500));

            const aiResponse = generateInsightsResponse(message);
            removeLoadingIndicator('insights');
            addChatMessage('insights', aiResponse, 'assistant');
            
            sendBtn.disabled = false;
        }

        async function sendAnaliseMessage() {
            const input = document.getElementById('analiseInput');
            const message = input.value.trim();
            if (!message) return;

            const sendBtn = document.getElementById('analiseSendBtn');
            sendBtn.disabled = true;
            
            addChatMessage('analise', message, 'user');
            input.value = '';
            
            addLoadingIndicator('analise');

            // Simulate thinking time
            await new Promise(resolve => setTimeout(resolve, 1500));

            const aiResponse = generateAnaliseResponse(message);
            removeLoadingIndicator('analise');
            addChatMessage('analise', aiResponse, 'assistant');
            
            sendBtn.disabled = false;
        }

        function generateInsightsResponse(message) {
            const lowerMsg = message.toLowerCase();
            
            // Instagram posts
            if (lowerMsg.includes('instagram') || lowerMsg.includes('ideias de post')) {
                return `<strong>5 Ideias de Posts para Instagram sobre Queijos:</strong><br><br>

1. <strong>"Viagem pelo Sabor"</strong> üßÄ<br>
   Foto: Close-up de um queijo sendo cortado<br>
   Legenda: "Cada fatia conta uma hist√≥ria. Dos pastos verdes da Serra da Estrela at√© sua mesa. #QueijoArtesanal #TradPortuguesa"<br><br>

2. <strong>"Momentos de Partilha"</strong><br>
   Foto: T√°bua de queijos com fam√≠lia/amigos<br>
   Legenda: "Os melhores momentos pedem os melhores queijos. Qual √© o seu favorito para partilhar? üíõ"<br><br>

3. <strong>"Curiosidade do Dia"</strong><br>
   Design gr√°fico educativo<br>
   Texto: "Sabia que leva X litros de leite para fazer 1kg de queijo? #CuriosidadeQueijo"<br><br>

4. <strong>"Behind the Scenes"</strong><br>
   V√≠deo/Carrossel: Processo de produ√ß√£o<br>
   Legenda: "Da ordenha ao queijo perfeito. Tradi√ß√£o que passa de gera√ß√£o em gera√ß√£o. ‚ú®"<br><br>

5. <strong>"Receita R√°pida"</strong><br>
   Reels: Receita com queijo em 30 segundos<br>
   "3 ingredientes + o nosso queijo = magia na cozinha üë®‚Äçüç≥"<br><br>

<strong>Dica:</strong> Publique 3-4x por semana, sempre entre as 18h-21h quando o engagement √© maior!`;
            }
            
            // LinkedIn posts
            if (lowerMsg.includes('linkedin') || lowerMsg.includes('profissional')) {
                return `<strong>Post Profissional para LinkedIn - Ind√∫stria Alimentar:</strong><br><br>

<strong>T√≠tulo:</strong> "A Inova√ß√£o na Tradi√ß√£o: Como Modernizamos a Produ√ß√£o sem Perder a Ess√™ncia"<br><br>

<strong>Post:</strong><br>
No setor alimentar portugu√™s, enfrentamos diariamente o desafio de equilibrar tradi√ß√£o centen√°ria com exig√™ncias modernas de qualidade e sustentabilidade.<br><br>

Na [Nome da Empresa], implement√°mos:<br>
‚úì Rastreabilidade 100% digital do leite √† prateleira<br>
‚úì Processos que reduzem desperd√≠cio em 30%<br>
‚úì Certifica√ß√µes internacionais mantendo m√©todos artesanais<br><br>

O resultado? Produtos que honram o passado e abra√ßam o futuro.<br><br>

A inova√ß√£o n√£o substitui a tradi√ß√£o - amplifica-a.<br><br>

Como est√° a sua empresa a equilibrar estes dois mundos?<br><br>

#Ind√∫striaAlimentar #Inova√ß√£o #Sustentabilidade #QualidadePortuguesa #FoodTech`;
            }
            
            // Hashtags
            if (lowerMsg.includes('hashtag')) {
                return `<strong>Estrat√©gia de Hashtags para Produtos Gourmet/Queijos:</strong><br><br>

<strong>üéØ Hashtags de Alto Alcance (1M+ posts):</strong><br>
#FoodPorn #Foodie #FoodPhotography #Instafood #Delicious<br><br>

<strong>üáµüáπ Hashtags Portugal (100K-500K):</strong><br>
#ComidaPortuguesa #SaborPortugues #MadeInPortugal #PortugalFoodies #VisitPortugal<br><br>

<strong>üßÄ Hashtags de Nicho (10K-100K):</strong><br>
#QueijoArtesanal #CheeseLovers #ArtisanalCheese #QueijosPortugueses #CheesePlatter #GourmetCheese<br><br>

<strong>üíº Hashtags de Marca (criar as suas):</strong><br>
#[NomeDaMarca] #[SloganDaMarca] #[NomeQueijo] #Tradi√ß√£oPortuguesa<br><br>

<strong>üìä F√≥rmula Ideal:</strong><br>
‚Ä¢ 3-5 hashtags grandes (alcance)<br>
‚Ä¢ 5-7 hashtags m√©dias (comunidade)<br>
‚Ä¢ 2-3 hashtags pequenas/marca (engagement)<br>
‚Ä¢ Total: 10-15 hashtags por post<br><br>

<strong>Dica Pro:</strong> Crie um "set" de hashtags para cada tipo de conte√∫do e v√° rotacionando!`;
            }
            
            // Calend√°rio editorial
            if (lowerMsg.includes('calend√°rio') || lowerMsg.includes('calendario')) {
                return `<strong>üìÖ Calend√°rio Editorial - Pr√≥ximo M√™s</strong><br><br>

<strong>Semana 1: "Tradi√ß√£o"</strong><br>
‚Ä¢ Segunda: Post educativo sobre hist√≥ria do queijo portugu√™s<br>
‚Ä¢ Quarta: Behind the scenes da produ√ß√£o<br>
‚Ä¢ Sexta: Foto produto destacado<br>
‚Ä¢ Domingo: Momento familiar com queijo<br><br>

<strong>Semana 2: "Inova√ß√£o"</strong><br>
‚Ä¢ Segunda: Reels - Receita r√°pida e moderna<br>
‚Ä¢ Quarta: Post sobre sustentabilidade/qualidade<br>
‚Ä¢ Sexta: Novidade ou lan√ßamento<br>
‚Ä¢ Domingo: User-generated content (repost cliente)<br><br>

<strong>Semana 3: "Comunidade"</strong><br>
‚Ä¢ Segunda: Pergunta interativa (qual o vosso favorito?)<br>
‚Ä¢ Quarta: Depoimento/review de cliente<br>
‚Ä¢ Sexta: Concurso ou giveaway<br>
‚Ä¢ Domingo: T√°bua de queijos para inspirar<br><br>

<strong>Semana 4: "Educa√ß√£o"</strong><br>
‚Ä¢ Segunda: Dica de harmoniza√ß√£o (queijo + vinho)<br>
‚Ä¢ Quarta: Curiosidade sobre nutri√ß√£o<br>
‚Ä¢ Sexta: Como conservar queijo corretamente<br>
‚Ä¢ Domingo: Prepara√ß√£o para pr√≥ximo m√™s<br><br>

<strong>üéØ Formatos:</strong> 40% fotos, 30% carrossel, 20% reels, 10% stories fixos`;
            }
            
            // Default response
            return `<strong>Claro! Vou ajud√°-la com isso.</strong><br><br>

Para criar conte√∫do eficaz para a ind√∫stria de queijos e produtos gourmet, considere:<br><br>

<strong>üì± Estrat√©gia de Conte√∫do:</strong><br>
‚Ä¢ <strong>Storytelling:</strong> Conte a hist√≥ria por tr√°s de cada queijo - origem, tradi√ß√£o, produtores<br>
‚Ä¢ <strong>Conte√∫do Visual:</strong> Fotos de alta qualidade s√£o essenciais (close-ups, texturas, cortes)<br>
‚Ä¢ <strong>Behind the Scenes:</strong> Mostre o processo artesanal e os bastidores da produ√ß√£o<br>
‚Ä¢ <strong>Educa√ß√£o:</strong> Ensine sobre harmoniza√ß√µes, conserva√ß√£o, e caracter√≠sticas √∫nicas<br><br>

<strong>üéØ Tipos de Posts que Funcionam:</strong><br>
1. Receitas r√°pidas em v√≠deo (Reels/TikTok)<br>
2. Dicas de harmoniza√ß√£o (queijo + vinho/fruta/mel)<br>
3. Compara√ß√µes de sabores e texturas<br>
4. Momentos de consumo (fam√≠lia, amigos, celebra√ß√µes)<br>
5. Curiosidades sobre produ√ß√£o artesanal<br><br>

<strong>üí° Tom de Comunica√ß√£o:</strong><br>
‚Ä¢ Aut√™ntico e pr√≥ximo<br>
‚Ä¢ Valorizando a tradi√ß√£o portuguesa<br>
‚Ä¢ Educativo mas n√£o t√©cnico demais<br>
‚Ä¢ Focado em experi√™ncias e momentos<br><br>

Quer que eu desenvolva mais algum aspeto espec√≠fico?`;
        }

        function generateAnaliseResponse(message) {
            const lowerMsg = message.toLowerCase();
            
            // Engagement analysis
            if (lowerMsg.includes('engagement') || lowerMsg.includes('likes') || lowerMsg.includes('150')) {
                return `<strong>üìä An√°lise de Engagement - Instagram</strong><br><br>

<strong>Situa√ß√£o Atual:</strong><br>
‚Ä¢ Seguidores: 5.000<br>
‚Ä¢ M√©dia de likes: 150 por post<br>
‚Ä¢ Taxa de engagement: <strong>3%</strong> (150/5000)<br><br>

<strong>üìà Benchmark da Ind√∫stria:</strong><br>
‚Ä¢ Excelente: >6%<br>
‚Ä¢ Bom: 3-6%<br>
‚Ä¢ M√©dio: 1-3% ‚Üê <strong>Voc√™ est√° aqui</strong><br>
‚Ä¢ Baixo: <1%<br><br>

<strong>‚úÖ Diagn√≥stico:</strong><br>
Est√° na m√©dia, mas h√° grande margem de melhoria!<br><br>

<strong>üéØ Estrat√©gias para Aumentar Engagement:</strong><br><br>

<strong>1. Otimizar Hor√°rios (Impacto Alto):</strong><br>
‚Ä¢ Publique entre 18h-21h (hor√°rio nobre PT)<br>
‚Ä¢ Teste Quarta e Domingo (melhores dias para food content)<br><br>

<strong>2. Aumentar Intera√ß√£o (Impacto Alto):</strong><br>
‚Ä¢ Fa√ßa perguntas diretas nas legendas<br>
‚Ä¢ Use "Tag um amigo que‚Ä¶"<br>
‚Ä¢ Crie polls nos Stories e partilhe resultados<br>
‚Ä¢ Responda TODOS os coment√°rios nas primeiras 2h<br><br>

<strong>3. Conte√∫do de Maior Engagement (Impacto M√©dio):</strong><br>
‚Ä¢ Reels educativos (receitas, dicas)<br>
‚Ä¢ Carross√©is (geram 2x mais engagement)<br>
‚Ä¢ User-generated content (reposts de clientes)<br>
‚Ä¢ Conte√∫do behind-the-scenes<br><br>

<strong>4. Legendas Otimizadas (Impacto M√©dio):</strong><br>
‚Ä¢ Primeira linha crucial: fa√ßa uma pergunta ou provoca√ß√£o<br>
‚Ä¢ Use storytelling<br>
‚Ä¢ Adicione call-to-action claro<br>
‚Ä¢ 3-5 hashtags misturadas no texto (mais natural)<br><br>

<strong>üé≤ Meta Realista:</strong><br>
Em 60 dias: <strong>4.5%</strong> de engagement (225 likes/post)<br>
Em 90 dias: <strong>5.5%</strong> de engagement (275 likes/post)<br><br>

<strong>üìå A√ß√£o Imediata:</strong><br>
Teste esta semana: Post um Reels √†s 19h com pergunta na legenda. Compare resultados!`;
            }
            
            // Queda de alcance
            if (lowerMsg.includes('caiu') || lowerMsg.includes('queda') || lowerMsg.includes('30%')) {
                return `<strong>üîç An√°lise: Queda de 30% no Alcance do Facebook</strong><br><br>

<strong>üö® Causas Mais Prov√°veis:</strong><br><br>

<strong>1. Mudan√ßa no Algoritmo (60% de probabilidade):</strong><br>
‚Ä¢ Facebook priorizou v√≠deos nativos vs. links<br>
‚Ä¢ Feed privilegia intera√ß√µes com amigos vs. p√°ginas<br>
‚Ä¢ <strong>Solu√ß√£o:</strong> Invista em Reels e conte√∫do nativo (sem links externos)<br><br>

<strong>2. Frequ√™ncia de Publica√ß√£o (30% de probabilidade):</strong><br>
‚Ä¢ Menos posts = menos visibilidade no feed<br>
‚Ä¢ Algoritmo favorece p√°ginas ativas<br>
‚Ä¢ <strong>Solu√ß√£o:</strong> Mantenha 3-4 posts/semana consistentemente<br><br>

<strong>3. Tipo de Conte√∫do (10% de probabilidade):</strong><br>
‚Ä¢ Muito link externo reduz alcance<br>
‚Ä¢ Posts s√≥ com texto t√™m alcance 50% menor<br>
‚Ä¢ <strong>Solu√ß√£o:</strong> 80% conte√∫do visual/v√≠deo, 20% texto/link<br><br>

<strong>üìä Plano de Recupera√ß√£o (30 dias):</strong><br><br>

<strong>Semana 1-2: Diagn√≥stico</strong><br>
‚úì Analise posts com melhor/pior alcance<br>
‚úì Compare com per√≠odo anterior<br>
‚úì Identifique padr√µes<br><br>

<strong>Semana 3-4: Teste e Ajuste</strong><br>
‚úì Publique 4x/semana (dias fixos)<br>
‚úì 50% Reels/v√≠deos curtos<br>
‚úì 30% Carross√©is com v√°rias imagens<br>
‚úì 20% Fotos de alta qualidade<br>
‚úì Zero links externos no post (coloque em coment√°rio)<br><br>

<strong>üéØ T√°ticas de Impacto Imediato:</strong><br><br>

1. <strong>Boost Org√¢nico:</strong><br>
   ‚Ä¢ Responda coment√°rios < 1h ap√≥s publicar<br>
   ‚Ä¢ Partilhe post nos Stories<br>
   ‚Ä¢ Pe√ßa √† equipa para interagir nos primeiros 30min<br><br>

2. <strong>Conte√∫do de Alto Engagement:</strong><br>
   ‚Ä¢ Enquetes e quizzes<br>
   ‚Ä¢ "Qual prefere: A ou B?"<br>
   ‚Ä¢ Concursos simples (comentar + partilhar)<br><br>

3. <strong>Hor√°rios Otimizados:</strong><br>
   ‚Ä¢ Facebook: 13h-15h e 19h-21h<br>
   ‚Ä¢ Evite fim de semana (menor alcance org√¢nico)<br><br>

<strong>üí∞ Se o Budget Permitir:</strong><br>
Invista ‚Ç¨5-10/dia em ads para os 3 melhores posts org√¢nicos. Isso sinaliza ao algoritmo que o conte√∫do √© valioso.<br><br>

<strong>üìà Meta:</strong> Recuperar 50% do alcance em 30 dias (de -30% para -15%)`;
            }
            
            // Compara√ß√£o plataformas
            if (lowerMsg.includes('instagram') && lowerMsg.includes('linkedin') || lowerMsg.includes('focar')) {
                return `<strong>‚öñÔ∏è An√°lise Comparativa: Instagram vs LinkedIn</strong><br><br>

<strong>üìä Situa√ß√£o Atual:</strong><br>
‚Ä¢ Instagram: 10k seguidores<br>
‚Ä¢ LinkedIn: 2k seguidores<br><br>

<strong>üéØ Recomenda√ß√£o: AMBAS, mas com estrat√©gias diferentes</strong><br><br>

<strong>INSTAGRAM (Prioridade: ALTA üî•)</strong><br>
<strong>Porqu√™ focar:</strong><br>
‚úì Base j√° estabelecida (10k)<br>
‚úì Plataforma visual ideal para produtos alimentares<br>
‚úì Maior alcance para B2C<br>
‚úì Engagement mais r√°pido<br>
‚úì √ìtimo para construir comunidade e brand awareness<br><br>

<strong>O que fazer:</strong><br>
‚Ä¢ 4-5 posts/semana<br>
‚Ä¢ Foco em Reels (80% do alcance vem daqui)<br>
‚Ä¢ Stories di√°rios para manter proximidade<br>
‚Ä¢ Colabora√ß√µes com micro-influencers<br><br>

<strong>Objetivo:</strong> Crescer para 15k em 6 meses<br><br>

<strong>LINKEDIN (Prioridade: M√âDIA üìà)</strong><br>
<strong>Porqu√™ n√£o abandonar:</strong><br>
‚úì Essencial para B2B e parcerias<br>
‚úì Ideal para restaurantes, hot√©is, distribuidores<br>
‚úì Conte√∫do tem vida √∫til mais longa<br>
‚úì Networking profissional valioso<br>
‚úì Menos saturado na ind√∫stria alimentar<br><br>

<strong>O que fazer:</strong><br>
‚Ä¢ 2-3 posts/semana (qualidade > quantidade)<br>
‚Ä¢ Conte√∫do mais educativo e institucional<br>
‚Ä¢ Cases de sucesso, inova√ß√£o, sustentabilidade<br>
‚Ä¢ Partilhar artigos e conhecimento do setor<br><br>

<strong>Objetivo:</strong> Crescer para 5k em 6 meses<br><br>

<strong>üìã ESTRAT√âGIA INTEGRADA</strong><br><br>

<strong>Instagram (70% do esfor√ßo):</strong><br>
‚Ä¢ Segunda: Reels receita/dica<br>
‚Ä¢ Quarta: Post produto/t√°bua<br>
‚Ä¢ Sexta: Behind the scenes<br>
‚Ä¢ Domingo: Momento/experi√™ncia<br>
‚Ä¢ Stories: di√°rios<br><br>

<strong>LinkedIn (30% do esfor√ßo):</strong><br>
‚Ä¢ Ter√ßa: Artigo sobre ind√∫stria/tend√™ncias<br>
‚Ä¢ Quinta: Case ou not√≠cia empresa<br>
‚Ä¢ (Reutilize conte√∫do IG adaptado para tom profissional)<br><br>

<strong>üéØ ROI Esperado:</strong><br><br>

<strong>Instagram:</strong><br>
‚Ä¢ Leads B2C: Alto<br>
‚Ä¢ Vendas diretas: M√©dio-Alto<br>
‚Ä¢ Brand awareness: Muito Alto<br><br>

<strong>LinkedIn:</strong><br>
‚Ä¢ Leads B2B: Muito Alto<br>
‚Ä¢ Parcerias: Alto<br>
‚Ä¢ Credibilidade: Muito Alto<br><br>

<strong>üí° Decis√£o Final:</strong><br>
Mantenha AMBAS, mas:<br>
‚Ä¢ 70% recursos no Instagram (maior volume)<br>
‚Ä¢ 30% recursos no LinkedIn (maior qualidade/ticket)<br><br>

N√£o abandone LinkedIn - ele pode trazer 1 parceria que vale mais que 1000 followers do Instagram!`;
            }
            
            // Estrat√©gia de crescimento
            if (lowerMsg.includes('crescimento') || lowerMsg.includes('aumentar') || lowerMsg.includes('seguidores')) {
                return `<strong>üöÄ Plano de Crescimento - Redes Sociais</strong><br><br>

<strong>üìä An√°lise da Situa√ß√£o:</strong><br><br>

Para a ind√∫stria alimentar portuguesa, especialmente queijos e gourmet, o crescimento sustent√°vel precisa de 3 pilares:<br><br>

<strong>1Ô∏è‚É£ CONTE√öDO DE QUALIDADE (50% do sucesso)</strong><br><br>

<strong>O que est√° a funcionar em 2026:</strong><br>
‚Ä¢ ‚úÖ V√≠deos curtos (Reels 15-30s)<br>
‚Ä¢ ‚úÖ Carross√©is educativos<br>
‚Ä¢ ‚úÖ Behind-the-scenes aut√™nticos<br>
‚Ä¢ ‚úÖ User-generated content<br>
‚Ä¢ ‚ùå Posts est√°ticos com texto<br>
‚Ä¢ ‚ùå Fotos de baixa qualidade<br><br>

<strong>F√≥rmula de Conte√∫do:</strong><br>
‚Ä¢ 40% Educativo (como fazer, dicas, curiosidades)<br>
‚Ä¢ 30% Inspiracional (t√°buas, momentos, receitas)<br>
‚Ä¢ 20% Entretenimento (humor, trends adaptados)<br>
‚Ä¢ 10% Promocional (produtos, ofertas)<br><br>

<strong>2Ô∏è‚É£ CONSIST√äNCIA (30% do sucesso)</strong><br><br>

<strong>Calend√°rio M√≠nimo:</strong><br>
‚Ä¢ Instagram: 4-5 posts/semana + Stories di√°rios<br>
‚Ä¢ Facebook: 3-4 posts/semana<br>
‚Ä¢ LinkedIn: 2-3 posts/semana<br>
‚Ä¢ TikTok (se aplic√°vel): 3-5 v√≠deos/semana<br><br>

<strong>Hor√°rios Otimizados (Portugal):</strong><br>
‚Ä¢ Instagram/Facebook: 13h, 19h, 21h<br>
‚Ä¢ LinkedIn: 8h, 13h, 17h<br><br>

<strong>3Ô∏è‚É£ ENGAGEMENT ATIVO (20% do sucesso)</strong><br><br>

<strong>T√°ticas Di√°rias:</strong><br>
‚Ä¢ Responder TODOS coment√°rios < 2h<br>
‚Ä¢ Interagir com 20-30 contas do nicho/dia<br>
‚Ä¢ Partilhar stories de clientes/seguidores<br>
‚Ä¢ Comentar em posts de contas maiores (networking)<br><br>

<strong>üìà PLANO 90 DIAS:</strong><br><br>

<strong>M√™s 1: FUNDA√á√ÉO</strong><br>
‚úì Otimizar bio e highlights<br>
‚úì Criar banco de conte√∫do (30 posts)<br>
‚úì Definir identidade visual consistente<br>
‚úì Come√ßar calend√°rio editorial<br>
<strong>Meta:</strong> +10% seguidores org√¢nicos<br><br>

<strong>M√™s 2: ACELERA√á√ÉO</strong><br>
‚úì 2x Reels/semana (foco em alcance)<br>
‚úì Colabora√ß√£o com 3 micro-influencers<br>
‚úì Primeiro giveaway/concurso<br>
‚úì Ads teste com ‚Ç¨50 (boost melhores posts)<br>
<strong>Meta:</strong> +25% seguidores<br><br>

<strong>M√™s 3: CONSOLIDA√á√ÉO</strong><br>
‚úì Aumentar para 3x Reels/semana<br>
‚úì Lan√ßar hashtag pr√≥pria<br>
‚úì Criar comunidade (grupo/VIPs)<br>
‚úì Analisar e otimizar baseado em dados<br>
<strong>Meta:</strong> +15% seguidores (crescimento sustent√°vel)<br><br>

<strong>üí∞ INVESTIMENTO RECOMENDADO:</strong><br><br>

<strong>Op√ß√£o Bootstrap (‚Ç¨0-100/m√™s):</strong><br>
‚Ä¢ Conte√∫do org√¢nico forte<br>
‚Ä¢ Parcerias por troca de produto<br>
‚Ä¢ Crescimento: 15-20% em 90 dias<br><br>

<strong>Op√ß√£o Crescimento (‚Ç¨200-500/m√™s):</strong><br>
‚Ä¢ Ads estrat√©gicos<br>
‚Ä¢ Micro-influencers pagos<br>
‚Ä¢ Ferramentas de gest√£o<br>
‚Ä¢ Crescimento: 40-60% em 90 dias<br><br>

<strong>üéØ KPIS PARA MONITORIZAR:</strong><br>
‚Ä¢ Taxa de crescimento semanal<br>
‚Ä¢ Engagement rate (meta: >4%)<br>
‚Ä¢ Alcance m√©dio por post<br>
‚Ä¢ Saves e shares (indicador de valor)<br>
‚Ä¢ Tr√°fego para website<br><br>

Qual destas √°reas quer que eu aprofunde mais?`;
            }
            
            // Default response
            return `<strong>üìä An√°lise de Redes Sociais</strong><br><br>

Para uma an√°lise detalhada, preciso de mais informa√ß√µes sobre:<br><br>

<strong>M√©tricas Atuais:</strong><br>
‚Ä¢ Quantos seguidores tem em cada plataforma?<br>
‚Ä¢ Qual √© a taxa de engagement m√©dia?<br>
‚Ä¢ Quantos posts publica por semana?<br>
‚Ä¢ Qual o alcance m√©dio dos seus posts?<br><br>

<strong>Objetivos:</strong><br>
‚Ä¢ Quer aumentar seguidores?<br>
‚Ä¢ Quer melhorar engagement?<br>
‚Ä¢ Quer gerar mais vendas?<br>
‚Ä¢ Quer aumentar brand awareness?<br><br>

<strong>Enquanto isso, aqui est√£o insights gerais para a ind√∫stria alimentar:</strong><br><br>

<strong>‚úÖ O que funciona bem:</strong><br>
‚Ä¢ V√≠deos de processo de produ√ß√£o (behind-the-scenes)<br>
‚Ä¢ Receitas r√°pidas e f√°ceis com o produto<br>
‚Ä¢ T√°buas de queijos visualmente atrativas<br>
‚Ä¢ Conte√∫do educativo sobre qualidade e origem<br>
‚Ä¢ Depoimentos reais de clientes<br><br>

<strong>‚ùå O que evitar:</strong><br>
‚Ä¢ Demasiado conte√∫do promocional<br>
‚Ä¢ Fotos de baixa qualidade<br>
‚Ä¢ Inconsist√™ncia na publica√ß√£o<br>
‚Ä¢ Ignorar coment√°rios e mensagens<br>
‚Ä¢ Copiar concorrentes sem adaptar<br><br>

<strong>üìà Benchmarks da Ind√∫stria (Portugal):</strong><br>
‚Ä¢ Engagement rate ideal: 3-6%<br>
‚Ä¢ Frequ√™ncia posts: 3-5x/semana<br>
‚Ä¢ Melhor hor√°rio: 18h-21h<br>
‚Ä¢ Formato top: V√≠deos curtos (Reels)<br><br>

Partilhe mais detalhes para uma an√°lise personalizada!`;
        }

        function sendQuickPrompt(chatType, prompt) {
            if (chatType === 'insights') {
                document.getElementById('insightsInput').value = prompt;
                sendInsightsMessage();
            } else {
                document.getElementById('analiseInput').value = prompt;
                sendAnaliseMessage();
            }
        }

        function addChatMessage(chatType, message, role) {
            const chatArea = chatType === 'insights' ? 
                document.getElementById('insightsChatArea') : 
                document.getElementById('analiseChatArea');
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `ai-message ${role}`;
            
            const avatar = role === 'user' ? 'üë§' : (chatType === 'insights' ? 'ü§ñ' : 'üìà');
            
            messageDiv.innerHTML = `
                <div class="ai-avatar ${role}">${avatar}</div>
                <div class="ai-bubble">${message.replace(/\n/g, '<br>')}</div>
            `;
            
            chatArea.appendChild(messageDiv);
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        function addLoadingIndicator(chatType) {
            const chatArea = chatType === 'insights' ? 
                document.getElementById('insightsChatArea') : 
                document.getElementById('analiseChatArea');
            
            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'ai-message assistant';
            loadingDiv.id = `loading-${chatType}`;
            
            const avatar = chatType === 'insights' ? 'ü§ñ' : 'üìà';
            
            loadingDiv.innerHTML = `
                <div class="ai-avatar assistant">${avatar}</div>
                <div class="ai-bubble">
                    <div class="ai-loading">
                        <div class="ai-loading-dot"></div>
                        <div class="ai-loading-dot"></div>
                        <div class="ai-loading-dot"></div>
                    </div>
                </div>
            `;
            
            chatArea.appendChild(loadingDiv);
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        function removeLoadingIndicator(chatType) {
            const loading = document.getElementById(`loading-${chatType}`);
            if (loading) loading.remove();
        }

        // Plan
        function savePlan() {
            plan = {
                // An√°lise SWOT
                forcas: document.getElementById('planForcas').value,
                fraquezas: document.getElementById('planFraquezas').value,
                oportunidades: document.getElementById('planOportunidades').value,
                ameacas: document.getElementById('planAmeacas').value,
                // Objetivos
                objetivos: document.getElementById('planObjetivos').value,
                metas: document.getElementById('planMetas').value,
                kpis: document.getElementById('planKPIs').value,
                // P√∫blico
                publico: document.getElementById('planPublico').value,
                personas: document.getElementById('planPersonas').value,
                // Estrat√©gias
                posicionamento: document.getElementById('planPosicionamento').value,
                estrategias: document.getElementById('planEstrategias').value,
                canais: document.getElementById('planCanais').value,
                calendario: document.getElementById('planCalendario').value,
                // Or√ßamento
                orcamentoTotal: document.getElementById('planOrcamentoTotal').value,
                distribuicao: document.getElementById('planDistribuicao').value,
                // Cronograma
                q1: document.getElementById('planQ1').value,
                q2: document.getElementById('planQ2').value,
                q3: document.getElementById('planQ3').value,
                q4: document.getElementById('planQ4').value,
                // An√°lise
                ferramentas: document.getElementById('planFerramentas').value,
                revisao: document.getElementById('planRevisao').value
            };
            sync();
            showToast('Plano anual guardado!');
        }

        function loadPlan() {
            if (plan.forcas) document.getElementById('planForcas').value = plan.forcas;
            if (plan.fraquezas) document.getElementById('planFraquezas').value = plan.fraquezas;
            if (plan.oportunidades) document.getElementById('planOportunidades').value = plan.oportunidades;
            if (plan.ameacas) document.getElementById('planAmeacas').value = plan.ameacas;
            if (plan.objetivos) document.getElementById('planObjetivos').value = plan.objetivos;
            if (plan.metas) document.getElementById('planMetas').value = plan.metas;
            if (plan.kpis) document.getElementById('planKPIs').value = plan.kpis;
            if (plan.publico) document.getElementById('planPublico').value = plan.publico;
            if (plan.personas) document.getElementById('planPersonas').value = plan.personas;
            if (plan.posicionamento) document.getElementById('planPosicionamento').value = plan.posicionamento;
            if (plan.estrategias) document.getElementById('planEstrategias').value = plan.estrategias;
            if (plan.canais) document.getElementById('planCanais').value = plan.canais;
            if (plan.calendario) document.getElementById('planCalendario').value = plan.calendario;
            if (plan.orcamentoTotal) document.getElementById('planOrcamentoTotal').value = plan.orcamentoTotal;
            if (plan.distribuicao) document.getElementById('planDistribuicao').value = plan.distribuicao;
            if (plan.q1) document.getElementById('planQ1').value = plan.q1;
            if (plan.q2) document.getElementById('planQ2').value = plan.q2;
            if (plan.q3) document.getElementById('planQ3').value = plan.q3;
            if (plan.q4) document.getElementById('planQ4').value = plan.q4;
            if (plan.ferramentas) document.getElementById('planFerramentas').value = plan.ferramentas;
            if (plan.revisao) document.getElementById('planRevisao').value = plan.revisao;
        }

        function saveCrisisPlan() {
            crisisPlan = {
                coord: document.getElementById('crisisCoord').value,
                portavoz: document.getElementById('crisisPortavoz').value,
                equipa: document.getElementById('crisisEquipa').value,
                internos: document.getElementById('crisisInternos').value,
                externos: document.getElementById('crisisExternos').value,
                media: document.getElementById('crisisMedia').value,
                produto: document.getElementById('crisisProduto').value,
                redes: document.getElementById('crisisRedes').value,
                funcionarios: document.getElementById('crisisFuncionarios').value,
                financeiro: document.getElementById('crisisFinanceiro').value,
                operacional: document.getElementById('crisisOperacional').value,
                crisis0to2: document.getElementById('crisis0to2').value,
                crisis2to6: document.getElementById('crisis2to6').value,
                crisis6to24: document.getElementById('crisis6to24').value,
                template1: document.getElementById('crisisTemplate1').value,
                template2: document.getElementById('crisisTemplate2').value,
                template3: document.getElementById('crisisTemplate3').value,
                checklist: document.getElementById('crisisChecklist').value,
                apos: document.getElementById('crisisApos').value
            };
            sync();
            showToast('Plano de crise guardado!');
        }

        function loadCrisisPlan() {
            if (crisisPlan.coord) document.getElementById('crisisCoord').value = crisisPlan.coord;
            if (crisisPlan.portavoz) document.getElementById('crisisPortavoz').value = crisisPlan.portavoz;
            if (crisisPlan.equipa) document.getElementById('crisisEquipa').value = crisisPlan.equipa;
            if (crisisPlan.internos) document.getElementById('crisisInternos').value = crisisPlan.internos;
            if (crisisPlan.externos) document.getElementById('crisisExternos').value = crisisPlan.externos;
            if (crisisPlan.media) document.getElementById('crisisMedia').value = crisisPlan.media;
            if (crisisPlan.produto) document.getElementById('crisisProduto').value = crisisPlan.produto;
            if (crisisPlan.redes) document.getElementById('crisisRedes').value = crisisPlan.redes;
            if (crisisPlan.funcionarios) document.getElementById('crisisFuncionarios').value = crisisPlan.funcionarios;
            if (crisisPlan.financeiro) document.getElementById('crisisFinanceiro').value = crisisPlan.financeiro;
            if (crisisPlan.operacional) document.getElementById('crisisOperacional').value = crisisPlan.operacional;
            if (crisisPlan.crisis0to2) document.getElementById('crisis0to2').value = crisisPlan.crisis0to2;
            if (crisisPlan.crisis2to6) document.getElementById('crisis2to6').value = crisisPlan.crisis2to6;
            if (crisisPlan.crisis6to24) document.getElementById('crisis6to24').value = crisisPlan.crisis6to24;
            if (crisisPlan.template1) document.getElementById('crisisTemplate1').value = crisisPlan.template1;
            if (crisisPlan.template2) document.getElementById('crisisTemplate2').value = crisisPlan.template2;
            if (crisisPlan.template3) document.getElementById('crisisTemplate3').value = crisisPlan.template3;
            if (crisisPlan.checklist) document.getElementById('crisisChecklist').value = crisisPlan.checklist;
            if (crisisPlan.apos) document.getElementById('crisisApos').value = crisisPlan.apos;
        }

        // Patrocinios
        function openPatrocinioModal() {
            document.getElementById('patrocinioModal').classList.add('active');
        }

        function closePatrocinioModal() {
            document.getElementById('patrocinioModal').classList.remove('active');
            document.getElementById('patrocinioNome').value = '';
            document.getElementById('patrocinioDesc').value = '';
            document.getElementById('patrocinioValor').value = '0';
            document.getElementById('patrocinioData').value = '';
        }

        function savePatrocinio() {
            const newPatrocinio = {
                id: Date.now().toString(),
                nome: document.getElementById('patrocinioNome').value.trim(),
                desc: document.getElementById('patrocinioDesc').value.trim(),
                valor: parseFloat(document.getElementById('patrocinioValor').value) || 0,
                data: document.getElementById('patrocinioData').value
            };

            if (!newPatrocinio.nome) {
                showToast('Preencha o nome!', 'error');
                return;
            }

            patrocinios.push(newPatrocinio);
            closePatrocinioModal();
            renderPatrocinios();
            renderDashboard();
            sync();
            showToast('Patroc√≠nio adicionado!');
        }

        function deletePatrocinio(id) {
            if (!confirm('Tem certeza?')) return;
            patrocinios = patrocinios.filter(p => p.id !== id);
            renderPatrocinios();
            renderDashboard();
            sync();
            showToast('Removido!', 'warning');
        }

        function renderPatrocinios() {
            const container = document.getElementById('patrociniosList');
            const emptyState = document.getElementById('emptyPatrocinios');

            if (patrocinios.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            emptyState.style.display = 'none';
            container.innerHTML = patrocinios.map(p => `
                <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.05) 0%, rgba(245, 158, 11, 0.1) 100%); 
                     border: 2px solid rgba(245, 158, 11, 0.2); border-left: 4px solid var(--warning); 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üí∞ ${p.nome}</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            ${formatDate(p.data)}${p.desc ? ' ‚Ä¢ ' + p.desc : ''}
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: var(--warning);">‚Ç¨${parseFloat(p.valor).toLocaleString('pt-PT')}</div>
                    </div>
                    <button class="icon-btn" onclick="deletePatrocinio('${p.id}')" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                        </svg>
                    </button>
                </div>
            `).join('');
        }

        // Feiras
        function openFeiraModal() {
            editingFeiraId = null;
            document.querySelector('#feiraModal .modal-title').textContent = 'Nova Feira';
            document.getElementById('feiraModal').classList.add('active');
        }

        function closeFeiraModal() {
            document.getElementById('feiraModal').classList.remove('active');
            document.getElementById('feiraNome').value = '';
            document.getElementById('feiraLocal').value = '';
            document.getElementById('feiraData').value = '';
            document.getElementById('feiraValor').value = '0';
            editingFeiraId = null;
        }

        function saveFeira() {
            const feiraData = {
                nome: document.getElementById('feiraNome').value.trim(),
                local: document.getElementById('feiraLocal').value.trim(),
                data: document.getElementById('feiraData').value,
                valor: parseFloat(document.getElementById('feiraValor').value) || 0
            };

            if (!feiraData.nome || !feiraData.local) {
                showToast('Preencha todos os campos!', 'error');
                return;
            }

            if (editingFeiraId) {
                // Modo edi√ß√£o
                const index = feiras.findIndex(f => f.id === editingFeiraId);
                feiras[index] = { ...feiras[index], ...feiraData };
                showToast('Feira atualizada!');
                editingFeiraId = null;
            } else {
                // Modo cria√ß√£o
                feiras.push({
                    id: Date.now().toString(),
                    ...feiraData,
                    parcelas: []
                });
                showToast('Feira adicionada!');
            }

            closeFeiraModal();
            renderFeiras();
            renderDashboard();
            sync();
        }

        function deleteFeira(id) {
            if (!confirm('Tem certeza?')) return;
            feiras = feiras.filter(f => f.id !== id);
            renderFeiras();
            renderDashboard();
            sync();
            showToast('Removida!', 'warning');
        }

        function renderFeiras() {
            const container = document.getElementById('feirasList');
            const emptyState = document.getElementById('emptyFeiras');

            if (feiras.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            emptyState.style.display = 'none';
            container.innerHTML = feiras.map(f => {
                const totalParcelas = f.parcelas ? f.parcelas.reduce((sum, p) => sum + parseFloat(p.valor || 0), 0) : 0;
                const or√ßamentoTotal = totalParcelas > 0 ? totalParcelas : parseFloat(f.valor);
                
                return `
                <div style="background: linear-gradient(135deg, rgba(20, 184, 166, 0.05) 0%, rgba(20, 184, 166, 0.1) 100%); 
                     border: 2px solid rgba(20, 184, 166, 0.2); border-left: 4px solid var(--accent); 
                     padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
                        <div style="flex: 1;">
                            <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üè™ ${f.nome}</div>
                            <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                                ${f.local} ‚Ä¢ ${formatDate(f.data)}
                            </div>
                            <div style="font-size: 1.6rem; font-weight: 800; color: var(--accent); margin-top: 10px;">
                                Total: ‚Ç¨${or√ßamentoTotal.toLocaleString('pt-PT')}
                            </div>
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <button class="icon-btn" onclick="editFeira('${f.id}')" title="Editar" style="background: var(--primary); color: white;">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                </svg>
                            </button>
                            <button class="icon-btn" onclick="deleteFeira('${f.id}')" style="background: var(--danger); color: white;" title="Eliminar">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Parcelas Section -->
                    <div style="background: white; border-radius: 10px; padding: 15px; margin-top: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <h5 style="margin: 0; font-size: 1rem; color: var(--dark);">üí∞ Or√ßamento Detalhado (${f.parcelas ? f.parcelas.length : 0} parcelas)</h5>
                            <button class="btn btn-secondary" onclick="openParcelaModal('${f.id}')" style="padding: 6px 12px; font-size: 0.85rem;">
                                + Adicionar Parcela
                            </button>
                        </div>
                        ${f.parcelas && f.parcelas.length > 0 ? `
                            <div style="border-top: 1px solid #e2e8f0; padding-top: 10px;">
                                ${f.parcelas.map(p => `
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px; margin-bottom: 8px;">
                                        <div style="flex: 1;">
                                            <div style="font-weight: 600; color: var(--dark); font-size: 0.95rem;">${p.desc}</div>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 12px;">
                                            <div style="font-weight: 700; color: var(--accent); font-size: 1.1rem;">‚Ç¨${parseFloat(p.valor).toLocaleString('pt-PT')}</div>
                                            <button class="icon-btn" onclick="deleteParcela('${f.id}', '${p.id}')" style="background: var(--danger); color: white; padding: 6px;">
                                                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                `).join('')}
                                <div style="border-top: 2px solid var(--accent); padding-top: 10px; margin-top: 10px; text-align: right;">
                                    <span style="font-size: 1.2rem; font-weight: 800; color: var(--dark);">Total: ‚Ç¨${totalParcelas.toLocaleString('pt-PT')}</span>
                                </div>
                            </div>
                        ` : '<p style="color: #94a3b8; text-align: center; padding: 20px; font-size: 0.9rem;">Nenhuma parcela adicionada. Clique em "Adicionar Parcela" para come√ßar.</p>'}
                    </div>
                </div>
            `;
            }).join('');
        }

        let editingFeiraId = null;

        function editFeira(id) {
            editingFeiraId = id;
            const feira = feiras.find(f => f.id === id);
            
            document.getElementById('feiraNome').value = feira.nome;
            document.getElementById('feiraLocal').value = feira.local;
            document.getElementById('feiraData').value = feira.data;
            document.getElementById('feiraValor').value = feira.valor;
            
            document.querySelector('#feiraModal .modal-title').textContent = 'Editar Feira';
            document.getElementById('feiraModal').classList.add('active');
        }

        // Material
        function openMaterialModal() {
            editingMaterialId = null;
            document.querySelector('#materialModal .modal-title').textContent = 'Novo Material';
            document.getElementById('materialModal').classList.add('active');
        }

        function closeMaterialModal() {
            document.getElementById('materialModal').classList.remove('active');
            document.getElementById('materialNome').value = '';
            document.getElementById('materialDesc').value = '';
            document.getElementById('materialValor').value = '0';
            document.getElementById('materialData').value = '';
        }

        
        function saveMaterial() {
            const materialData = {
                nome: document.getElementById('materialNome').value.trim(),
                desc: document.getElementById('materialDesc').value.trim(),
                valor: parseFloat(document.getElementById('materialValor').value) || 0,
                data: document.getElementById('materialData').value
            };

            if (!materialData.nome) {
                showToast('Preencha o nome!', 'error');
                return;
            }

            if (editingMaterialId) {
                const index = material.findIndex(m => m.id === editingMaterialId);
                material[index] = { ...material[index], ...materialData };
                showToast('Material atualizado!');
                editingMaterialId = null;
            } else {
                material.push({
                    id: Date.now().toString(),
                    ...materialData
                });
                showToast('Material adicionado!');
            }

            closeMaterialModal();
            renderMaterial();
            renderDashboard();
            sync();
        }

        function editMaterial(id) {
            editingMaterialId = id;
            const m = material.find(m => m.id === id);
            if (!m) return;

            document.getElementById('materialNome').value = m.nome;
            document.getElementById('materialDesc').value = m.desc;
            document.getElementById('materialValor').value = m.valor;
            document.getElementById('materialData').value = m.data;
            
            document.querySelector('#materialModal .modal-title').textContent = 'Editar Material';
            document.getElementById('materialModal').classList.add('active');
        }
    

        function deleteMaterial(id) {
            if (!confirm('Tem certeza?')) return;
            material = material.filter(m => m.id !== id);
            renderMaterial();
            renderDashboard();
            sync();
            showToast('Removido!', 'warning');
        }

        function renderMaterial() {
            const container = document.getElementById('materialList');
            const emptyState = document.getElementById('emptyMaterial');

            if (material.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            emptyState.style.display = 'none';
            container.innerHTML = material.map(m => `
                <div style="background: linear-gradient(135deg, rgba(236, 72, 153, 0.05) 0%, rgba(236, 72, 153, 0.1) 100%); 
                     border: 2px solid rgba(236, 72, 153, 0.2); border-left: 4px solid var(--secondary); 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üé® ${m.nome}</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            ${formatDate(m.data)}${m.desc ? ' ‚Ä¢ ' + m.desc : ''}
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: var(--secondary);">‚Ç¨${parseFloat(m.valor).toLocaleString('pt-PT')}</div>
                    </div>
                    
                    <div style="display: flex; gap: 8px;">
                        <button class="icon-btn" onclick="editMaterial('${m.id}')" title="Editar" style="background: var(--primary); color: white;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                            </svg>
                        </button>
                        <button class="icon-btn" onclick="deleteMaterial('${m.id}')" style="background: var(--danger); color: white;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                            </svg>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Geral
        function openGeralModal() {
            editingGeralId = null;
            document.querySelector('#geralModal .modal-title').textContent = 'Nova Despesa Geral';
            document.getElementById('geralModal').classList.add('active');
        }

        function closeGeralModal() {
            document.getElementById('geralModal').classList.remove('active');
            document.getElementById('geralNome').value = '';
            document.getElementById('geralDesc').value = '';
            document.getElementById('geralValor').value = '0';
            document.getElementById('geralData').value = '';
        }

        
        function saveGeral() {
            const geralData = {
                nome: document.getElementById('geralNome').value.trim(),
                desc: document.getElementById('geralDesc').value.trim(),
                valor: parseFloat(document.getElementById('geralValor').value) || 0,
                data: document.getElementById('geralData').value
            };

            if (!geralData.nome) {
                showToast('Preencha o nome!', 'error');
                return;
            }

            if (editingGeralId) {
                const index = geral.findIndex(g => g.id === editingGeralId);
                geral[index] = { ...geral[index], ...geralData };
                showToast('Despesa atualizada!');
                editingGeralId = null;
            } else {
                geral.push({
                    id: Date.now().toString(),
                    ...geralData
                });
                showToast('Despesa adicionada!');
            }

            closeGeralModal();
            renderGeral();
            renderDashboard();
            sync();
        }

        function editGeral(id) {
            editingGeralId = id;
            const g = geral.find(g => g.id === id);
            if (!g) return;

            document.getElementById('geralNome').value = g.nome;
            document.getElementById('geralDesc').value = g.desc;
            document.getElementById('geralValor').value = g.valor;
            document.getElementById('geralData').value = g.data;
            
            document.querySelector('#geralModal .modal-title').textContent = 'Editar Despesa Geral';
            document.getElementById('geralModal').classList.add('active');
        }
    

        function deleteGeral(id) {
            if (!confirm('Tem certeza?')) return;
            geral = geral.filter(g => g.id !== id);
            renderGeral();
            renderDashboard();
            sync();
            showToast('Removida!', 'warning');
        }

        function renderGeral() {
            const container = document.getElementById('geralList');
            const emptyState = document.getElementById('emptyGeral');

            if (geral.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            emptyState.style.display = 'none';
            container.innerHTML = geral.map(g => `
                <div style="background: linear-gradient(135deg, rgba(100, 116, 139, 0.05) 0%, rgba(100, 116, 139, 0.1) 100%); 
                     border: 2px solid rgba(100, 116, 139, 0.2); border-left: 4px solid #64748b; 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">üìã ${g.nome}</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            ${formatDate(g.data)}${g.desc ? ' ‚Ä¢ ' + g.desc : ''}
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: #64748b;">‚Ç¨${parseFloat(g.valor).toLocaleString('pt-PT')}</div>
                    </div>
                    
                    <div style="display: flex; gap: 8px;">
                        <button class="icon-btn" onclick="editGeral('${g.id}')" title="Editar" style="background: var(--primary); color: white;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                            </svg>
                        </button>
                        <button class="icon-btn" onclick="deleteGeral('${g.id}')" style="background: var(--danger); color: white;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                            </svg>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Eventos Especiais
        function openEventoEspecialModal() {
            window.currentEditingEspecialId = null;
            document.querySelector('#eventoEspecialModal .modal-title').textContent = 'Novo Evento Especial';
            document.getElementById('eventoEspecialModal').classList.add('active');
        }

        function closeEventoEspecialModal() {
            document.getElementById('eventoEspecialModal').classList.remove('active');
            document.getElementById('eventoEspecialNome').value = '';
            document.getElementById('eventoEspecialDesc').value = '';
            document.getElementById('eventoEspecialData').value = '';
            document.getElementById('eventoEspecialValor').value = '0';
        }

        
        function saveEventoEspecial() {
            const eventoData = {
                nome: document.getElementById('eventoEspecialNome').value.trim(),
                desc: document.getElementById('eventoEspecialDesc').value.trim(),
                data: document.getElementById('eventoEspecialData').value,
                valor: parseFloat(document.getElementById('eventoEspecialValor').value) || 0
            };

            if (!eventoData.nome || !eventoData.data) {
                showToast('Preencha todos os campos!', 'error');
                return;
            }

            if (window.currentEditingEspecialId) {
                const index = eventosEspeciais.findIndex(e => e.id === window.currentEditingEspecialId);
                eventosEspeciais[index] = { ...eventosEspeciais[index], ...eventoData };
                showToast('Evento especial atualizado!');
                window.currentEditingEspecialId = null;
            } else {
                eventosEspeciais.push({
                    id: Date.now().toString(),
                    ...eventoData
                });
                showToast('Evento especial adicionado!');
            }

            closeEventoEspecialModal();
            renderEventosEspeciais();
            renderDashboard();
            sync();
        }
    

        
        function editarEventoEspecial(id) {
            editingGeralId = id; // Reutilizando vari√°vel ou criando nova
            const e = eventosEspeciais.find(e => e.id === id);
            if (!e) return;

            document.getElementById('eventoEspecialNome').value = e.nome;
            document.getElementById('eventoEspecialDesc').value = e.desc;
            document.getElementById('eventoEspecialData').value = e.data;
            document.getElementById('eventoEspecialValor').value = e.valor;
            
            document.querySelector('#eventoEspecialModal .modal-title').textContent = 'Editar Evento Especial';
            document.getElementById('eventoEspecialModal').classList.add('active');
            
            // Atualizar a fun√ß√£o save para lidar com edi√ß√£o
            window.currentEditingEspecialId = id;
        }
    

        function removerEventoEspecial(id) {
            if (!confirm('Tem certeza?')) return;
            eventosEspeciais = eventosEspeciais.filter(e => e.id !== id);
            renderEventosEspeciais();
            renderDashboard();
            sync();
            showToast('Removido!', 'warning');
        }

        function renderEventosEspeciais() {
            const container = document.getElementById('eventosEspeciaisList');
            const emptyState = document.getElementById('emptyEventosEspeciais');

            if (eventosEspeciais.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            emptyState.style.display = 'none';
            container.innerHTML = eventosEspeciais.map(e => `
                <div style="background: linear-gradient(135deg, rgba(147, 51, 234, 0.05) 0%, rgba(147, 51, 234, 0.1) 100%); 
                     border: 2px solid rgba(147, 51, 234, 0.2); border-left: 4px solid #9333ea; 
                     padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: 700; font-size: 1.1rem; color: var(--dark); margin-bottom: 6px;">‚≠ê ${e.nome}</div>
                        <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">
                            ${formatDate(e.data)}${e.desc ? ' ‚Ä¢ ' + e.desc : ''}
                        </div>
                        <div style="font-size: 1.4rem; font-weight: 800; color: #9333ea;">‚Ç¨${parseFloat(e.valor).toLocaleString('pt-PT')}</div>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="icon-btn" onclick="editarEventoEspecial('${e.id}')" style="background: var(--primary); color: white;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                            </svg>
                        </button>
                        <button class="icon-btn" onclick="removerEventoEspecial('${e.id}')" style="background: var(--danger); color: white;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                            </svg>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Partnerships
        function openPartnershipModal() {
            editingPartnershipId = null;
            document.querySelector('#partnershipModal .modal-title').textContent = 'Nova Parceria';
            document.getElementById('partnershipModal').classList.add('active');
        }

        function closePartnershipModal() {
            document.getElementById('partnershipModal').classList.remove('active');
            clearPartnershipForm();
        }

        function clearPartnershipForm() {
            document.getElementById('partnershipTipo').value = 'parceria';
            document.getElementById('partnershipNome').value = '';
            document.getElementById('partnershipDesc').value = '';
            document.getElementById('partnershipValor').value = '0';
            document.getElementById('partnershipComTeto').checked = false;
            document.getElementById('partnershipTeto').value = '0';
            document.getElementById('tetoFields').style.display = 'none';
            document.getElementById('partnershipInicio').value = '';
            document.getElementById('partnershipFim').value = '';
        }

        function toggleTetoFields() {
            const checkbox = document.getElementById('partnershipComTeto');
            const fields = document.getElementById('tetoFields');
            fields.style.display = checkbox.checked ? 'block' : 'none';
        }

        
        function savePartnership() {
            if (!newPartnership.nome || !newPartnership.tipo || !newPartnership.inicio || !newPartnership.fim || !newPartnership.valor || !newPartnership.desc) {
                showToast('Preencha todos os campos!', 'error');
                return;
            }

            partnerships.push(newPartnership);
            closePartnershipModal();
            renderParcerias();
            renderDashboard();
            sync();
            showToast('Parceria adicionada!');
        }

        // Invoices / Faturas
        function openFaturaModal(partnershipId) {
            currentPartnershipId = partnershipId;
            document.getElementById('faturaModal').classList.add('active');
        }

        function closeFaturaModal() {
            document.getElementById('faturaModal').classList.remove('active');
            document.getElementById('faturaNumero').value = '';
            document.getElementById('faturaData').value = '';
            document.getElementById('faturaValor').value = '0';
            document.getElementById('faturaDesc').value = '';
            currentPartnershipId = null;
        }

        function saveFatura() {
            if (!currentPartnershipId) return;

            const partnership = partnerships.find(p => p.id === currentPartnershipId);
            if (!partnership) return;

            const newFatura = {
                id: Date.now().toString(),
                numero: document.getElementById('faturaNumero').value.trim(),
                data: document.getElementById('faturaData').value,
                valor: parseFloat(document.getElementById('faturaValor').value) || 0,
                desc: document.getElementById('faturaDesc').value.trim()
            };

            if (!newFatura.numero || !newFatura.data) {
                showToast('Preencha n√∫mero e data!', 'error');
                return;
            }

            if (!partnership.faturas) {
                partnership.faturas = [];
            }

            partnership.faturas.push(newFatura);
            closeFaturaModal();
            renderParcerias();
            sync();
            showToast('Fatura adicionada!');
        }

        function deleteFatura(partnershipId, faturaId) {
            if (!confirm('Tem certeza?')) return;
            const partnership = partnerships.find(p => p.id === partnershipId);
            if (!partnership) return;

            partnership.faturas = partnership.faturas.filter(f => f.id !== faturaId);
            renderParcerias();
            sync();
            showToast('Fatura removida!', 'warning');
        }

        // Parcelas functions (for Feiras)
        function openParcelaModal(feiraId) {
            currentFeiraId = feiraId;
            document.getElementById('parcelaModal').classList.add('active');
        }

        function closeParcelaModal() {
            document.getElementById('parcelaModal').classList.remove('active');
            document.getElementById('parcelaDesc').value = '';
            document.getElementById('parcelaValor').value = '0';
            currentFeiraId = null;
        }

        function saveParcela() {
            if (!currentFeiraId) return;

            const feira = feiras.find(f => f.id === currentFeiraId);
            if (!feira) return;

            const newParcela = {
                id: Date.now().toString(),
                desc: document.getElementById('parcelaDesc').value.trim(),
                valor: parseFloat(document.getElementById('parcelaValor').value) || 0
            };

            if (!newParcela.desc) {
                showToast('Preencha a descri√ß√£o!', 'error');
                return;
            }

            if (!feira.parcelas) {
                feira.parcelas = [];
            }

            feira.parcelas.push(newParcela);
            closeParcelaModal();
            renderFeiras();
            renderDashboard();
            sync();
            showToast('Parcela adicionada!');
        }

        function deleteParcela(feiraId, parcelaId) {
            if (!confirm('Tem certeza?')) return;
            const feira = feiras.find(f => f.id === feiraId);
            if (!feira) return;

            feira.parcelas = feira.parcelas.filter(p => p.id !== parcelaId);
            renderFeiras();
            renderDashboard();
            sync();
            showToast('Parcela removida!', 'warning');
        }

        function deletePartnership(id) {
            if (!confirm('Tem certeza?')) return;
            partnerships = partnerships.filter(p => p.id !== id);
            renderParcerias();
            renderDashboard();
            sync();
            showToast('Removida!', 'warning');
        }

        function filterPartnerships(filter) {
            currentPartnershipFilter = filter;
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            renderParcerias();
        }

        function renderParcerias() {
            const container = document.getElementById('partnershipsList');
            const emptyState = document.getElementById('emptyParcerias');

            let filteredPartnerships = partnerships;
            if (currentPartnershipFilter === 'paid') {
                filteredPartnerships = partnerships.filter(p => p.valor > 0);
            } else if (currentPartnershipFilter === 'free') {
                filteredPartnerships = partnerships.filter(p => p.valor === 0);
            }

            if (filteredPartnerships.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'block';
                return;
        }            container.innerHTML = filteredPartnerships.map(p => {
                const totalFaturas = p.faturas ? p.faturas.reduce((sum, f) => sum + parseFloat(f.valor), 0) : 0;
                const valorRestante = p.comTeto ? p.teto - totalFaturas : 0;
                const percentagemUtilizada = p.comTeto && p.teto > 0 ? (totalFaturas / p.teto) * 100 : 0;

                return `
                <div class="persona-card" style="border-left: 4px solid ${p.tipo === 'patrocinio' ? 'var(--warning)' : 'var(--accent)'}">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
                        <div>
                            <h4 style="margin: 0 0 8px 0; font-size: 1.3rem;">${p.tipo === 'patrocinio' ? 'üí∞' : 'ü§ù'} ${p.nome}</h4>
                            <div style="color: #64748b; font-size: 0.85rem; margin-bottom: 8px;">
                                ${formatDate(p.inicio)} at√© ${formatDate(p.fim)}
                            </div>
                            ${p.valor === 0 ? '<span class="priority-badge priority-baixa">Sem Custos</span>' : ''}
                            ${p.comTeto ? '<span class="priority-badge priority-media">Com Teto Anual</span>' : ''}
                        </div>
                        
                        <div style="display: flex; gap: 8px;">
                            <button class="icon-btn" onclick="editPartnership('${p.id}')" title="Editar" style="background: var(--primary); color: white;">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                </svg>
                            </button>
                            <button class="icon-btn" onclick="deletePartnership('${p.id}')" style="background: var(--danger); color: white;">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <p style="color: #64748b; line-height: 1.6; margin-bottom: 15px;">${p.desc}</p>
                    
                    ${p.comTeto ? `
                        <div style="background: rgba(99, 102, 241, 0.05); padding: 20px; border-radius: 12px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                <div>
                                    <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 4px;">Teto Anual</div>
                                    <div style="font-size: 1.4rem; font-weight: 700; color: var(--dark);">‚Ç¨${p.teto.toLocaleString('pt-PT')}</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 4px;">Utilizado</div>
                                    <div style="font-size: 1.4rem; font-weight: 700; color: var(--primary);">‚Ç¨${totalFaturas.toLocaleString('pt-PT')}</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 4px;">Dispon√≠vel</div>
                                    <div style="font-size: 1.4rem; font-weight: 700; color: ${valorRestante >= 0 ? 'var(--success)' : 'var(--danger)'}">‚Ç¨${valorRestante.toLocaleString('pt-PT')}</div>
                                </div>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${Math.min(percentagemUtilizada, 100)}%; background: ${percentagemUtilizada > 90 ? 'var(--danger)' : 'linear-gradient(90deg, var(--success) 0%, var(--accent) 100%)'}"></div>
                            </div>
                            <div style="text-align: center; margin-top: 8px; font-size: 0.85rem; color: #64748b;">
                                ${percentagemUtilizada.toFixed(1)}% utilizado
                            </div>

                            <div style="margin-top: 16px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                    <h5 style="margin: 0; font-size: 1rem; color: var(--dark);">üìÑ Faturas (${p.faturas ? p.faturas.length : 0})</h5>
                                    <button class="btn btn-secondary" style="padding: 8px 16px; font-size: 0.85rem;" onclick="openFaturaModal('${p.id}')">
                                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                        </svg>
                                        Adicionar Fatura
                                    </button>
                                </div>
                                ${p.faturas && p.faturas.length > 0 ? p.faturas.map(f => `
                                    <div class="invoice-item">
                                        <div style="flex: 1;">
                                            <div style="font-weight: 600; color: var(--dark);">${f.numero}</div>
                                            <div style="font-size: 0.8rem; color: #64748b; margin-top: 2px;">
                                                ${formatDate(f.data)}${f.desc ? ' ‚Ä¢ ' + f.desc : ''}
                                            </div>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 12px;">
                                            <div style="font-weight: 700; font-size: 1.1rem; color: var(--primary);">‚Ç¨${parseFloat(f.valor).toLocaleString('pt-PT')}</div>
                                            <button class="icon-btn" onclick="deleteFatura('${p.id}', '${f.id}')" style="background: var(--danger); color: white; width: 32px; height: 32px;">
                                                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                `).join('') : '<div style="text-align: center; padding: 16px; color: #94a3b8; font-size: 0.9rem;">Nenhuma fatura registada</div>'}
                            </div>
                        </div>
                    ` : ''}

                    ${p.valor > 0 && !p.comTeto ? `
                        <div style="background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); color: white; padding: 15px 20px; border-radius: 12px; display: inline-block;">
                            <div style="font-size: 0.8rem; opacity: 0.9; margin-bottom: 4px;">Valor Total</div>
                            <div style="font-size: 1.8rem; font-weight: 800;">‚Ç¨${p.valor.toLocaleString('pt-PT')}</div>
                        </div>
                    ` : ''}
                </div>
            `}).join('');
        }

        // Data persistence
        function sync() {
            // Auto-save placeholder
        }

        async function exportFullReport() {
            try {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');
            const pageWidth = doc.internal.pageSize.getWidth();
            
            showToast('A gerar relat√≥rio completo...');

            // Capa
            doc.setFillColor(15, 23, 42);
            doc.rect(0, 0, pageWidth, 297, 'F');
            
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(30);
            doc.text('CENTRO DE MARKETING 2026', pageWidth / 2, 100, { align: 'center' });
            doc.setFontSize(16);
            doc.text('Relat√≥rio Consolidado de Planeamento e Or√ßamento', pageWidth / 2, 115, { align: 'center' });
            doc.setFontSize(12);
            doc.text(`Gerado em: ${new Date().toLocaleString('pt-PT')}`, pageWidth / 2, 250, { align: 'center' });

            // 1. Agenda / Eventos
            doc.addPage();
            doc.setTextColor(15, 23, 42);
            doc.setFontSize(20);
            doc.text('1. Agenda de Eventos', 14, 20);
            
            const eventosData = events.map(e => [
                formatDate(e.date),
                e.title,
                e.category,
                e.status === 'completed' ? 'Conclu√≠do' : 'Pendente'
            ]);
            
            doc.autoTable({
                startY: 30,
                head: [['Data', 'Evento', 'Categoria', 'Estado']],
                body: eventosData,
                theme: 'grid',
                headStyles: { fillColor: [99, 102, 241] }
            });

            // 2. Plano Anual
            doc.addPage();
            doc.setFontSize(20);
            doc.text('2. Plano Anual de Marketing', 14, 20);
            
            const planoData = [
                ['Objetivo Principal', plan.objetivo || 'N√£o definido'],
                ['P√∫blico-Alvo', plan.publico || 'N√£o definido'],
                ['Estrat√©gia', plan.estrategia || 'N√£o definida'],
                ['KPIs', plan.kpis || 'N√£o definidos']
            ];
            
            doc.autoTable({
                startY: 30,
                body: planoData,
                theme: 'plain',
                columnStyles: { 0: { fontStyle: 'bold', width: 50 } }
            });

            // 2.1 Plano de Crise
            doc.setFontSize(16);
            doc.text('2.1 Plano de Crise', 14, doc.lastAutoTable.finalY + 15);
            
            const criseData = [
                ['Cen√°rio de Risco', crisisPlan.cenario || 'N√£o definido'],
                ['A√ß√µes Imediatas', crisisPlan.acoes || 'N√£o definidas'],
                ['Comunica√ß√£o', crisisPlan.comunicacao || 'N√£o definida']
            ];
            
            doc.autoTable({
                startY: doc.lastAutoTable.finalY + 20,
                body: criseData,
                theme: 'plain',
                columnStyles: { 0: { fontStyle: 'bold', width: 50 } }
            });

            // 3. Parcerias
            doc.addPage();
            doc.setFontSize(20);
            doc.text('3. Parcerias e Patroc√≠nios', 14, 20);
            
            const parceriasData = partnerships.map(p => [
                p.nome,
                p.tipo === 'patrocinio' ? 'Patroc√≠nio' : 'Parceria',
                `‚Ç¨${p.valor.toLocaleString('pt-PT')}`,
                `${formatDate(p.inicio)} - ${formatDate(p.fim)}`
            ]);
            
            doc.autoTable({
                startY: 30,
                head: [['Nome', 'Tipo', 'Valor', 'Per√≠odo']],
                body: parceriasData,
                theme: 'striped',
                headStyles: { fillColor: [236, 72, 153] }
            });

            // 4. Or√ßamento Resumo
            doc.addPage();
            doc.setFontSize(20);
            doc.text('4. Resumo Or√ßamental', 14, 20);
            
            const resumoOrcamento = [
                ['Categoria', 'Total'],
                ['Patroc√≠nios', `‚Ç¨${patrocinios.reduce((s, i) => s + i.valor, 0).toLocaleString('pt-PT')}`],
                ['Feiras', `‚Ç¨${feiras.reduce((s, i) => s + i.valor, 0).toLocaleString('pt-PT')}`],
                ['Material', `‚Ç¨${material.reduce((s, i) => s + i.valor, 0).toLocaleString('pt-PT')}`],
                ['Geral', `‚Ç¨${geral.reduce((s, i) => s + i.valor, 0).toLocaleString('pt-PT')}`],
                ['Eventos Especiais', `‚Ç¨${eventosEspeciais.reduce((s, i) => s + i.valor, 0).toLocaleString('pt-PT')}`]
            ];
            
            doc.autoTable({
                startY: 30,
                head: [resumoOrcamento[0]],
                body: resumoOrcamento.slice(1),
                theme: 'grid',
                headStyles: { fillColor: [20, 184, 166] }
            });

            // 5. Detalhes do Or√ßamento
            const orcamentos = [
                { title: '5.1 Detalhe: Patroc√≠nios', data: patrocinios },
                { title: '5.2 Detalhe: Feiras', data: feiras },
                { title: '5.3 Detalhe: Material', data: material },
                { title: '5.4 Detalhe: Geral', data: geral },
                { title: '5.5 Detalhe: Eventos Especiais', data: eventosEspeciais }
            ];

            orcamentos.forEach(orc => {
                doc.addPage();
                doc.setFontSize(18);
                doc.text(orc.title, 14, 20);
                
                const tableData = orc.data.map(item => [
                    item.desc || item.nome || 'N/A',
                    `‚Ç¨${item.valor.toLocaleString('pt-PT')}`
                ]);

                doc.autoTable({
                    startY: 30,
                    head: [['Descri√ß√£o', 'Valor']],
                    body: tableData,
                    theme: 'striped',
                    headStyles: { fillColor: [79, 70, 229] }
                });
            });

            doc.save('RELATORIO_CENTRO_MARKETING_2026.pdf');
            showToast('Relat√≥rio exportado com sucesso!');
            } catch (error) {
                console.error('Erro ao gerar relat√≥rio:', error);
                showToast('Erro ao gerar relat√≥rio!', 'error');
            }
        }

        function downloadData() {
            const html = document.documentElement.outerHTML;
            let updatedHtml = html
                .replace(/const CLOUD_DATA_EVENTS = \[.*?\];/s, `const CLOUD_DATA_EVENTS = ${JSON.stringify(events)};`)
                .replace(/const CLOUD_DATA_NOTES = \[.*?\];/s, `const CLOUD_DATA_NOTES = ${JSON.stringify(notes)};`)
                .replace(/const CLOUD_DATA_PLAN = \{.*?\};/s, `const CLOUD_DATA_PLAN = ${JSON.stringify(plan)};`)
                .replace(/const CLOUD_DATA_CRISIS_PLAN = \{.*?\};/s, `const CLOUD_DATA_CRISIS_PLAN = ${JSON.stringify(crisisPlan)};`)
                .replace(/const CLOUD_DATA_PARTNERSHIPS = \[.*?\];/s, `const CLOUD_DATA_PARTNERSHIPS = ${JSON.stringify(partnerships)};`)
                .replace(/const CLOUD_DATA_PATROCINIOS = \[.*?\];/s, `const CLOUD_DATA_PATROCINIOS = ${JSON.stringify(patrocinios)};`)
                .replace(/const CLOUD_DATA_FEIRAS = \[.*?\];/s, `const CLOUD_DATA_FEIRAS = ${JSON.stringify(feiras)};`)
                .replace(/const CLOUD_DATA_MATERIAL = \[.*?\];/s, `const CLOUD_DATA_MATERIAL = ${JSON.stringify(material)};`)
                .replace(/const CLOUD_DATA_GERAL = \[.*?\];/s, `const CLOUD_DATA_GERAL = ${JSON.stringify(geral)};`)
                .replace(/const CLOUD_DATA_EVENTOS_ESPECIAIS = \[.*?\];/s, `const CLOUD_DATA_EVENTOS_ESPECIAIS = ${JSON.stringify(eventosEspeciais)};`);

            const blob = new Blob([updatedHtml], { type: 'text/html' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'CENTRO_MARKETING_2026_PREMIUM_IA.html';
            a.click();
            showToast('Dashboard exportado!');
        }

        // Initialize
        function init() {
            events = [...CLOUD_DATA_EVENTS];
            notes = [...CLOUD_DATA_NOTES];
            plan = {...CLOUD_DATA_PLAN};
            crisisPlan = {...CLOUD_DATA_CRISIS_PLAN};
            partnerships = [...CLOUD_DATA_PARTNERSHIPS];
            patrocinios = [...CLOUD_DATA_PATROCINIOS];
            feiras = [...CLOUD_DATA_FEIRAS];
            material = [...CLOUD_DATA_MATERIAL];
            geral = [...CLOUD_DATA_GERAL];
            eventosEspeciais = [...CLOUD_DATA_EVENTOS_ESPECIAIS];

            loadPlan();
            loadCrisisPlan();
            renderDashboard();
            renderAgenda();
            loadNotes();
            renderParcerias();
            renderPatrocinios();
            renderFeiras();
            renderMaterial();
            renderGeral();
            renderEventosEspeciais();
            updateBudget();
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal').forEach(modal => modal.classList.remove('active'));
            }
        });

        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.classList.remove('active');
            });
        });

        // Export functions for all sections
        function exportNotasPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            doc.setFontSize(18);
            doc.text('Notas e Ideias', 14, 20);
            
            let yPos = 30;
            notes.forEach((note, index) => {
                if (yPos > 270) {
                    doc.addPage();
                    yPos = 20;
                }
                
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text(note.title, 14, yPos);
                yPos += 7;
                
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                const lines = doc.splitTextToSize(note.content.replace(/\r\n/g, ' '), 180);
                doc.text(lines, 14, yPos);
                yPos += (lines.length * 5) + 10;
            });
            
            doc.save('notas_2026.pdf');
            showToast('PDF exportado com sucesso!');
        }

        function exportNotasExcel() {
            const data = notes.map(n => ({
                'T√≠tulo': n.title,
                'Conte√∫do': n.content.replace(/\r\n/g, ' '),
                'Data': n.date
            }));
            
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Notas');
            XLSX.writeFile(wb, 'notas_2026.xlsx');
            showToast('Excel exportado com sucesso!');
        }

        function exportParceriasPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            doc.setFontSize(18);
            doc.text('Parcerias', 14, 20);
            
            const tableData = partnerships.map(p => [
                p.nome,
                p.tipo,
                formatDate(p.inicio),
                formatDate(p.fim),
                p.comTeto ? `‚Ç¨${p.teto.toLocaleString('pt-PT')}` : `‚Ç¨${p.valor.toLocaleString('pt-PT')}`
            ]);
            
            doc.autoTable({
                head: [['Nome', 'Tipo', 'In√≠cio', 'Fim', 'Valor']],
                body: tableData,
                startY: 30,
                headStyles: { fillColor: [99, 102, 241] }
            });
            
            doc.save('parcerias_2026.pdf');
            showToast('PDF exportado com sucesso!');
        }

        function exportParceriasExcel() {
            const data = partnerships.map(p => ({
                'Nome': p.nome,
                'Tipo': p.tipo,
                'In√≠cio': p.inicio,
                'Fim': p.fim,
                'Com Teto': p.comTeto ? 'Sim' : 'N√£o',
                'Teto Anual': p.comTeto ? p.teto : '-',
                'Valor': p.valor,
                'Descri√ß√£o': p.desc
            }));
            
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Parcerias');
            XLSX.writeFile(wb, 'parcerias_2026.xlsx');
            showToast('Excel exportado com sucesso!');
        }

        function exportPatrociniosPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            doc.setFontSize(18);
            doc.text('Patroc√≠nios', 14, 20);
            
            const tableData = patrocinios.map(p => [
                p.nome,
                p.desc,
                `‚Ç¨${parseFloat(p.valor).toLocaleString('pt-PT')}`,
                formatDate(p.data)
            ]);
            
            doc.autoTable({
                head: [['Nome', 'Descri√ß√£o', 'Valor', 'Data']],
                body: tableData,
                startY: 30,
                headStyles: { fillColor: [99, 102, 241] }
            });
            
            const total = patrocinios.reduce((sum, p) => sum + parseFloat(p.valor || 0), 0);
            doc.text(`Total: ‚Ç¨${total.toLocaleString('pt-PT')}`, 14, doc.lastAutoTable.finalY + 10);
            
            doc.save('patrocinios_2026.pdf');
            showToast('PDF exportado com sucesso!');
        }

        function exportPatrociniosExcel() {
            const data = patrocinios.map(p => ({
                'Nome': p.nome,
                'Descri√ß√£o': p.desc,
                'Valor': parseFloat(p.valor),
                'Data': p.data
            }));
            
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Patroc√≠nios');
            XLSX.writeFile(wb, 'patrocinios_2026.xlsx');
            showToast('Excel exportado com sucesso!');
        }

        function exportFeirasPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            doc.setFontSize(18);
            doc.text('Feiras e Eventos', 14, 20);
            
            const tableData = feiras.map(f => [
                f.nome,
                f.local,
                formatDate(f.data),
                `‚Ç¨${parseFloat(f.valor).toLocaleString('pt-PT')}`
            ]);
            
            doc.autoTable({
                head: [['Nome', 'Local', 'Data', 'Or√ßamento']],
                body: tableData,
                startY: 30,
                headStyles: { fillColor: [99, 102, 241] }
            });
            
            const total = feiras.reduce((sum, f) => sum + parseFloat(f.valor || 0), 0);
            doc.text(`Total: ‚Ç¨${total.toLocaleString('pt-PT')}`, 14, doc.lastAutoTable.finalY + 10);
            
            doc.save('feiras_2026.pdf');
            showToast('PDF exportado com sucesso!');
        }

        function exportFeirasExcel() {
            const data = feiras.map(f => ({
                'Nome': f.nome,
                'Local': f.local,
                'Data': f.data,
                'Or√ßamento': parseFloat(f.valor)
            }));
            
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Feiras');
            XLSX.writeFile(wb, 'feiras_2026.xlsx');
            showToast('Excel exportado com sucesso!');
        }

        function exportMaterialPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            doc.setFontSize(18);
            doc.text('Material de Marketing', 14, 20);
            
            const tableData = material.map(m => [
                m.nome,
                m.desc || '-',
                formatDate(m.data),
                `‚Ç¨${parseFloat(m.valor).toLocaleString('pt-PT')}`
            ]);
            
            doc.autoTable({
                head: [['Nome', 'Descri√ß√£o', 'Data', 'Valor']],
                body: tableData,
                startY: 30,
                headStyles: { fillColor: [99, 102, 241] }
            });
            
            const total = material.reduce((sum, m) => sum + parseFloat(m.valor || 0), 0);
            doc.text(`Total: ‚Ç¨${total.toLocaleString('pt-PT')}`, 14, doc.lastAutoTable.finalY + 10);
            
            doc.save('material_2026.pdf');
            showToast('PDF exportado com sucesso!');
        }

        function exportMaterialExcel() {
            const data = material.map(m => ({
                'Nome': m.nome,
                'Descri√ß√£o': m.desc,
                'Data': m.data,
                'Valor': parseFloat(m.valor)
            }));
            
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Material');
            XLSX.writeFile(wb, 'material_2026.xlsx');
            showToast('Excel exportado com sucesso!');
        }

        function exportGeralPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            doc.setFontSize(18);
            doc.text('Despesas Gerais', 14, 20);
            
            const tableData = geral.map(g => [
                g.nome,
                g.desc || '-',
                formatDate(g.data),
                `‚Ç¨${parseFloat(g.valor).toLocaleString('pt-PT')}`
            ]);
            
            doc.autoTable({
                head: [['Nome', 'Descri√ß√£o', 'Data', 'Valor']],
                body: tableData,
                startY: 30,
                headStyles: { fillColor: [99, 102, 241] }
            });
            
            const total = geral.reduce((sum, g) => sum + parseFloat(g.valor || 0), 0);
            doc.text(`Total: ‚Ç¨${total.toLocaleString('pt-PT')}`, 14, doc.lastAutoTable.finalY + 10);
            
            doc.save('despesas_gerais_2026.pdf');
            showToast('PDF exportado com sucesso!');
        }

        function exportGeralExcel() {
            const data = geral.map(g => ({
                'Nome': g.nome,
                'Descri√ß√£o': g.desc,
                'Data': g.data,
                'Valor': parseFloat(g.valor)
            }));
            
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Despesas Gerais');
            XLSX.writeFile(wb, 'despesas_gerais_2026.xlsx');
            showToast('Excel exportado com sucesso!');
        }

        function exportEventosEspeciaisPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            doc.setFontSize(18);
            doc.text('Eventos Especiais', 14, 20);
            
            const tableData = eventosEspeciais.map(e => [
                e.nome,
                e.desc || '-',
                formatDate(e.data),
                `‚Ç¨${parseFloat(e.valor).toLocaleString('pt-PT')}`
            ]);
            
            doc.autoTable({
                head: [['Nome', 'Descri√ß√£o', 'Data', 'Valor']],
                body: tableData,
                startY: 30,
                headStyles: { fillColor: [99, 102, 241] }
            });
            
            const total = eventosEspeciais.reduce((sum, e) => sum + parseFloat(e.valor || 0), 0);
            doc.text(`Total: ‚Ç¨${total.toLocaleString('pt-PT')}`, 14, doc.lastAutoTable.finalY + 10);
            
            doc.save('eventos_especiais_2026.pdf');
            showToast('PDF exportado com sucesso!');
        }

        function exportEventosEspeciaisExcel() {
            const data = eventosEspeciais.map(e => ({
                'Nome': e.nome,
                'Descri√ß√£o': e.desc,
                'Data': e.data,
                'Valor': parseFloat(e.valor)
            }));
            
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Eventos Especiais');
            XLSX.writeFile(wb, 'eventos_especiais_2026.xlsx');
            showToast('Excel exportado com sucesso!');
        }

        window.onload = init;
    </script>


</body></html>